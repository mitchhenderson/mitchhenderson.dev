<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>mitchhenderson.dev</title>
<link>https://www.mitchhenderson.dev/posts.html</link>
<atom:link href="https://www.mitchhenderson.dev/posts.xml" rel="self" type="application/rss+xml"/>
<description>Sport, science, data</description>
<generator>quarto-1.7.32</generator>
<lastBuildDate>Sat, 03 Jan 2026 13:00:00 GMT</lastBuildDate>
<item>
  <title>Making 1 rep max estimates more accurate and honest</title>
  <dc:creator>Mitch Henderson</dc:creator>
  <link>https://www.mitchhenderson.dev/posts/2026-01-04-e1rm-modelling/</link>
  <description><![CDATA[ 





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
tl;dr
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can get more accurate 1RM estimates by using a model that learns and accounts for differences between athletes. It also quantifies how certain the estimates are (which matters).</p>
</div>
</div>
<p><br></p>
<p><a href="https://en.wikipedia.org/wiki/Strength_and_conditioning_coach">S&amp;C coaches</a> collect training data to monitor progress and evaluate the effectiveness of their programming. A common method in strength training is to calculate an <a href="https://en.wikipedia.org/wiki/One-repetition_maximum#Estimating_1RM"><strong>estimated one repetition maximum</strong></a> (or e1RM) using a <a href="https://maxcalculator.com/guides/1rm-formulas">formula</a> and track how it changes over time. Lots of coaches are happy to use e1RM as a progress indicator instead of testing a true 1RM during a program or in-season because they donâ€™t negatively impact training (integrates into existing training sessions), are safer (lower weight), and data can be collected more frequently (faster program refinements). <a href="https://en.wikipedia.org/wiki/One-repetition_maximum#Measuring_1RM">True 1RM</a> testing might only be programmed a handful of times per season (if at all) so using training data to regularly estimate strength increases or detect when a program should be adjusted is a good idea.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gganimate)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(scales)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggtext)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gtExtras)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(geomtextpath)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(brms)</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidybayes)</span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdist)</span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(colorspace)</span>
<span id="cb1-12"></span>
<span id="cb1-13">mitchhenderson<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_hoist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro"</span>)</span>
<span id="cb1-14">socials <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mitchhenderson<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">social_caption</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">icon_colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>)</span>
<span id="cb1-15"></span>
<span id="cb1-16">units <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kg"</span></span>
<span id="cb1-17">colours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E31937"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#134A8E"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#16A34A"</span>)</span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb1-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb1-22">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb1-23">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb1-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb1-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey50"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb1-26">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-27">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey50"</span>),</span>
<span id="cb1-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span></span>
<span id="cb1-29">    )</span>
<span id="cb1-30">)</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code outputs will differ from rendered results
</div>
</div>
<div class="callout-body-container callout-body">
<p>The visualisations and tables on this page are generated from the R code. Running the Python code will produce the equivalent analyses but with different styling (e.g.&nbsp;fonts, themes, annotations) because Python uses different plotting and table libraries. The analytical conclusions are the same though.</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> polars <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pl</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb2-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.animation <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> animation</span>
<span id="cb2-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> plotnine <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb2-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> great_tables <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> GT, style, loc</span>
<span id="cb2-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pymc <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pm</span>
<span id="cb2-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> arviz <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> az</span>
<span id="cb2-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> polars.selectors <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> cs</span>
<span id="cb2-10"></span>
<span id="cb2-11">units <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kg"</span></span>
<span id="cb2-12">colours <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E31937"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#134A8E"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#16A34A"</span>]</span>
<span id="cb2-13"></span>
<span id="cb2-14">theme_set(</span>
<span id="cb2-15">    theme_classic(base_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)</span>
<span id="cb2-16">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> theme(</span>
<span id="cb2-17">        plot_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb2-18">        plot_subtitle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>),</span>
<span id="cb2-19">        axis_title_x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>),</span>
<span id="cb2-20">        axis_ticks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb2-21">        axis_line<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_line(colour<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>),</span>
<span id="cb2-22">    )</span>
<span id="cb2-23">)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<section id="the-problem" class="level2">
<h2 class="anchored" data-anchor-id="the-problem">The problem</h2>
<p>There are <a href="https://maxcalculator.com/guides/1rm-formulas">lots of different formulas out there to estimate a 1RM</a>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">formulas <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb3-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Epley =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(reps) {</span>
<span id="cb3-3">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb3-4">  },</span>
<span id="cb3-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Brzycki =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(reps) {</span>
<span id="cb3-6">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">37</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> reps) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span></span>
<span id="cb3-7">  },</span>
<span id="cb3-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Mayhew =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(reps) {</span>
<span id="cb3-9">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">52.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">41.9</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.055</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reps)</span>
<span id="cb3-10">  },</span>
<span id="cb3-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Lombardi =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(reps) {</span>
<span id="cb3-12">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (reps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.10</span>)</span>
<span id="cb3-13">  },</span>
<span id="cb3-14">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">O'Conner</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(reps) {</span>
<span id="cb3-15">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>)</span>
<span id="cb3-16">  },</span>
<span id="cb3-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Wathan =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(reps) {</span>
<span id="cb3-18">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">48.8</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">53.8</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.075</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reps)</span>
<span id="cb3-19">  },</span>
<span id="cb3-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Lander =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(reps) {</span>
<span id="cb3-21">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">101.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.67123</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reps</span>
<span id="cb3-22">  }</span>
<span id="cb3-23">)</span>
<span id="cb3-24"></span>
<span id="cb3-25">reps_range <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb3-26"></span>
<span id="cb3-27">e1rm_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reps =</span> reps_range) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(formulas)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percent_1rm =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map2_dbl</span>(formula, reps, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> formulas[[.x]](.y))</span>
<span id="cb3-31">  )</span>
<span id="cb3-32"></span>
<span id="cb3-33">e1rm_data_animated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> e1rm_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlight =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(e1rm_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>formula)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_highlighted =</span> formula <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> highlight,</span>
<span id="cb3-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line_color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(is_highlighted, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"highlighted"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>),</span>
<span id="cb3-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(is_highlighted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> reps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(reps), formula, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_character_</span>),</span>
<span id="cb3-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line_size =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(is_highlighted, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb3-40">  )</span>
<span id="cb3-41"></span>
<span id="cb3-42">animated_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> e1rm_data_animated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> reps, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_1rm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> formula)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb3-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> e1rm_data_animated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_highlighted),</span>
<span id="cb3-47">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> line_size),</span>
<span id="cb3-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey70"</span></span>
<span id="cb3-49">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb3-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> e1rm_data_animated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(is_highlighted),</span>
<span id="cb3-52">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> line_size),</span>
<span id="cb3-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E31937"</span></span>
<span id="cb3-54">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb3-56">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb3-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E31937"</span>,</span>
<span id="cb3-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span>,</span>
<span id="cb3-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb3-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb3-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb3-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb3-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb3-64">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_linewidth_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb3-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-68">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb3-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb3-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb3-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb3-73">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb3-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1RM Estimation Formulas"</span>,</span>
<span id="cb3-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Repetitions"</span>,</span>
<span id="cb3-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb3-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% of 1RM"</span>,</span>
<span id="cb3-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> socials</span>
<span id="cb3-80">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-81">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb3-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb3-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb3-84">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-85">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transition_manual</span>(</span>
<span id="cb3-86">    highlight,</span>
<span id="cb3-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cumulative =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb3-88">  )</span>
<span id="cb3-89"></span>
<span id="cb3-90"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">animate</span>(</span>
<span id="cb3-91">  animated_plot,</span>
<span id="cb3-92">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nframes =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>,</span>
<span id="cb3-93">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb3-94">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb3-95">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>,</span>
<span id="cb3-96">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">device =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ragg_png"</span></span>
<span id="cb3-97">)</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">formulas <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb4-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Epley"</span>: <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> reps: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>),</span>
<span id="cb4-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brzycki"</span>: <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> reps: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">37</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> reps) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb4-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mayhew"</span>: <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> reps: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">52.2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">41.9</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.exp(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.055</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reps),</span>
<span id="cb4-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lombardi"</span>: <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> reps: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (reps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.10</span>),</span>
<span id="cb4-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"O'Conner"</span>: <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> reps: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>),</span>
<span id="cb4-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wathan"</span>: <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> reps: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">48.8</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">53.8</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.exp(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.075</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reps),</span>
<span id="cb4-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lander"</span>: <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> reps: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">101.3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.67123</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> reps,</span>
<span id="cb4-9">}</span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate data</span></span>
<span id="cb4-12">reps_range <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>)</span>
<span id="cb4-13">formula_names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(formulas.keys())</span>
<span id="cb4-14"></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate %1RM for each formula</span></span>
<span id="cb4-16">e1rm_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {name: func(reps_range) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> name, func <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> formulas.items()}</span>
<span id="cb4-17"></span>
<span id="cb4-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create figure and initial empty lines</span></span>
<span id="cb4-19">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>))</span>
<span id="cb4-20">fig.subplots_adjust(right<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span>)</span>
<span id="cb4-21"></span>
<span id="cb4-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Store line objects</span></span>
<span id="cb4-23">grey_lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb4-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> name <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> formula_names:</span>
<span id="cb4-25">    (line,) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.plot([], [], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgrey"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb4-26">    grey_lines.append(line)</span>
<span id="cb4-27"></span>
<span id="cb4-28">(highlight_line,) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.plot([], [], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E31937"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb4-29">label_text <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ax.text(</span>
<span id="cb4-30">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E31937"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, fontweight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span></span>
<span id="cb4-31">)</span>
<span id="cb4-32"></span>
<span id="cb4-33">ax.set_xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>)</span>
<span id="cb4-34">ax.set_ylim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb4-35">ax.set_xticks(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>))</span>
<span id="cb4-36">ax.set_yticks(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb4-37">ax.set_yticklabels([<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">%"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)])</span>
<span id="cb4-38">ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Repetitions"</span>)</span>
<span id="cb4-39">ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1RM Estimation Formulas"</span>, fontweight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)</span>
<span id="cb4-40">ax.spines[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>]].set_visible(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb4-41"></span>
<span id="cb4-42"></span>
<span id="cb4-43"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> init():</span>
<span id="cb4-44">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> grey_lines:</span>
<span id="cb4-45">        line.set_data([], [])</span>
<span id="cb4-46">    highlight_line.set_data([], [])</span>
<span id="cb4-47">    label_text.set_text(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb4-48">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> grey_lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> [highlight_line, label_text]</span>
<span id="cb4-49"></span>
<span id="cb4-50"></span>
<span id="cb4-51"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> animate(frame):</span>
<span id="cb4-52">    highlighted <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> formula_names[frame]</span>
<span id="cb4-53"></span>
<span id="cb4-54">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update all lines</span></span>
<span id="cb4-55">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, name <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(formula_names):</span>
<span id="cb4-56">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> highlighted:</span>
<span id="cb4-57">            grey_lines[i].set_data(reps_range, e1rm_data[name])</span>
<span id="cb4-58">            grey_lines[i].set_color(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgrey"</span>)</span>
<span id="cb4-59">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb4-60">            grey_lines[i].set_data([], [])</span>
<span id="cb4-61"></span>
<span id="cb4-62">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update highlighted line</span></span>
<span id="cb4-63">    highlight_line.set_data(reps_range, e1rm_data[highlighted])</span>
<span id="cb4-64"></span>
<span id="cb4-65">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update label</span></span>
<span id="cb4-66">    label_text.set_position((<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20.5</span>, e1rm_data[highlighted][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span>
<span id="cb4-67">    label_text.set_text(highlighted)</span>
<span id="cb4-68"></span>
<span id="cb4-69">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> grey_lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> [highlight_line, label_text]</span>
<span id="cb4-70"></span>
<span id="cb4-71"></span>
<span id="cb4-72">anim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> animation.FuncAnimation(</span>
<span id="cb4-73">    fig, animate, init_func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>init, frames<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(formula_names), interval<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, blit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb4-74">)</span>
<span id="cb4-75"></span>
<span id="cb4-76">anim.save(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1rm_formulas.gif"</span>, writer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pillow"</span>, fps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-77">plt.close()</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2026-01-04-e1rm-modelling/index_files/figure-html/unnamed-chunk-5-1.gif" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>But none of these:</p>
<ul>
<li><p>Account for strength endurance differences between athletes</p>
<p>Some athletes (fast twitch, higher metabolic cost per rep) have high 1RMs but find higher rep sets challenging. Other athletes (better oxidative capacity, lower metabolic cost per rep) can perform many reps at moderate intensities but quickly hit their 1RM ceiling with more weight. <strong>A better 1RM estimate would take into account whatâ€™s known about the physiological characteristics of the athlete</strong>. This directly impacts how accurate the e1RM will be. If a fast twitch athlete does a max reps set of 14 x 100kg, Iâ€™d expect their 1RM to be higher than a more oxidative athlete performing the same 14 x 100kg because theyâ€™re better suited to high intensity work.</p>
<p><em>The standard formulas donâ€™t do this</em>.</p>
<p><br></p></li>
<li><p>Tell me how certain they are in their estimate</p>
<p>The standard formulas WILL ALWAYS give you a 1RM estimate, doesnâ€™t matter how confident or UNconfident they are. The 1RM estimate will also always just be a single value. Thereâ€™s a big difference in how Iâ€™d interpret a 100kg e1RM if itâ€™s 80% certain of being between 98â€“102kg (pretty precise) versus 80% certain of being between 77.5â€“122.5kg (practically useless). Thereâ€™s also a big difference in 1RM certainty when the estimate is based on an athlete doing a max rep set completing 2-5 reps (closer to true 1RM; higher certainty) compared 10+ reps (further from true 1RM; lower certainty).</p>
<p>We also become more familiar about an athleteâ€™s ability the more we work with them and get to know them. Iâ€™d have a lot more confidence predicting the 1RM of an athlete Iâ€™d worked with, gotten to know, and collected training data on for years compared to someone new without much training data available. <strong>A better 1RM estimate would incorporate all these sources of uncertainty and honestly express how confident it is</strong>.</p>
<p><em>The standard formulas donâ€™t do this</em>.</p>
<p><br></p></li>
</ul>
</section>
<section id="my-solution" class="level2">
<h2 class="anchored" data-anchor-id="my-solution">My solution</h2>
<p>The idea is to extend one of the standard e1RM formulas by building it into a statistical model that takes the athlete itâ€™s estimating the 1RM for into account. Itâ€™ll be fit using the athleteâ€™s past data so it learns how they handle higher weight vs higher reps. Itâ€™s like a smarter version of the standard formula tailored to the athlete. Having this extra information helps it make more accurate predictions.</p>
<p>The model will also be a <a href="https://en.wikipedia.org/wiki/Bayesian_statistics"><em>Bayesian</em></a> model. These have advantages over <a href="https://en.wikipedia.org/wiki/Frequentist_probability">conventional</a> statistical models when it comes to expressing uncertainty (<a href="https://www.youtube.com/watch?v=R6d-AbkhBQ8">among other things</a>). So instead of just getting one number, you get a full distribution representing the uncertainty in the 1RM estimate (e.g., â€œThe 1RM estimate is 100kg with 80% probability of it being between 98 and 102kgâ€).<sup>1</sup> This distribution accounts for all the sources of upstream uncertainty (amount of data available on the athlete lifting, number of reps they completed, etc).</p>
<p>To show you what I mean, we need some data.</p>
<section id="simulate-data" class="level3">
<h3 class="anchored" data-anchor-id="simulate-data">Simulate data</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" aria-controls="tabset-3-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" aria-controls="tabset-3-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-3-1" class="tab-pane active" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2534</span>)</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Population hyperparameters (ground truth)</span></span>
<span id="cb5-4">n_athletes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb5-5">mean_n_obs_per_athlete <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb5-6">min_n_obs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb5-7">max_n_obs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># True 1RM population parameters</span></span>
<span id="cb5-10">pop_mean_1rm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span></span>
<span id="cb5-11">pop_sd_1rm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Endurance coefficient population parameters</span></span>
<span id="cb5-14">pop_mean_endurance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb5-15">pop_sd_endurance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb5-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maybe discuss importance of this on results (heterogenous endurance profiles = bigger gain from player specific parameters)</span></span>
<span id="cb5-17"></span>
<span id="cb5-18">min_reps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-19">max_reps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb5-20"></span>
<span id="cb5-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Observation noise</span></span>
<span id="cb5-22">obs_noise_sd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate athlete-level ground truth</span></span>
<span id="cb5-25">athletes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb5-26">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">athlete_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n_athletes,</span>
<span id="cb5-27">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true_1rm =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n_athletes, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> pop_mean_1rm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> pop_sd_1rm),</span>
<span id="cb5-28">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true_endurance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(</span>
<span id="cb5-29">    n_athletes,</span>
<span id="cb5-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> pop_mean_endurance,</span>
<span id="cb5-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> pop_sd_endurance</span>
<span id="cb5-32">  ),</span>
<span id="cb5-33">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_observations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(min_n_obs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>max_n_obs, n_athletes, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb5-34">)</span>
<span id="cb5-35"></span>
<span id="cb5-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate observations</span></span>
<span id="cb5-37">simulated_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> athletes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reframe</span>(</span>
<span id="cb5-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">athlete_id =</span> athlete_id,</span>
<span id="cb5-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true_1rm =</span> true_1rm,</span>
<span id="cb5-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true_endurance =</span> true_endurance,</span>
<span id="cb5-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">session_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(n_observations),</span>
<span id="cb5-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reps =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(min_reps<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>max_reps, n_observations, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb5-45">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-47">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Theoretical weight from modified Epley formula</span></span>
<span id="cb5-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight_theoretical =</span> true_1rm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> true_endurance),</span>
<span id="cb5-49"></span>
<span id="cb5-50">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add normally distributed noise</span></span>
<span id="cb5-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight_observed =</span> weight_theoretical <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, obs_noise_sd)</span>
<span id="cb5-52">  )</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" aria-labelledby="tabset-3-2-tab">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Different random number generators
</div>
</div>
<div class="callout-body-container callout-body">
<p>R and Python use different random number generation algorithms, so even with the same seed value, the simulated data will differ between languages. This means specific values (e.g.&nbsp;individual athlete 1RMs, credible intervals) wonâ€™t match exactly. The overall patterns will be consistent, and the same analytical conclusions apply.</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2534</span>)</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Population hyperparameters (ground truth)</span></span>
<span id="cb6-4">n_athletes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb6-5">mean_n_obs_per_athlete <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb6-6">min_n_obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb6-7">max_n_obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># True 1RM population parameters</span></span>
<span id="cb6-10">pop_mean_1rm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span></span>
<span id="cb6-11">pop_sd_1rm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb6-12"></span>
<span id="cb6-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Endurance coefficient population parameters</span></span>
<span id="cb6-14">pop_mean_endurance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb6-15">pop_sd_endurance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb6-16"></span>
<span id="cb6-17">min_reps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb6-18">max_reps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb6-19"></span>
<span id="cb6-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Observation noise</span></span>
<span id="cb6-21">obs_noise_sd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb6-22"></span>
<span id="cb6-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate athlete-level ground truth</span></span>
<span id="cb6-24">athletes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pl.DataFrame(</span>
<span id="cb6-25">    {</span>
<span id="cb6-26">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete_id"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_athletes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb6-27">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true_1rm"</span>: np.random.normal(pop_mean_1rm, pop_sd_1rm, n_athletes),</span>
<span id="cb6-28">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true_endurance"</span>: np.random.normal(</span>
<span id="cb6-29">            pop_mean_endurance, pop_sd_endurance, n_athletes</span>
<span id="cb6-30">        ),</span>
<span id="cb6-31">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_observations"</span>: np.random.randint(min_n_obs, max_n_obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_athletes),</span>
<span id="cb6-32">    }</span>
<span id="cb6-33">)</span>
<span id="cb6-34"></span>
<span id="cb6-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate observations by expanding each athlete's rows</span></span>
<span id="cb6-36">n_total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> athletes[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_observations"</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb6-37"></span>
<span id="cb6-38">simulated_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb6-39">    athletes.select(</span>
<span id="cb6-40">        pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete_id"</span>).repeat_by(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_observations"</span>).explode(),</span>
<span id="cb6-41">        pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true_1rm"</span>).repeat_by(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_observations"</span>).explode(),</span>
<span id="cb6-42">        pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true_endurance"</span>).repeat_by(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_observations"</span>).explode(),</span>
<span id="cb6-43">    )</span>
<span id="cb6-44">    .with_columns(</span>
<span id="cb6-45">        session_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pl.int_range(pl.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>()).over(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete_id"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb6-46">    )</span>
<span id="cb6-47">    .with_columns(</span>
<span id="cb6-48">        reps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pl.Series(np.random.randint(min_reps, max_reps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_total)),</span>
<span id="cb6-49">    )</span>
<span id="cb6-50">    .with_columns(</span>
<span id="cb6-51">        weight_theoretical<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true_1rm"</span>)</span>
<span id="cb6-52">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true_endurance"</span>)),</span>
<span id="cb6-53">    )</span>
<span id="cb6-54">    .with_columns(</span>
<span id="cb6-55">        weight_observed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight_theoretical"</span>)</span>
<span id="cb6-56">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pl.Series(np.random.normal(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, obs_noise_sd, n_total)),</span>
<span id="cb6-57">    )</span>
<span id="cb6-58">)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>Iâ€™ve simulated 30 fake athletes, each with their own 1RM, strength endurance capacity, and number of previous sessions of data where theyâ€™ve performed a max reps set for this given exercise.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Iâ€™m going light on simulation details here to keep this accessible. Expand the section below to get more statistical details on the parameters of the simulated data.</p>
</div>
</div>
<details aria-label="Simulation technical details (optional)" id="details-1">
<summary>Simulation technical details (optional)</summary>
<p>Iâ€™ve defined the â€œsquadâ€ (30 athletes) to have a mean 1RM of 140kg
and standard deviation of 15kg drawn from a random normal distribution.
I also assign them an <strong>endurance ability</strong> (also drawn
from a normal distribution with a mean of 30 and standard deviation of
5).</p>
<p>Each athlete will have data from somewhere between 5 and 30 previous
training sessions where theyâ€™ve done this exercises til failure.</p>
<p>For each of these max rep sets, the athletes complete somewhere
between 2 and 15 reps (randomly sampled with replacement from a uniform
distribution). I calculate a theoretical weight they should be able to
complete for the set given their simulated 1RM and reps performed based
on a modified Epley formula (probably most commonly used e1RM formula,
modified to account for variable endurance ability).</p>
<p>I finally simulate the actual weight they lifted for the set by
taking the weight they theoretically could lift given their simulated
1RM and reps, added some random noise (because humans work like that)
drawn randomly from a normal distribution (mean of 0, SD of 2).</p>
</details>
<p>The simulated athlete data looks like this:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" aria-controls="tabset-4-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" aria-controls="tabset-4-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-4-1" class="tab-pane active" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">athletes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric), \(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_preview</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">preview_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pl.concat(</span>
<span id="cb8-2">    [</span>
<span id="cb8-3">        athletes.head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>).with_columns(cs.by_dtype(pl.Float64).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)).cast(pl.String),</span>
<span id="cb8-4">        pl.DataFrame({col: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"â‹®"</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> col <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> athletes.columns}),</span>
<span id="cb8-5">        athletes.tail(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).with_columns(cs.by_dtype(pl.Float64).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)).cast(pl.String),</span>
<span id="cb8-6">    ]</span>
<span id="cb8-7">)</span>
<span id="cb8-8"></span>
<span id="cb8-9">GT(preview_df)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="wzjgcrdioc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#wzjgcrdioc table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wzjgcrdioc thead, #wzjgcrdioc tbody, #wzjgcrdioc tfoot, #wzjgcrdioc tr, #wzjgcrdioc td, #wzjgcrdioc th {
  border-style: none;
}

#wzjgcrdioc p {
  margin: 0;
  padding: 0;
}

#wzjgcrdioc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wzjgcrdioc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wzjgcrdioc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wzjgcrdioc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wzjgcrdioc .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wzjgcrdioc .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wzjgcrdioc .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wzjgcrdioc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wzjgcrdioc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wzjgcrdioc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wzjgcrdioc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wzjgcrdioc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wzjgcrdioc .gt_spanner_row {
  border-bottom-style: hidden;
}

#wzjgcrdioc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wzjgcrdioc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#wzjgcrdioc .gt_from_md > :first-child {
  margin-top: 0;
}

#wzjgcrdioc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wzjgcrdioc .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wzjgcrdioc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#wzjgcrdioc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wzjgcrdioc .gt_row_group_first td {
  border-top-width: 2px;
}

#wzjgcrdioc .gt_row_group_first th {
  border-top-width: 2px;
}

#wzjgcrdioc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzjgcrdioc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wzjgcrdioc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wzjgcrdioc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wzjgcrdioc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzjgcrdioc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wzjgcrdioc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wzjgcrdioc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wzjgcrdioc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wzjgcrdioc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wzjgcrdioc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzjgcrdioc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wzjgcrdioc .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzjgcrdioc .gt_left {
  text-align: left;
}

#wzjgcrdioc .gt_center {
  text-align: center;
}

#wzjgcrdioc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wzjgcrdioc .gt_font_normal {
  font-weight: normal;
}

#wzjgcrdioc .gt_font_bold {
  font-weight: bold;
}

#wzjgcrdioc .gt_font_italic {
  font-style: italic;
}

#wzjgcrdioc .gt_super {
  font-size: 65%;
}

#wzjgcrdioc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wzjgcrdioc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wzjgcrdioc .gt_indent_1 {
  text-indent: 5px;
}

#wzjgcrdioc .gt_indent_2 {
  text-indent: 10px;
}

#wzjgcrdioc .gt_indent_3 {
  text-indent: 15px;
}

#wzjgcrdioc .gt_indent_4 {
  text-indent: 20px;
}

#wzjgcrdioc .gt_indent_5 {
  text-indent: 25px;
}

#wzjgcrdioc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wzjgcrdioc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

pyvcvuyfkc
#pyvcvuyfkc tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="a::stub"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="athlete_id">athlete_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="true_1rm">true_1rm</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="true_endurance">true_endurance</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="n_observations">n_observations</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><th id="stub_1_1" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">1</th>
<td headers="stub_1_1 athlete_id" class="gt_row gt_right">1</td>
<td headers="stub_1_1 true_1rm" class="gt_row gt_right">145.4</td>
<td headers="stub_1_1 true_endurance" class="gt_row gt_right">27.8</td>
<td headers="stub_1_1 n_observations" class="gt_row gt_right">28</td></tr>
    <tr><th id="stub_1_2" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">2</th>
<td headers="stub_1_2 athlete_id" class="gt_row gt_right">2</td>
<td headers="stub_1_2 true_1rm" class="gt_row gt_right">131.2</td>
<td headers="stub_1_2 true_endurance" class="gt_row gt_right">41.8</td>
<td headers="stub_1_2 n_observations" class="gt_row gt_right">20</td></tr>
    <tr><th id="stub_1_3" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">3</th>
<td headers="stub_1_3 athlete_id" class="gt_row gt_right">3</td>
<td headers="stub_1_3 true_1rm" class="gt_row gt_right">139.6</td>
<td headers="stub_1_3 true_endurance" class="gt_row gt_right">31.8</td>
<td headers="stub_1_3 n_observations" class="gt_row gt_right">21</td></tr>
    <tr><th id="stub_1_4" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">4</th>
<td headers="stub_1_4 athlete_id" class="gt_row gt_right">4</td>
<td headers="stub_1_4 true_1rm" class="gt_row gt_right">133.6</td>
<td headers="stub_1_4 true_endurance" class="gt_row gt_right">26.1</td>
<td headers="stub_1_4 n_observations" class="gt_row gt_right">29</td></tr>
    <tr><th id="stub_1_5" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">5</th>
<td headers="stub_1_5 athlete_id" class="gt_row gt_right">5</td>
<td headers="stub_1_5 true_1rm" class="gt_row gt_right">97.8</td>
<td headers="stub_1_5 true_endurance" class="gt_row gt_right">32.9</td>
<td headers="stub_1_5 n_observations" class="gt_row gt_right">30</td></tr>
    <tr><th id="stub_1_6" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">6..29</th>
<td headers="stub_1_6 athlete_id" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 true_1rm" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 true_endurance" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 n_observations" class="gt_row gt_right" style="background-color: #E4E4E4;"></td></tr>
    <tr><th id="stub_1_7" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">30</th>
<td headers="stub_1_7 athlete_id" class="gt_row gt_right">30</td>
<td headers="stub_1_7 true_1rm" class="gt_row gt_right">147.9</td>
<td headers="stub_1_7 true_endurance" class="gt_row gt_right">28.5</td>
<td headers="stub_1_7 n_observations" class="gt_row gt_right">6</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>I use these athletes and their characteristics to simulate realistic weights and reps. This gives me 582 simulated max rep sets across the 30 athletes.</p>
<p>The simulated sets data looks like this:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" aria-controls="tabset-5-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" aria-controls="tabset-5-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-5-1" class="tab-pane active" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">simulated_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true"</span>), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>weight_theoretical) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric), \(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_preview</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">sets_preview <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> simulated_data.select(</span>
<span id="cb10-2">    pl.exclude(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^true.*$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight_theoretical"</span>)</span>
<span id="cb10-3">).with_columns(cs.by_dtype(pl.Float64).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb10-4"></span>
<span id="cb10-5">preview_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pl.concat(</span>
<span id="cb10-6">    [</span>
<span id="cb10-7">        sets_preview.head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>).cast(pl.String),</span>
<span id="cb10-8">        pl.DataFrame({col: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"â‹®"</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> col <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sets_preview.columns}),</span>
<span id="cb10-9">        sets_preview.tail(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).cast(pl.String),</span>
<span id="cb10-10">    ]</span>
<span id="cb10-11">)</span>
<span id="cb10-12"></span>
<span id="cb10-13">GT(preview_df)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="nrbxiqcxht" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#nrbxiqcxht table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nrbxiqcxht thead, #nrbxiqcxht tbody, #nrbxiqcxht tfoot, #nrbxiqcxht tr, #nrbxiqcxht td, #nrbxiqcxht th {
  border-style: none;
}

#nrbxiqcxht p {
  margin: 0;
  padding: 0;
}

#nrbxiqcxht .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nrbxiqcxht .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nrbxiqcxht .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nrbxiqcxht .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nrbxiqcxht .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nrbxiqcxht .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nrbxiqcxht .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nrbxiqcxht .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nrbxiqcxht .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nrbxiqcxht .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nrbxiqcxht .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nrbxiqcxht .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nrbxiqcxht .gt_spanner_row {
  border-bottom-style: hidden;
}

#nrbxiqcxht .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nrbxiqcxht .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#nrbxiqcxht .gt_from_md > :first-child {
  margin-top: 0;
}

#nrbxiqcxht .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nrbxiqcxht .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nrbxiqcxht .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#nrbxiqcxht .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nrbxiqcxht .gt_row_group_first td {
  border-top-width: 2px;
}

#nrbxiqcxht .gt_row_group_first th {
  border-top-width: 2px;
}

#nrbxiqcxht .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nrbxiqcxht .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nrbxiqcxht .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nrbxiqcxht .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nrbxiqcxht .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nrbxiqcxht .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nrbxiqcxht .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nrbxiqcxht .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nrbxiqcxht .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nrbxiqcxht .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nrbxiqcxht .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nrbxiqcxht .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nrbxiqcxht .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nrbxiqcxht .gt_left {
  text-align: left;
}

#nrbxiqcxht .gt_center {
  text-align: center;
}

#nrbxiqcxht .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nrbxiqcxht .gt_font_normal {
  font-weight: normal;
}

#nrbxiqcxht .gt_font_bold {
  font-weight: bold;
}

#nrbxiqcxht .gt_font_italic {
  font-style: italic;
}

#nrbxiqcxht .gt_super {
  font-size: 65%;
}

#nrbxiqcxht .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nrbxiqcxht .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nrbxiqcxht .gt_indent_1 {
  text-indent: 5px;
}

#nrbxiqcxht .gt_indent_2 {
  text-indent: 10px;
}

#nrbxiqcxht .gt_indent_3 {
  text-indent: 15px;
}

#nrbxiqcxht .gt_indent_4 {
  text-indent: 20px;
}

#nrbxiqcxht .gt_indent_5 {
  text-indent: 25px;
}

#nrbxiqcxht .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nrbxiqcxht div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

dvzlmtvjsa
#dvzlmtvjsa tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="a::stub"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="athlete_id">athlete_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="session_id">session_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="reps">reps</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="weight_observed">weight_observed</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><th id="stub_1_1" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">1</th>
<td headers="stub_1_1 athlete_id" class="gt_row gt_right">1</td>
<td headers="stub_1_1 session_id" class="gt_row gt_right">1</td>
<td headers="stub_1_1 reps" class="gt_row gt_right">7</td>
<td headers="stub_1_1 weight_observed" class="gt_row gt_right">116.9</td></tr>
    <tr><th id="stub_1_2" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">2</th>
<td headers="stub_1_2 athlete_id" class="gt_row gt_right">1</td>
<td headers="stub_1_2 session_id" class="gt_row gt_right">2</td>
<td headers="stub_1_2 reps" class="gt_row gt_right">15</td>
<td headers="stub_1_2 weight_observed" class="gt_row gt_right">94.3</td></tr>
    <tr><th id="stub_1_3" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">3</th>
<td headers="stub_1_3 athlete_id" class="gt_row gt_right">1</td>
<td headers="stub_1_3 session_id" class="gt_row gt_right">3</td>
<td headers="stub_1_3 reps" class="gt_row gt_right">4</td>
<td headers="stub_1_3 weight_observed" class="gt_row gt_right">127.8</td></tr>
    <tr><th id="stub_1_4" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">4</th>
<td headers="stub_1_4 athlete_id" class="gt_row gt_right">1</td>
<td headers="stub_1_4 session_id" class="gt_row gt_right">4</td>
<td headers="stub_1_4 reps" class="gt_row gt_right">14</td>
<td headers="stub_1_4 weight_observed" class="gt_row gt_right">99.4</td></tr>
    <tr><th id="stub_1_5" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">5</th>
<td headers="stub_1_5 athlete_id" class="gt_row gt_right">1</td>
<td headers="stub_1_5 session_id" class="gt_row gt_right">5</td>
<td headers="stub_1_5 reps" class="gt_row gt_right">3</td>
<td headers="stub_1_5 weight_observed" class="gt_row gt_right">128.0</td></tr>
    <tr><th id="stub_1_6" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">6..581</th>
<td headers="stub_1_6 athlete_id" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 session_id" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 reps" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 weight_observed" class="gt_row gt_right" style="background-color: #E4E4E4;"></td></tr>
    <tr><th id="stub_1_7" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">582</th>
<td headers="stub_1_7 athlete_id" class="gt_row gt_right">30</td>
<td headers="stub_1_7 session_id" class="gt_row gt_right">6</td>
<td headers="stub_1_7 reps" class="gt_row gt_right">7</td>
<td headers="stub_1_7 weight_observed" class="gt_row gt_right">116.2</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="the-model" class="level3">
<h3 class="anchored" data-anchor-id="the-model">The model</h3>
<p>Iâ€™ll specify the model to follow a modified <a href="https://1repmaxcalculator.net/topics/epley-formula">Epley formula</a>.</p>
<p>Reasons for this:</p>
<ol type="1">
<li><p>Itâ€™s probably the most commonly used of the standard 1RM estimate formulas</p></li>
<li><p>Itâ€™s fairly simple (good for demo purposes)</p></li>
<li><p>I used it as part of how the data was simulated, so seeing how the modelâ€™s performance compares to the standard Epley formula for predicting the true (albeit simulated) 1RMs will be a good test.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If I had real training data (instead of simulated), I would fit a bunch of different model specifications to see which one performs best.</p>
</div>
</div>
<p>The standard Epley is <code>weight * (1 + reps / 30)</code>.</p>
<p>The modification Iâ€™m using just changes the <code>30</code> (fixed constant representing how quickly strength drops off with more reps; same for everyone) to a parameter the model will optimise based on the data for each athlete. Each athlete gets their own value for this based on how they handle high intensity sets or high volume sets.</p>
<p>Iâ€™ll fit the model on all the simulated data <em>except the most recent set for each athlete</em>. Iâ€™ll keep these sets as a small holdout or test data for comparing predictive performance between my model and the standard Epley formula.</p>
<details aria-label="Stats details about the model (optional)" id="details-2">
<summary>Stats details about the model (optional)</summary>
<p>The standard Epley formula estimates 1RM from a submaximal lift, but
this treats 1RM as the outcome (which we donâ€™t observe directly). What
we actually observe is the weight lifted for a given number of reps.
Solving for weight, the formula becomes
<code>weight = 1RM / (1 + reps / 30)</code>. This makes weight the
outcome, matching the data thatâ€™s observed in reality. The 1RM becomes a
latent parameter we estimate, and we replace the fixed constant 30 with
an estimated <em>endurance parameter</em>, which is log-transformed to
ensure positivity and improve sampling efficiency.</p>
<p>The hierarchical structure specifies that both 1RM and endurance vary
by athlete with partial pooling. The amount of regularisation or
shrinkage is adaptive. Athletes with less data get pulled more toward
the group mean and athletes with more data retain more of their
individual signal.</p>
<p>Weakly informative priors regularise the model (preventing
overfitting and improving convergence) without dominating the
likelihood. With reasonable data, the posterior will be driven primarily
by the observed (simulated) data.</p>
<p>Although theyâ€™re not included in this post (I wanted to keep it
tight), I did do prior predictive checks (to ensure my priors were
plausible), model diagnostic checks (to ensure no issues during
sampling), and posterior predictive checks (to ensure the modelâ€™s
assumptions adequately captured the features of the observed data).</p>
</details>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" aria-controls="tabset-6-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" aria-controls="tabset-6-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-6-1" class="tab-pane active" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data prep</span></span>
<span id="cb11-2">model_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simulated_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb11-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># brms doesn't like underscores or . in variable names</span></span>
<span id="cb11-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">athlete =</span> athlete_id,</span>
<span id="cb11-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">orm =</span> true_1rm,</span>
<span id="cb11-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> weight_observed</span>
<span id="cb11-8">  )</span>
<span id="cb11-9"></span>
<span id="cb11-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Train/test split: hold out last observation per athlete</span></span>
<span id="cb11-11">holdout <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(athlete) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(session_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb11-15"></span>
<span id="cb11-16">train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(holdout, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"session_id"</span>))</span>
<span id="cb11-18"></span>
<span id="cb11-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Model specification</span></span>
<span id="cb11-20">modified_epley_formula <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bf</span>(</span>
<span id="cb11-21">  weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> orm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(logk)),</span>
<span id="cb11-22">  orm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> athlete),</span>
<span id="cb11-23">  logk <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> athlete),</span>
<span id="cb11-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nl =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb11-25">)</span>
<span id="cb11-26"></span>
<span id="cb11-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prior specification</span></span>
<span id="cb11-28">modified_epley_priors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb11-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intercept"</span>),</span>
<span id="cb11-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">normal</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logk"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intercept"</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># log(30) â‰ˆ 3.4</span></span>
<span id="cb11-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exponential</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">class =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sd"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orm"</span>),</span>
<span id="cb11-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exponential</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">class =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sd"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlpar =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logk"</span>),</span>
<span id="cb11-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exponential</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">class =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sigma"</span>)</span>
<span id="cb11-34">)</span>
<span id="cb11-35"></span>
<span id="cb11-36"></span>
<span id="cb11-37">modified_epley_model_fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(</span>
<span id="cb11-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> modified_epley_formula,</span>
<span id="cb11-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> train,</span>
<span id="cb11-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior =</span> modified_epley_priors,</span>
<span id="cb11-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gaussian</span>(),</span>
<span id="cb11-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb11-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb11-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4000</span>,</span>
<span id="cb11-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warmup =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb11-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adapt_delta =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_treedepth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb11-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2534</span>,</span>
<span id="cb11-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"modified_epley_model_fit"</span></span>
<span id="cb11-49">)</span>
<span id="cb11-50"></span>
<span id="cb11-51">estimate_1rm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(model, athlete_id, weight, reps) {</span>
<span id="cb11-52">  model <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-53">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spread_draws</span>(b_logk_Intercept, r_athlete__logk[athlete, ]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-54">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(athlete <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> athlete_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-55">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb11-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">est_endurance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(b_logk_Intercept <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> r_athlete__logk),</span>
<span id="cb11-57">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">est_1RM =</span> weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> est_endurance)</span>
<span id="cb11-58">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-59">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(.draw, athlete, est_endurance, est_1RM)</span>
<span id="cb11-60">}</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data prep</span></span>
<span id="cb12-2">model_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> simulated_data.rename(</span>
<span id="cb12-3">    {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete_id"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true_1rm"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight_observed"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>}</span>
<span id="cb12-4">)</span>
<span id="cb12-5"></span>
<span id="cb12-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Train/test split: hold out last observation per athlete</span></span>
<span id="cb12-7">holdout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model_data.sort(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"session_id"</span>).group_by(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>).last()</span>
<span id="cb12-8"></span>
<span id="cb12-9">train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model_data.join(</span>
<span id="cb12-10">    holdout.select(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"session_id"</span>), on<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"session_id"</span>], how<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"anti"</span></span>
<span id="cb12-11">)</span>
<span id="cb12-12"></span>
<span id="cb12-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to numpy for PyMC</span></span>
<span id="cb12-14">athlete_idx, athlete_codes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb12-15">    train[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>].to_numpy(),</span>
<span id="cb12-16">    np.unique(train[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>].to_numpy()),</span>
<span id="cb12-17">)</span>
<span id="cb12-18">athlete_idx_mapped <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([np.where(athlete_codes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> a)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> a <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> athlete_idx])</span>
<span id="cb12-19">n_athletes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(athlete_codes)</span>
<span id="cb12-20">weight <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>].to_numpy()</span>
<span id="cb12-21">reps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>].to_numpy()</span>
<span id="cb12-22"></span>
<span id="cb12-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Model specification</span></span>
<span id="cb12-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> pm.Model() <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> modified_epley_model:</span>
<span id="cb12-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hyperpriors</span></span>
<span id="cb12-26">    orm_mu <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pm.Normal(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orm_mu"</span>, mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span>, sigma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb12-27">    orm_sigma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pm.Exponential(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orm_sigma"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)</span>
<span id="cb12-28"></span>
<span id="cb12-29">    logk_mu <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pm.Normal(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logk_mu"</span>, mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.4</span>, sigma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># log(30) â‰ˆ 3.4</span></span>
<span id="cb12-30">    logk_sigma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pm.Exponential(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logk_sigma"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb12-31"></span>
<span id="cb12-32">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Athlete-level parameters</span></span>
<span id="cb12-33">    orm_athlete <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pm.Normal(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orm_athlete"</span>, mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>orm_mu, sigma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>orm_sigma, shape<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_athletes)</span>
<span id="cb12-34">    logk_athlete <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pm.Normal(</span>
<span id="cb12-35">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logk_athlete"</span>, mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>logk_mu, sigma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>logk_sigma, shape<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_athletes</span>
<span id="cb12-36">    )</span>
<span id="cb12-37"></span>
<span id="cb12-38">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Observation noise</span></span>
<span id="cb12-39">    sigma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pm.Exponential(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sigma"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span>
<span id="cb12-40"></span>
<span id="cb12-41">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Modified Epley formula: weight = orm / (1 + reps / exp(logk))</span></span>
<span id="cb12-42">    mu <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> orm_athlete[athlete_idx_mapped] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (</span>
<span id="cb12-43">        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.exp(logk_athlete[athlete_idx_mapped])</span>
<span id="cb12-44">    )</span>
<span id="cb12-45"></span>
<span id="cb12-46">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Likelihood</span></span>
<span id="cb12-47">    weight_obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pm.Normal(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight_obs"</span>, mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mu, sigma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sigma, observed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>weight)</span>
<span id="cb12-48"></span>
<span id="cb12-49">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample</span></span>
<span id="cb12-50">    modified_epley_trace <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pm.sample(</span>
<span id="cb12-51">        draws<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb12-52">        tune<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb12-53">        cores<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb12-54">        chains<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb12-55">        random_seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2534</span>,</span>
<span id="cb12-56">        target_accept<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>,</span>
<span id="cb12-57">    )</span>
<span id="cb12-58"></span>
<span id="cb12-59"></span>
<span id="cb12-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to estimate 1RM</span></span>
<span id="cb12-61"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> estimate_1rm(trace, athlete_id, weight, reps, n_samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4000</span>):</span>
<span id="cb12-62">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get athlete index</span></span>
<span id="cb12-63">    athlete_idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.where(athlete_codes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> athlete_id)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb12-64"></span>
<span id="cb12-65">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract posterior samples</span></span>
<span id="cb12-66">    logk_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> trace.posterior[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logk_athlete"</span>].values.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_athletes)[</span>
<span id="cb12-67">        :, athlete_idx</span>
<span id="cb12-68">    ]</span>
<span id="cb12-69"></span>
<span id="cb12-70">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate estimated 1RM for each posterior sample</span></span>
<span id="cb12-71">    est_endurance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.exp(logk_samples)</span>
<span id="cb12-72">    est_1rm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weight <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> est_endurance)</span>
<span id="cb12-73"></span>
<span id="cb12-74">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> {</span>
<span id="cb12-75">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>: athlete_id,</span>
<span id="cb12-76">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_endurance"</span>: est_endurance[:n_samples],</span>
<span id="cb12-77">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1rm"</span>: est_1rm[:n_samples],</span>
<span id="cb12-78">    }</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>Now the model is fit, I use it to make 1RM estimates with the help of a custom function Iâ€™ve defined called <code>estimate_1rm()</code>. It takes the model object, the athlete ID, and the weight and reps the athlete performed in the set as arguments and gives me back a distribution of predictions.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" aria-controls="tabset-7-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" aria-controls="tabset-7-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-7-1" class="tab-pane active" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">example_predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">estimate_1rm</span>(</span>
<span id="cb13-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> modified_epley_model_fit,</span>
<span id="cb13-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">athlete_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>,</span>
<span id="cb13-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">102.5</span>,</span>
<span id="cb13-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb13-6">)</span></code></pre></div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">example_predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> estimate_1rm(</span>
<span id="cb14-2">    trace<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>modified_epley_trace, athlete_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">102.5</span>, reps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb14-3">)</span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" aria-controls="tabset-8-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" aria-controls="tabset-8-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-8-1" class="tab-pane active" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">example_dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> example_predictions <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> est_1RM)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_slab</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lighten</span>(colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_spike</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">at =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"median"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_thickness_shared</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb15-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"curve"</span>,</span>
<span id="cb15-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">120.5</span>,</span>
<span id="cb15-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(example_predictions<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>est_1RM) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb15-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb15-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.925</span>,</span>
<span id="cb15-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb15-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"closed"</span>),</span>
<span id="cb15-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span></span>
<span id="cb15-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb15-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb15-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">121.3</span>,</span>
<span id="cb15-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>,</span>
<span id="cb15-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1RM estimate</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(median)"</span>,</span>
<span id="cb15-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb15-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey35"</span>,</span>
<span id="cb15-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span></span>
<span id="cb15-24">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb15-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb15-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">116.7</span>,</span>
<span id="cb15-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb15-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lower end of</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">estimates"</span>,</span>
<span id="cb15-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb15-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey35"</span>,</span>
<span id="cb15-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span></span>
<span id="cb15-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb15-35">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb15-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">122</span>,</span>
<span id="cb15-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb15-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Upper end of</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">estimates"</span>,</span>
<span id="cb15-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb15-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey35"</span>,</span>
<span id="cb15-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span></span>
<span id="cb15-42">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb15-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated 1RM"</span>,</span>
<span id="cb15-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> socials,</span>
<span id="cb15-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Full distribution of 1RM estimates"</span>,</span>
<span id="cb15-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Athlete 17 | Max reps set of 5 @ 102.5"</span>, units)</span>
<span id="cb15-48">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb15-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">116</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">122</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb15-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> units)</span>
<span id="cb15-52">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb15-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb15-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb15-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb15-58">  )</span>
<span id="cb15-59"></span>
<span id="cb15-60">example_dist</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">example_pred_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>: example_predictions[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1rm"</span>]})</span>
<span id="cb16-2"></span>
<span id="cb16-3">(</span>
<span id="cb16-4">    ggplot(example_pred_df, aes(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>))</span>
<span id="cb16-5">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> geom_density(fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#a8c7e6"</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb16-6">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> geom_vline(</span>
<span id="cb16-7">        xintercept<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>example_pred_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>].median(), color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#134A8E"</span>, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb16-8">    )</span>
<span id="cb16-9">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> labs(</span>
<span id="cb16-10">        x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated 1RM"</span>,</span>
<span id="cb16-11">        y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb16-12">        title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Full distribution of 1RM estimates"</span>,</span>
<span id="cb16-13">        subtitle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Athlete 17 | Max reps set of 5 @ 102.5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>units<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb16-14">    )</span>
<span id="cb16-15">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> scale_x_continuous(labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x: [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>v<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.0f}{</span>units<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> x])</span>
<span id="cb16-16">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> theme_classic()</span>
<span id="cb16-17">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> theme(</span>
<span id="cb16-18">        axis_text_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb16-19">        axis_ticks_major_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb16-20">        axis_line_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb16-21">        axis_title_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb16-22">        plot_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb16-23">        plot_subtitle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>),</span>
<span id="cb16-24">    )</span>
<span id="cb16-25">)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2026-01-04-e1rm-modelling/index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Sometimes the full distribution is a bit much and you just want a summary (e.g.&nbsp;median with 80% credible intervals).<sup>2</sup> Easy.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" aria-controls="tabset-9-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" aria-controls="tabset-9-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-9-1" class="tab-pane active" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">example_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> example_predictions <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median_qi</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contains</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"endurance"</span>), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.interval) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric), \(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb17-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb17-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb17-7"></span>
<span id="cb17-8">example_summary</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">median_1rm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.median(example_predictions[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1rm"</span>])</span>
<span id="cb18-2">lower_1rm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.percentile(example_predictions[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1rm"</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb18-3">upper_1rm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.percentile(example_predictions[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1rm"</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)</span>
<span id="cb18-4"></span>
<span id="cb18-5">summary_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pl.DataFrame(</span>
<span id="cb18-6">    {</span>
<span id="cb18-7">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>: [example_predictions[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>]],</span>
<span id="cb18-8">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>: [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(median_1rm, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)],</span>
<span id="cb18-9">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM_lower"</span>: [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(lower_1rm, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)],</span>
<span id="cb18-10">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM_upper"</span>: [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(upper_1rm, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)],</span>
<span id="cb18-11">    }</span>
<span id="cb18-12">)</span>
<span id="cb18-13"></span>
<span id="cb18-14">GT(summary_df)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fmexrawwzh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#fmexrawwzh table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fmexrawwzh thead, #fmexrawwzh tbody, #fmexrawwzh tfoot, #fmexrawwzh tr, #fmexrawwzh td, #fmexrawwzh th {
  border-style: none;
}

#fmexrawwzh p {
  margin: 0;
  padding: 0;
}

#fmexrawwzh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fmexrawwzh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fmexrawwzh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fmexrawwzh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fmexrawwzh .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fmexrawwzh .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fmexrawwzh .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fmexrawwzh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fmexrawwzh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fmexrawwzh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fmexrawwzh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fmexrawwzh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fmexrawwzh .gt_spanner_row {
  border-bottom-style: hidden;
}

#fmexrawwzh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fmexrawwzh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#fmexrawwzh .gt_from_md > :first-child {
  margin-top: 0;
}

#fmexrawwzh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fmexrawwzh .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fmexrawwzh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#fmexrawwzh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fmexrawwzh .gt_row_group_first td {
  border-top-width: 2px;
}

#fmexrawwzh .gt_row_group_first th {
  border-top-width: 2px;
}

#fmexrawwzh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmexrawwzh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fmexrawwzh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fmexrawwzh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fmexrawwzh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmexrawwzh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fmexrawwzh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fmexrawwzh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fmexrawwzh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fmexrawwzh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fmexrawwzh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmexrawwzh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fmexrawwzh .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmexrawwzh .gt_left {
  text-align: left;
}

#fmexrawwzh .gt_center {
  text-align: center;
}

#fmexrawwzh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fmexrawwzh .gt_font_normal {
  font-weight: normal;
}

#fmexrawwzh .gt_font_bold {
  font-weight: bold;
}

#fmexrawwzh .gt_font_italic {
  font-style: italic;
}

#fmexrawwzh .gt_super {
  font-size: 65%;
}

#fmexrawwzh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fmexrawwzh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fmexrawwzh .gt_indent_1 {
  text-indent: 5px;
}

#fmexrawwzh .gt_indent_2 {
  text-indent: 10px;
}

#fmexrawwzh .gt_indent_3 {
  text-indent: 15px;
}

#fmexrawwzh .gt_indent_4 {
  text-indent: 20px;
}

#fmexrawwzh .gt_indent_5 {
  text-indent: 25px;
}

#fmexrawwzh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fmexrawwzh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

#fmexrawwzh tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="athlete">athlete</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="est_1RM">est_1RM</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="est_1RM.lower">est_1RM.lower</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="est_1RM.upper">est_1RM.upper</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="a.width">.width</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="a.point">.point</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="athlete" class="gt_row gt_right">17</td>
<td headers="est_1RM" class="gt_row gt_right">119.3</td>
<td headers="est_1RM.lower" class="gt_row gt_right">118.2</td>
<td headers="est_1RM.upper" class="gt_row gt_right">120.3</td>
<td headers=".width" class="gt_row gt_right">0.8</td>
<td headers=".point" class="gt_row gt_left">median</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
</section>
<section id="how-accurate-is-it" class="level2">
<h2 class="anchored" data-anchor-id="how-accurate-is-it">How accurate is it?</h2>
<p>By seeing how close the model got to the true 1RM (defined in the simulation), and doing the same for the standard Epley formula, we can compare their predictive accuracy on new sets.<sup>3</sup></p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" aria-controls="tabset-10-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" aria-controls="tabset-10-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-10-1" class="tab-pane active" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">holdout_predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> holdout <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb19-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model_prediction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">estimate_1rm</span>(</span>
<span id="cb19-5">      modified_epley_model_fit,</span>
<span id="cb19-6">      athlete,</span>
<span id="cb19-7">      weight,</span>
<span id="cb19-8">      reps</span>
<span id="cb19-9">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-10">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prediction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(est_1RM)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-11">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(prediction),</span>
<span id="cb19-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">standard_epley_prediction =</span> weight <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb19-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb19-16">    athletes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">athlete =</span> athlete_id, true_1rm),</span>
<span id="cb19-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span></span>
<span id="cb19-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb19-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model_error =</span> model_prediction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> true_1rm,</span>
<span id="cb19-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">standard_epley_error =</span> standard_epley_prediction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> true_1rm,</span>
<span id="cb19-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">difference =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(model_error) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(standard_epley_error),</span>
<span id="cb19-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">most_accurate_method =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb19-24">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(difference) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Similar predictions (Â±1)"</span>,</span>
<span id="cb19-25">      difference <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb19-26">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model closer by "</span>,</span>
<span id="cb19-27">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(difference), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb19-28">        units</span>
<span id="cb19-29">      ),</span>
<span id="cb19-30">      difference <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb19-31">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formula closer by "</span>,</span>
<span id="cb19-32">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(difference), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb19-33">        units</span>
<span id="cb19-34">      ),</span>
<span id="cb19-35">    )</span>
<span id="cb19-36">  )</span>
<span id="cb19-37"></span>
<span id="cb19-38">tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> holdout_predictions <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(</span>
<span id="cb19-40">    athlete,</span>
<span id="cb19-41">    weight,</span>
<span id="cb19-42">    reps,</span>
<span id="cb19-43">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">True 1RM</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> true_1rm,</span>
<span id="cb19-44">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Model prediction</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> model_prediction,</span>
<span id="cb19-45">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Formula prediction</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> standard_epley_prediction,</span>
<span id="cb19-46">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Most accurate method</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> most_accurate_method</span>
<span id="cb19-47">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric), \(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_align</span>(</span>
<span id="cb19-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>,</span>
<span id="cb19-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Most accurate method</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span></span>
<span id="cb19-54">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb19-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_fill</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#DCFCE7"</span>),</span>
<span id="cb19-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_body</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">startsWith</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Most accurate method</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model"</span>))</span>
<span id="cb19-58">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb19-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(</span>
<span id="cb19-61">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>],</span>
<span id="cb19-62">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb19-63">    ),</span>
<span id="cb19-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_body</span>(</span>
<span id="cb19-65">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Most accurate method</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb19-66">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">startsWith</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Most accurate method</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model"</span>)</span>
<span id="cb19-67">    )</span>
<span id="cb19-68">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb19-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_fill</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#DBEAFE"</span>),</span>
<span id="cb19-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_body</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">startsWith</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Most accurate method</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formula"</span>))</span>
<span id="cb19-72">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb19-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(</span>
<span id="cb19-75">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#2563EB"</span>,</span>
<span id="cb19-76">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb19-77">    ),</span>
<span id="cb19-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_body</span>(</span>
<span id="cb19-79">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Most accurate method</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb19-80">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">startsWith</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Most accurate method</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formula"</span>)</span>
<span id="cb19-81">    )</span>
<span id="cb19-82">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_source_note</span>(</span>
<span id="cb19-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">source_note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(socials)</span>
<span id="cb19-85">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb19-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>),</span>
<span id="cb19-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_source_notes</span>()</span>
<span id="cb19-89">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb19-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_options</span>(</span>
<span id="cb19-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">source_notes.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb19-92">  )</span>
<span id="cb19-93"></span>
<span id="cb19-94">tbl</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">holdout_with_truth <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> holdout.join(</span>
<span id="cb20-2">    athletes.select(pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete_id"</span>).alias(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true_1rm"</span>),</span>
<span id="cb20-3">    on<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>,</span>
<span id="cb20-4">    how<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>,</span>
<span id="cb20-5">)</span>
<span id="cb20-6"></span>
<span id="cb20-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get predictions for each holdout observation</span></span>
<span id="cb20-8">model_predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb20-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> holdout_with_truth.iter_rows(named<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>):</span>
<span id="cb20-10">    pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> estimate_1rm(</span>
<span id="cb20-11">        modified_epley_trace,</span>
<span id="cb20-12">        athlete_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>],</span>
<span id="cb20-13">        weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>],</span>
<span id="cb20-14">        reps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>],</span>
<span id="cb20-15">    )</span>
<span id="cb20-16">    model_predictions.append(np.median(pred[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1rm"</span>]))</span>
<span id="cb20-17"></span>
<span id="cb20-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate standard Epley predictions</span></span>
<span id="cb20-19">holdout_predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb20-20">    holdout_with_truth.with_columns(</span>
<span id="cb20-21">        pl.Series(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model prediction"</span>, model_predictions),</span>
<span id="cb20-22">        (pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)).alias(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formula prediction"</span>),</span>
<span id="cb20-23">    )</span>
<span id="cb20-24">    .with_columns(</span>
<span id="cb20-25">        (pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model prediction"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true_1rm"</span>)).alias(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model_error"</span>),</span>
<span id="cb20-26">        (pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formula prediction"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true_1rm"</span>)).alias(</span>
<span id="cb20-27">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"standard_epley_error"</span></span>
<span id="cb20-28">        ),</span>
<span id="cb20-29">    )</span>
<span id="cb20-30">    .with_columns(</span>
<span id="cb20-31">        (pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model_error"</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"standard_epley_error"</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>()).alias(</span>
<span id="cb20-32">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"difference"</span></span>
<span id="cb20-33">        ),</span>
<span id="cb20-34">    )</span>
<span id="cb20-35">    .with_columns(</span>
<span id="cb20-36">        pl.when(pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"difference"</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb20-37">        .then(pl.lit(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Similar predictions (Â±1)"</span>))</span>
<span id="cb20-38">        .when(pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"difference"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb20-39">        .then(</span>
<span id="cb20-40">            pl.lit(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model closer by "</span>)</span>
<span id="cb20-41">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"difference"</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>().<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)).cast(pl.String)</span>
<span id="cb20-42">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pl.lit(units)</span>
<span id="cb20-43">        )</span>
<span id="cb20-44">        .otherwise(</span>
<span id="cb20-45">            pl.lit(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formula closer by "</span>)</span>
<span id="cb20-46">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"difference"</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>().<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)).cast(pl.String)</span>
<span id="cb20-47">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pl.lit(units)</span>
<span id="cb20-48">        )</span>
<span id="cb20-49">        .alias(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Most accurate method"</span>)</span>
<span id="cb20-50">    )</span>
<span id="cb20-51">)</span>
<span id="cb20-52"></span>
<span id="cb20-53">display_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb20-54">    holdout_predictions.sort(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>)</span>
<span id="cb20-55">    .select(</span>
<span id="cb20-56">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>,</span>
<span id="cb20-57">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>,</span>
<span id="cb20-58">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>,</span>
<span id="cb20-59">        pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true_1rm"</span>).alias(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"True 1RM"</span>),</span>
<span id="cb20-60">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model prediction"</span>,</span>
<span id="cb20-61">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formula prediction"</span>,</span>
<span id="cb20-62">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Most accurate method"</span>,</span>
<span id="cb20-63">    )</span>
<span id="cb20-64">    .with_columns(cs.by_dtype(pl.Float64).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb20-65">)</span>
<span id="cb20-66"></span>
<span id="cb20-67">(</span>
<span id="cb20-68">    GT(display_df)</span>
<span id="cb20-69">    .tab_style(</span>
<span id="cb20-70">        style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>style.fill(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#DCFCE7"</span>),</span>
<span id="cb20-71">        locations<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>loc.body(</span>
<span id="cb20-72">            rows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Most accurate method"</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>.starts_with(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model"</span>)</span>
<span id="cb20-73">        ),</span>
<span id="cb20-74">    )</span>
<span id="cb20-75">    .tab_style(</span>
<span id="cb20-76">        style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>style.text(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#16A34A"</span>, weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb20-77">        locations<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>loc.body(</span>
<span id="cb20-78">            columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Most accurate method"</span>,</span>
<span id="cb20-79">            rows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Most accurate method"</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>.starts_with(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model"</span>),</span>
<span id="cb20-80">        ),</span>
<span id="cb20-81">    )</span>
<span id="cb20-82">    .tab_style(</span>
<span id="cb20-83">        style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>style.fill(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#DBEAFE"</span>),</span>
<span id="cb20-84">        locations<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>loc.body(</span>
<span id="cb20-85">            rows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Most accurate method"</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>.starts_with(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formula"</span>)</span>
<span id="cb20-86">        ),</span>
<span id="cb20-87">    )</span>
<span id="cb20-88">    .tab_style(</span>
<span id="cb20-89">        style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>style.text(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#2563EB"</span>, weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb20-90">        locations<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>loc.body(</span>
<span id="cb20-91">            columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Most accurate method"</span>,</span>
<span id="cb20-92">            rows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Most accurate method"</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>.starts_with(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Formula"</span>),</span>
<span id="cb20-93">        ),</span>
<span id="cb20-94">    )</span>
<span id="cb20-95">)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="bdchyginvo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#bdchyginvo table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bdchyginvo thead, #bdchyginvo tbody, #bdchyginvo tfoot, #bdchyginvo tr, #bdchyginvo td, #bdchyginvo th {
  border-style: none;
}

#bdchyginvo p {
  margin: 0;
  padding: 0;
}

#bdchyginvo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bdchyginvo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bdchyginvo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bdchyginvo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bdchyginvo .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bdchyginvo .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bdchyginvo .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bdchyginvo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bdchyginvo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bdchyginvo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bdchyginvo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bdchyginvo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bdchyginvo .gt_spanner_row {
  border-bottom-style: hidden;
}

#bdchyginvo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bdchyginvo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#bdchyginvo .gt_from_md > :first-child {
  margin-top: 0;
}

#bdchyginvo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bdchyginvo .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bdchyginvo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#bdchyginvo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bdchyginvo .gt_row_group_first td {
  border-top-width: 2px;
}

#bdchyginvo .gt_row_group_first th {
  border-top-width: 2px;
}

#bdchyginvo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bdchyginvo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bdchyginvo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bdchyginvo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bdchyginvo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bdchyginvo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bdchyginvo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bdchyginvo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bdchyginvo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bdchyginvo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bdchyginvo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bdchyginvo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bdchyginvo .gt_sourcenote {
  font-size: 15px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bdchyginvo .gt_left {
  text-align: left;
}

#bdchyginvo .gt_center {
  text-align: center;
}

#bdchyginvo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bdchyginvo .gt_font_normal {
  font-weight: normal;
}

#bdchyginvo .gt_font_bold {
  font-weight: bold;
}

#bdchyginvo .gt_font_italic {
  font-style: italic;
}

#bdchyginvo .gt_super {
  font-size: 65%;
}

#bdchyginvo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bdchyginvo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bdchyginvo .gt_indent_1 {
  text-indent: 5px;
}

#bdchyginvo .gt_indent_2 {
  text-indent: 10px;
}

#bdchyginvo .gt_indent_3 {
  text-indent: 15px;
}

#bdchyginvo .gt_indent_4 {
  text-indent: 20px;
}

#bdchyginvo .gt_indent_5 {
  text-indent: 25px;
}

#bdchyginvo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bdchyginvo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

#bdchyginvo tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="athlete">athlete</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="weight">weight</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="reps">reps</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="True-1RM">True 1RM</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="Model-prediction">Model prediction</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="Formula-prediction">Formula prediction</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="Most-accurate-method">Most accurate method</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">1</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">97.0</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">14</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">145.4</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">143.4</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">142.3</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 1.1kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">2</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">119.4</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">4</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">131.2</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">132.1</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">135.4</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 3.3kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">3</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">130.8</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">3</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">139.6</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">142.2</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">143.9</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 1.7kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DBEAFE;">4</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DBEAFE;">90.6</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DBEAFE;">14</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DBEAFE;">133.6</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DBEAFE;">139.3</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DBEAFE;">132.8</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DBEAFE; color: #2563EB; font-weight: bold;">Formula closer by 4.9kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">5</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">69.5</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">13</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">97.8</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">97.5</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">99.7</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 1.6kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">6</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">85.1</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">11</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">130.6</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">128.7</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">116.3</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 12.4kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">7</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">108.4</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">11</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">139.2</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">143.5</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">148.1</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 4.5kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">8</td>
<td headers="weight" class="gt_row gt_right">127.7</td>
<td headers="reps" class="gt_row gt_right">4</td>
<td headers="True 1RM" class="gt_row gt_right">144.3</td>
<td headers="Model prediction" class="gt_row gt_right">144.8</td>
<td headers="Formula prediction" class="gt_row gt_right">144.7</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">9</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">98.5</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">14</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">137.5</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">140.8</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">144.5</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 3.7kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">10</td>
<td headers="weight" class="gt_row gt_right">129.2</td>
<td headers="reps" class="gt_row gt_right">4</td>
<td headers="True 1RM" class="gt_row gt_right">146.0</td>
<td headers="Model prediction" class="gt_row gt_right">145.6</td>
<td headers="Formula prediction" class="gt_row gt_right">146.5</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">11</td>
<td headers="weight" class="gt_row gt_right">101.3</td>
<td headers="reps" class="gt_row gt_right">15</td>
<td headers="True 1RM" class="gt_row gt_right">149.9</td>
<td headers="Model prediction" class="gt_row gt_right">147.9</td>
<td headers="Formula prediction" class="gt_row gt_right">152.0</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">12</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">132.8</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">3</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">140.8</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">142.9</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">146.1</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 3.2kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">13</td>
<td headers="weight" class="gt_row gt_right">98.2</td>
<td headers="reps" class="gt_row gt_right">10</td>
<td headers="True 1RM" class="gt_row gt_right">130.2</td>
<td headers="Model prediction" class="gt_row gt_right">129.5</td>
<td headers="Formula prediction" class="gt_row gt_right">130.9</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">14</td>
<td headers="weight" class="gt_row gt_right">103.3</td>
<td headers="reps" class="gt_row gt_right">7</td>
<td headers="True 1RM" class="gt_row gt_right">132.4</td>
<td headers="Model prediction" class="gt_row gt_right">127.5</td>
<td headers="Formula prediction" class="gt_row gt_right">127.4</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">15</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">111.2</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">11</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">164.1</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">154.2</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">152.0</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 2.2kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">16</td>
<td headers="weight" class="gt_row gt_right">76.2</td>
<td headers="reps" class="gt_row gt_right">15</td>
<td headers="True 1RM" class="gt_row gt_right">111.8</td>
<td headers="Model prediction" class="gt_row gt_right">113.7</td>
<td headers="Formula prediction" class="gt_row gt_right">114.3</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">17</td>
<td headers="weight" class="gt_row gt_right">91.7</td>
<td headers="reps" class="gt_row gt_right">9</td>
<td headers="True 1RM" class="gt_row gt_right">119.9</td>
<td headers="Model prediction" class="gt_row gt_right">118.7</td>
<td headers="Formula prediction" class="gt_row gt_right">119.2</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">18</td>
<td headers="weight" class="gt_row gt_right">75.3</td>
<td headers="reps" class="gt_row gt_right">14</td>
<td headers="True 1RM" class="gt_row gt_right">109.3</td>
<td headers="Model prediction" class="gt_row gt_right">110.8</td>
<td headers="Formula prediction" class="gt_row gt_right">110.5</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">19</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">117.9</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">9</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">142.9</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">145.4</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">153.3</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 7.9kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">20</td>
<td headers="weight" class="gt_row gt_right">127.6</td>
<td headers="reps" class="gt_row gt_right">3</td>
<td headers="True 1RM" class="gt_row gt_right">138.3</td>
<td headers="Model prediction" class="gt_row gt_right">139.8</td>
<td headers="Formula prediction" class="gt_row gt_right">140.3</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">21</td>
<td headers="weight" class="gt_row gt_right">138.4</td>
<td headers="reps" class="gt_row gt_right">7</td>
<td headers="True 1RM" class="gt_row gt_right">168.7</td>
<td headers="Model prediction" class="gt_row gt_right">166.3</td>
<td headers="Formula prediction" class="gt_row gt_right">170.7</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DBEAFE;">22</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DBEAFE;">82.6</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DBEAFE;">15</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DBEAFE;">120.8</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DBEAFE;">125.5</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DBEAFE;">123.9</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DBEAFE; color: #2563EB; font-weight: bold;">Formula closer by 1.6kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">23</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">107.8</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">6</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">123.1</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">127.6</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">129.4</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 1.8kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">24</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">95.0</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">15</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">164.6</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">168.5</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">142.5</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 18.2kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">25</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">104.7</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">15</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">148.3</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">153.7</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">157.1</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 3.4kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">26</td>
<td headers="weight" class="gt_row gt_right">90.7</td>
<td headers="reps" class="gt_row gt_right">3</td>
<td headers="True 1RM" class="gt_row gt_right">102.3</td>
<td headers="Model prediction" class="gt_row gt_right">100.0</td>
<td headers="Formula prediction" class="gt_row gt_right">99.7</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">27</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">72.3</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">14</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">124.6</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">122.7</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">106.0</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 16.7kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">28</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">93.4</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">10</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">131.2</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">131.6</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">124.5</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 6.2kg</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right">29</td>
<td headers="weight" class="gt_row gt_right">111.5</td>
<td headers="reps" class="gt_row gt_right">6</td>
<td headers="True 1RM" class="gt_row gt_right">137.3</td>
<td headers="Model prediction" class="gt_row gt_right">140.3</td>
<td headers="Formula prediction" class="gt_row gt_right">133.7</td>
<td headers="Most accurate method" class="gt_row gt_right">Similar predictions (Â±1)</td></tr>
    <tr><td headers="athlete" class="gt_row gt_right" style="background-color: #DCFCE7;">30</td>
<td headers="weight" class="gt_row gt_right" style="background-color: #DCFCE7;">116.2</td>
<td headers="reps" class="gt_row gt_right" style="background-color: #DCFCE7;">7</td>
<td headers="True 1RM" class="gt_row gt_right" style="background-color: #DCFCE7;">147.9</td>
<td headers="Model prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">145.1</td>
<td headers="Formula prediction" class="gt_row gt_right" style="background-color: #DCFCE7;">143.3</td>
<td headers="Most accurate method" class="gt_row gt_right" style="background-color: #DCFCE7; color: #16A34A; font-weight: bold;">Model closer by 1.9kg</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" style="text-align: right;" colspan="7"><span style="font-family:&quot;Font Awesome 6 Brands&quot;;color: dodgerblue">ï‚Œ</span> <span style="font-family: &quot;Segoe UI&quot;;color: grey20">Mitch Henderson</span>
<span style="font-family:&quot;Font Awesome 6 Brands&quot;;color: dodgerblue">î™±</span> <span style="font-family: &quot;Segoe UI&quot;;color: grey20">mitchhenderson</span>
<span style="font-family:&quot;Font Awesome 6 Brands&quot;;color: dodgerblue">ï‚›</span> <span style="font-family: &quot;Segoe UI&quot;;color: grey20">mitchhenderson</span></td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
</div>
<p>Mean absolute error for the model was <strong>2.7kg</strong>.</p>
<p>Mean absolute error for the regular Epley formula was <strong>5.5kg</strong>.</p>
<p>The model was therefore <strong>2.8kg more accurate on average</strong> in this small simulated sample.<sup>4</sup></p>
</section>
<section id="what-has-the-model-learned-about-the-athletes" class="level2">
<h2 class="anchored" data-anchor-id="what-has-the-model-learned-about-the-athletes">What has the model learned about the athletes?</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" aria-controls="tabset-11-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" aria-controls="tabset-11-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-11-1" class="tab-pane active" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">athlete_endurance_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> modified_epley_model_fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spread_draws</span>(b_logk_Intercept, r_athlete__logk[athlete, ]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">endurance_parameter =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(b_logk_Intercept <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> r_athlete__logk)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(athlete) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_endurance_parameter =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(endurance_parameter)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(mean_endurance_parameter)</span>
<span id="cb21-7"></span>
<span id="cb21-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grab the athletes with the worst, median, and best strength endurance</span></span>
<span id="cb21-9">selected_athletes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> athlete_endurance_summary <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(athlete)</span>
<span id="cb21-12"></span>
<span id="cb21-13">athlete_labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> athlete_endurance_summary <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(athlete <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> selected_athletes) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb21-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb21-17">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Athlete "</span>,</span>
<span id="cb21-18">      athlete,</span>
<span id="cb21-19">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" (endurance parameter = "</span>,</span>
<span id="cb21-20">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(mean_endurance_parameter, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb21-21">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb21-22">    )</span>
<span id="cb21-23">  )</span>
<span id="cb21-24"></span>
<span id="cb21-25">endurance_profiles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> modified_epley_model_fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spread_draws</span>(</span>
<span id="cb21-27">    b_orm_Intercept,</span>
<span id="cb21-28">    b_logk_Intercept,</span>
<span id="cb21-29">    r_athlete__orm[athlete, ],</span>
<span id="cb21-30">    r_athlete__logk[athlete, ]</span>
<span id="cb21-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(athlete <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> selected_athletes) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb21-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">est_1RM =</span> b_orm_Intercept <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> r_athlete__orm,</span>
<span id="cb21-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">endurance_parameter =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(b_logk_Intercept <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> r_athlete__logk),</span>
<span id="cb21-36">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pct_est_1RM =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> endurance_parameter)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(athlete, reps) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median_qi</span>(pct_est_1RM, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(athlete_labels, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>)</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">logk_athlete <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> modified_epley_trace.posterior[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logk_athlete"</span>].values.reshape(</span>
<span id="cb22-2">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_athletes</span>
<span id="cb22-3">)</span>
<span id="cb22-4"></span>
<span id="cb22-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate mean endurance parameter for each athlete</span></span>
<span id="cb22-6">mean_endurance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.exp(logk_athlete.mean(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb22-7">athlete_endurance_summary <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pl.DataFrame(</span>
<span id="cb22-8">    {</span>
<span id="cb22-9">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>: athlete_codes,</span>
<span id="cb22-10">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean_endurance_parameter"</span>: mean_endurance,</span>
<span id="cb22-11">    }</span>
<span id="cb22-12">).sort(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean_endurance_parameter"</span>)</span>
<span id="cb22-13"></span>
<span id="cb22-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select athletes with worst, median, and best endurance</span></span>
<span id="cb22-15">selected_athletes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb22-16">    athlete_endurance_summary.row(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb22-17">    athlete_endurance_summary.row(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb22-18">    athlete_endurance_summary.row(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>),</span>
<span id="cb22-19">)</span>
<span id="cb22-20">selected_athlete_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [row[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> selected_athletes]</span>
<span id="cb22-21"></span>
<span id="cb22-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate endurance profiles across rep range</span></span>
<span id="cb22-23">reps_range <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span>
<span id="cb22-24">profiles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb22-25"></span>
<span id="cb22-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> athlete_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> selected_athlete_ids:</span>
<span id="cb22-27">    athlete_idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.where(athlete_codes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> athlete_id)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb22-28"></span>
<span id="cb22-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get posterior samples for this athlete (no need to add logk_mu)</span></span>
<span id="cb22-30">    logk_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logk_athlete[:, athlete_idx]</span>
<span id="cb22-31">    endurance_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.exp(logk_samples)</span>
<span id="cb22-32">    mean_endurance_param <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> endurance_samples.mean()</span>
<span id="cb22-33"></span>
<span id="cb22-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> reps <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> reps_range:</span>
<span id="cb22-35">        pct_1rm_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> reps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> endurance_samples)</span>
<span id="cb22-36">        profiles.append(</span>
<span id="cb22-37">            {</span>
<span id="cb22-38">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>: athlete_id,</span>
<span id="cb22-39">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>: reps,</span>
<span id="cb22-40">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_est_1RM"</span>: np.median(pct_1rm_samples),</span>
<span id="cb22-41">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lower"</span>: np.percentile(pct_1rm_samples, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb22-42">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"upper"</span>: np.percentile(pct_1rm_samples, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>),</span>
<span id="cb22-43">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"endurance_param"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(mean_endurance_param),</span>
<span id="cb22-44">            }</span>
<span id="cb22-45">        )</span>
<span id="cb22-46"></span>
<span id="cb22-47">endurance_profiles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(profiles)</span>
<span id="cb22-48">endurance_profiles[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> endurance_profiles.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">apply</span>(</span>
<span id="cb22-49">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> row: <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Athlete </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'athlete'</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (endurance = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'endurance_param'</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>,</span>
<span id="cb22-50">    axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb22-51">)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>To demonstrate this point, Iâ€™ll just show three athletes: the highest endurance (Athlete 12), the lowest endurance (Athlete 27), and one in the middle (Athlete 16).</p>
<p>See how each of their endurance parameters (that the model learned from their past training data) changes their 1RM estimate curve to be tailored to their traits.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" aria-controls="tabset-12-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" aria-controls="tabset-12-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-12-1" class="tab-pane active" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">predicted_curves_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> endurance_profiles <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb23-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb23-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> reps, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> pct_est_1RM, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> label)</span>
<span id="cb23-4">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> .lower, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> .upper), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_textline</span>(</span>
<span id="cb23-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb23-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb23-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb23-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span></span>
<span id="cb23-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb23-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Repetitions"</span>,</span>
<span id="cb23-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Athletes with lower endurance fatigue faster"</span>,</span>
<span id="cb23-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% of 1RM"</span>,</span>
<span id="cb23-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> socials,</span>
<span id="cb23-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb23-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb23-24"></span>
<span id="cb23-25">predicted_curves_plot</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">(</span>
<span id="cb24-2">    ggplot(</span>
<span id="cb24-3">        endurance_profiles, aes(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pct_est_1RM"</span>, colour<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>, fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>)</span>
<span id="cb24-4">    )</span>
<span id="cb24-5">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> geom_ribbon(aes(ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lower"</span>, ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"upper"</span>), alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>, linetype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"None"</span>)</span>
<span id="cb24-6">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> geom_line(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb24-7">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> scale_y_continuous(labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x: [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>v<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.0f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">%"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> x])</span>
<span id="cb24-8">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> scale_x_continuous(limits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), breaks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>))</span>
<span id="cb24-9">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> scale_colour_manual(values<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]])</span>
<span id="cb24-10">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> scale_fill_manual(values<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]])</span>
<span id="cb24-11">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> labs(</span>
<span id="cb24-12">        x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Repetitions"</span>,</span>
<span id="cb24-13">        y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb24-14">        title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Athletes with lower endurance fatigue faster"</span>,</span>
<span id="cb24-15">        subtitle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% o</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">f 1RM"</span>,</span>
<span id="cb24-16">    )</span>
<span id="cb24-17">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> theme_classic()</span>
<span id="cb24-18">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> theme(</span>
<span id="cb24-19">        legend_position<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb24-20">        legend_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb24-21">        plot_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb24-22">        plot_subtitle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>),</span>
<span id="cb24-23">        axis_title_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb24-24">    )</span>
<span id="cb24-25">)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2026-01-04-e1rm-modelling/index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-much-does-having-historical-training-data-help" class="level2">
<h2 class="anchored" data-anchor-id="how-much-does-having-historical-training-data-help">How much does having historical training data help?</h2>
<p>When the model has more information to estimate a 1RM, it can typically afford to give a more confident estimate.<sup>5</sup> Humans do this instinctively; weâ€™re skeptical at first but grow confident after observing things repeatedly.</p>
<p>To demonstrate, hereâ€™s four athletesâ€™ estimates after hypothetically performing a max reps set of 8 @ 100kg, each with a different amount of historical data used to train the model.</p>
<p>Notice how the shape of the 1RM estimate distribution becomes taller and thinner or wider and flatter as the amount of historical data changes. These shapes represent the level of certainty in the 1RM estimate and incorporate all sources of performance variability in the training data.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" aria-controls="tabset-13-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" aria-controls="tabset-13-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-13-1" class="tab-pane active" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">athletes_varying_obs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> train <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(athlete, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_obs"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(n_obs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>))</span>
<span id="cb25-5"></span>
<span id="cb25-6">data_varying_obs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> athletes_varying_obs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb25-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(</span>
<span id="cb25-9">      athlete,</span>
<span id="cb25-10">      \(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">estimate_1rm</span>(modified_epley_model_fit, x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb25-11">    ),</span>
<span id="cb25-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">athlete =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(</span>
<span id="cb25-13">      athlete,</span>
<span id="cb25-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(athletes_varying_obs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>athlete),</span>
<span id="cb25-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb25-16">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Athlete "</span>,</span>
<span id="cb25-17">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(athletes_varying_obs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>athlete),</span>
<span id="cb25-18">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;&lt;span style='color:grey50; font-size:11pt;'&gt;("</span>,</span>
<span id="cb25-19">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(n_obs),</span>
<span id="cb25-20">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" sets of historical data)&lt;/span&gt;"</span></span>
<span id="cb25-21">      )</span>
<span id="cb25-22">    )</span>
<span id="cb25-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">athlete_id =</span> athlete) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unnest</span>(estimate)</span>
<span id="cb25-26"></span>
<span id="cb25-27">annotations <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb25-28">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">athlete_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb25-29">    data_varying_obs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-30">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(n_obs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(n_obs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-31">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(athlete_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-32">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(),</span>
<span id="cb25-33">    data_varying_obs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-34">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(n_obs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(n_obs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-35">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(athlete_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-36">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb25-37">  ),</span>
<span id="cb25-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">130.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">130.5</span>),</span>
<span id="cb25-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>),</span>
<span id="cb25-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb25-41">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb25-42">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"More data â†’ narrower distribution&lt;br&gt;"</span>,</span>
<span id="cb25-43">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(data_varying_obs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>n_obs),</span>
<span id="cb25-44">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" sets gives high confidence"</span></span>
<span id="cb25-45">    ),</span>
<span id="cb25-46">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb25-47">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Less data â†’ wider distribution&lt;br&gt;Only "</span>,</span>
<span id="cb25-48">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(data_varying_obs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>n_obs),</span>
<span id="cb25-49">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" sets means more uncertainty"</span></span>
<span id="cb25-50">    )</span>
<span id="cb25-51">  )</span>
<span id="cb25-52">)</span>
<span id="cb25-53"></span>
<span id="cb25-54">historical_data_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data_varying_obs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb25-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> est_1RM)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>athlete_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_slab</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lighten</span>(colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_spike</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">at =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"median"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_thickness_shared</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey50"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(</span>
<span id="cb25-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> annotations,</span>
<span id="cb25-63">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb25-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb25-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey35"</span>,</span>
<span id="cb25-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb25-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb25-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb25-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span></span>
<span id="cb25-70">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb25-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> units),</span>
<span id="cb25-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">117</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">133</span>)</span>
<span id="cb25-74">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb25-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb25-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated 1RM"</span>,</span>
<span id="cb25-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1RM estimates with more data are usually more confident"</span>,</span>
<span id="cb25-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> socials</span>
<span id="cb25-80">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-81">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-82">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb25-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb25-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb25-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb25-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb25-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb25-88">  )</span>
<span id="cb25-89"></span>
<span id="cb25-90">historical_data_plot</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">athletes_varying_obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb26-2">    train.group_by(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>)</span>
<span id="cb26-3">    .<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>()</span>
<span id="cb26-4">    .rename({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"len"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_obs"</span>})</span>
<span id="cb26-5">    .sort(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_obs"</span>)</span>
<span id="cb26-6">    .gather_every(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, offset<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb26-7">)</span>
<span id="cb26-8"></span>
<span id="cb26-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate 1RM estimates for each athlete (hypothetical 8 reps @ 100kg)</span></span>
<span id="cb26-10">varying_obs_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb26-11"></span>
<span id="cb26-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> athletes_varying_obs.iter_rows(named<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>):</span>
<span id="cb26-13">    athlete_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>]</span>
<span id="cb26-14">    n_obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_obs"</span>]</span>
<span id="cb26-15"></span>
<span id="cb26-16">    pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> estimate_1rm(modified_epley_trace, athlete_id, weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, reps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb26-17"></span>
<span id="cb26-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> est <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pred[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1rm"</span>]:</span>
<span id="cb26-19">        varying_obs_data.append(</span>
<span id="cb26-20">            {</span>
<span id="cb26-21">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>: athlete_id,</span>
<span id="cb26-22">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_obs"</span>: n_obs,</span>
<span id="cb26-23">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>: est,</span>
<span id="cb26-24">            }</span>
<span id="cb26-25">        )</span>
<span id="cb26-26"></span>
<span id="cb26-27">varying_obs_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(varying_obs_data)</span>
<span id="cb26-28">varying_obs_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> varying_obs_df.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">apply</span>(</span>
<span id="cb26-29">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> row: <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Athlete </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'athlete'</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'n_obs'</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> sets of historical data)"</span>,</span>
<span id="cb26-30">    axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb26-31">)</span>
<span id="cb26-32"></span>
<span id="cb26-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Order by n_obs descending for facets</span></span>
<span id="cb26-34">label_order <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb26-35">    varying_obs_df.groupby(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>, observed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_obs"</span>]</span>
<span id="cb26-36">    .first()</span>
<span id="cb26-37">    .sort_values(ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb26-38">    .index.tolist()</span>
<span id="cb26-39">)</span>
<span id="cb26-40">varying_obs_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.Categorical(</span>
<span id="cb26-41">    varying_obs_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>], categories<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>label_order, ordered<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb26-42">)</span>
<span id="cb26-43"></span>
<span id="cb26-44">(</span>
<span id="cb26-45">    ggplot(varying_obs_df, aes(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>))</span>
<span id="cb26-46">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> geom_density(fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#a8c7e6"</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb26-47">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> geom_vline(</span>
<span id="cb26-48">        varying_obs_df.groupby(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>, observed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>]</span>
<span id="cb26-49">        .median()</span>
<span id="cb26-50">        .reset_index(),</span>
<span id="cb26-51">        aes(xintercept<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>),</span>
<span id="cb26-52">        colour<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#134A8E"</span>,</span>
<span id="cb26-53">        size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb26-54">    )</span>
<span id="cb26-55">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> facet_wrap(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~label"</span>, ncol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb26-56">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> scale_x_continuous(labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x: [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>v<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.0f}{</span>units<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> x])</span>
<span id="cb26-57">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> labs(</span>
<span id="cb26-58">        x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated 1RM"</span>,</span>
<span id="cb26-59">        y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb26-60">        title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1RM estimates with more data are usually more confident"</span>,</span>
<span id="cb26-61">    )</span>
<span id="cb26-62">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> theme_classic()</span>
<span id="cb26-63">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> theme(</span>
<span id="cb26-64">        axis_text_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb26-65">        axis_ticks_major_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb26-66">        axis_title_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb26-67">        axis_line_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb26-68">        strip_text<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>),</span>
<span id="cb26-69">        strip_background<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb26-70">        plot_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb26-71">    )</span>
<span id="cb26-72">)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2026-01-04-e1rm-modelling/index_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-much-accuracy-do-you-lose-with-higher-rep-sets" class="level2">
<h2 class="anchored" data-anchor-id="how-much-accuracy-do-you-lose-with-higher-rep-sets">How much accuracy do you lose with higher rep sets?</h2>
<p>The further a max reps set is from a true 1RM, the more the model has to extrapolate to provide an estimate. This extrapolation causes uncertainty in the 1RM estimates to compound. This is intuitive; predicting the weather a few hours from now isnâ€™t impressive, but forecasting days or weeks in advance is much harder and carries a lot more uncertainty because of the added time for conditions to stray from your expectations.</p>
<p>Same idea here. Heavy sets where only 2â€“5 reps are completed are more representative of what your 1RM actually is.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" aria-controls="tabset-14-1" aria-selected="true"><img src="https://www.mitchhenderson.dev/img/Rlogo.svg" height="25"></a></li><li class="nav-item"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" aria-controls="tabset-14-2" aria-selected="false"><img src="https://www.mitchhenderson.dev/img/python-logo-only.svg" height="30"></a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-14-1" class="tab-pane active" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2534</span>)</span>
<span id="cb27-2"></span>
<span id="cb27-3">rep_count_plot_athlete <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb27-4"></span>
<span id="cb27-5">rep_count_plot_athlete_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> train <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb27-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(athlete <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> rep_count_plot_athlete) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb27-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb27-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rep_bin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb27-9">      reps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"low"</span>,</span>
<span id="cb27-10">      reps <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mid"</span>,</span>
<span id="cb27-11">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"high"</span></span>
<span id="cb27-12">    )</span>
<span id="cb27-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb27-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(rep_bin) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb27-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_sample</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb27-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb27-17"></span>
<span id="cb27-18">rep_count_plot_athlete_1RM <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rep_count_plot_athlete_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>orm[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb27-19"></span>
<span id="cb27-20">rep_count_plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rep_count_plot_athlete_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb27-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmap_dfr</span>(\(reps, weight, ...) {</span>
<span id="cb27-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">estimate_1rm</span>(</span>
<span id="cb27-23">      modified_epley_model_fit,</span>
<span id="cb27-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">athlete_id =</span> rep_count_plot_athlete,</span>
<span id="cb27-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> weight,</span>
<span id="cb27-26">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reps =</span> reps</span>
<span id="cb27-27">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb27-28">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scenario =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(reps, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" reps @ "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weight, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), units))</span>
<span id="cb27-29">  }) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb27-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scenario =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(scenario, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse_number</span>(scenario)))</span>
<span id="cb27-31"></span>
<span id="cb27-32">scenario_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(rep_count_plot_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>scenario))</span>
<span id="cb27-33"></span>
<span id="cb27-34">rep_count_plot_annotations <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb27-35">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scenario =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(scenario_levels, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> scenario_levels),</span>
<span id="cb27-36">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> rep_count_plot_athlete_1RM <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb27-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb27-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true_1RM_label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"True 1RM"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb27-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">annotation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb27-40">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3 rep set â†’ more confident"</span>,</span>
<span id="cb27-41">    <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb27-42">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"13 rep set â†’ less confident"</span></span>
<span id="cb27-43">  )</span>
<span id="cb27-44">)</span>
<span id="cb27-45"></span>
<span id="cb27-46">rep_count_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rep_count_plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb27-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> est_1RM)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>scenario, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_slab</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lighten</span>(colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_spike</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">at =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"median"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_thickness_shared</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey50"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(</span>
<span id="cb27-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> rep_count_plot_athlete_1RM,</span>
<span id="cb27-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb27-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>,</span>
<span id="cb27-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb27-58">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(</span>
<span id="cb27-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> rep_count_plot_annotations,</span>
<span id="cb27-61">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> true_1RM_label),</span>
<span id="cb27-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb27-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb27-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb27-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb27-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span></span>
<span id="cb27-67">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(</span>
<span id="cb27-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> rep_count_plot_annotations,</span>
<span id="cb27-70">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> annotation),</span>
<span id="cb27-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb27-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>,</span>
<span id="cb27-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey35"</span>,</span>
<span id="cb27-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb27-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span></span>
<span id="cb27-76">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-77">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb27-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated 1RM (kg)"</span>,</span>
<span id="cb27-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb27-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1RM estimates are more confident with lower rep sets"</span>,</span>
<span id="cb27-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb27-82">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Athlete "</span>,</span>
<span id="cb27-83">      rep_count_plot_athlete,</span>
<span id="cb27-84">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Max rep sets from simulated training data"</span></span>
<span id="cb27-85">    ),</span>
<span id="cb27-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> socials</span>
<span id="cb27-87">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb27-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> units),</span>
<span id="cb27-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">122</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">137</span>)</span>
<span id="cb27-91">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb27-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb27-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb27-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb27-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb27-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb27-98">  )</span>
<span id="cb27-99"></span>
<span id="cb27-100">rep_count_plot</span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2534</span>)</span>
<span id="cb28-2"></span>
<span id="cb28-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pick an athlete</span></span>
<span id="cb28-4">rep_count_plot_athlete <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb28-5"></span>
<span id="cb28-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get their data and sample one set from each rep bin</span></span>
<span id="cb28-7">rep_count_athlete_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb28-8">    train.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">filter</span>(pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"athlete"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> rep_count_plot_athlete)</span>
<span id="cb28-9">    .with_columns(</span>
<span id="cb28-10">        pl.when(pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb28-11">        .then(pl.lit(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"low"</span>))</span>
<span id="cb28-12">        .when(pl.col(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb28-13">        .then(pl.lit(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mid"</span>))</span>
<span id="cb28-14">        .otherwise(pl.lit(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"high"</span>))</span>
<span id="cb28-15">        .alias(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rep_bin"</span>)</span>
<span id="cb28-16">    )</span>
<span id="cb28-17">    .group_by(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rep_bin"</span>)</span>
<span id="cb28-18">    .agg(pl.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span>().sample(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2534</span>))</span>
<span id="cb28-19">    .explode(pl.exclude(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rep_bin"</span>))</span>
<span id="cb28-20">)</span>
<span id="cb28-21"></span>
<span id="cb28-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate predictions for each set</span></span>
<span id="cb28-23">rep_count_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb28-24"></span>
<span id="cb28-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rep_count_athlete_data.iter_rows(named<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>):</span>
<span id="cb28-26">    pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> estimate_1rm(</span>
<span id="cb28-27">        modified_epley_trace,</span>
<span id="cb28-28">        athlete_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rep_count_plot_athlete,</span>
<span id="cb28-29">        weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight"</span>],</span>
<span id="cb28-30">        reps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>],</span>
<span id="cb28-31">    )</span>
<span id="cb28-32">    scenario <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reps'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> reps @ </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'weight'</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}{</span>units<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb28-33"></span>
<span id="cb28-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> est <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pred[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1rm"</span>]:</span>
<span id="cb28-35">        rep_count_data.append(</span>
<span id="cb28-36">            {</span>
<span id="cb28-37">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>: row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>],</span>
<span id="cb28-38">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scenario"</span>: scenario,</span>
<span id="cb28-39">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>: est,</span>
<span id="cb28-40">            }</span>
<span id="cb28-41">        )</span>
<span id="cb28-42"></span>
<span id="cb28-43">rep_count_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(rep_count_data)</span>
<span id="cb28-44"></span>
<span id="cb28-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Order scenarios by rep count</span></span>
<span id="cb28-46">scenario_order <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb28-47">    rep_count_df.groupby(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scenario"</span>, observed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reps"</span>]</span>
<span id="cb28-48">    .first()</span>
<span id="cb28-49">    .sort_values()</span>
<span id="cb28-50">    .index.tolist()</span>
<span id="cb28-51">)</span>
<span id="cb28-52">rep_count_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scenario"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.Categorical(</span>
<span id="cb28-53">    rep_count_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scenario"</span>], categories<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>scenario_order, ordered<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb28-54">)</span>
<span id="cb28-55"></span>
<span id="cb28-56">(</span>
<span id="cb28-57">    ggplot(rep_count_df, aes(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>))</span>
<span id="cb28-58">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> geom_density(fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#a8c7e6"</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb28-59">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> geom_vline(</span>
<span id="cb28-60">        rep_count_df.groupby(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scenario"</span>, observed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>]</span>
<span id="cb28-61">        .median()</span>
<span id="cb28-62">        .reset_index(),</span>
<span id="cb28-63">        aes(xintercept<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est_1RM"</span>),</span>
<span id="cb28-64">        colour<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#134A8E"</span>,</span>
<span id="cb28-65">        size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb28-66">    )</span>
<span id="cb28-67">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> facet_wrap(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~scenario"</span>, ncol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb28-68">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> scale_x_continuous(labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x: [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>v<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.0f}{</span>units<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> x])</span>
<span id="cb28-69">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> labs(</span>
<span id="cb28-70">        x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated 1RM"</span>,</span>
<span id="cb28-71">        y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb28-72">        title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1RM estimates are more confident with lower rep sets"</span>,</span>
<span id="cb28-73">        subtitle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Athlete </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rep_count_plot_athlete<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> | Max rep sets from simulated training data"</span>,</span>
<span id="cb28-74">    )</span>
<span id="cb28-75">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> theme_classic()</span>
<span id="cb28-76">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> theme(</span>
<span id="cb28-77">        axis_text_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb28-78">        axis_ticks_major_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb28-79">        axis_title_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb28-80">        axis_line_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb28-81">        strip_text<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>),</span>
<span id="cb28-82">        strip_background<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_blank(),</span>
<span id="cb28-83">        plot_title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb28-84">        plot_subtitle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>element_text(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>),</span>
<span id="cb28-85">    )</span>
<span id="cb28-86">)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2026-01-04-e1rm-modelling/index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="integrating-this" class="level2">
<h2 class="anchored" data-anchor-id="integrating-this">Integrating this</h2>
<p>Integrating this into a larger system would involve deploying the model to a server so that estimates can be requested on demand. Analysis tools (R, Python, Excel via Power Query, etc) would send athlete data to the model and receive 1RM estimates in return. From there, youâ€™d set up the model to refit on a schedule so that estimates stay current and are available whenever youâ€™re programming or reviewing training.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>My simulated data might not align with the patterns in real training data, but I think the idea that some athletes can do heavy weight well while others do higher reps well is valid and should/can be captured when youâ€™re estimating 1RM from a submaximal set for max reps.</p>
<p>Takeaways:</p>
<ul>
<li><p>Athletes have different characteristics that statistical models can learn and account for when making inferences or predictions.</p></li>
<li><p>Quantifying uncertainty helps us make better decisions. Especially knowing when we donâ€™t have enough information to act confidently.</p></li>
<li><p>Models like this can be fit to your athletesâ€™ data, updated automatically as new training results come in, and integrated into your programming or monitoring workflows.</p></li>
</ul>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Note that this is different, and IMO much more intuitive, to what a confidence interval tells you. Confidence intervals are confusing <a href="https://pubmed.ncbi.nlm.nih.gov/24420726/">and even trained scientists often misinterpret them</a>.â†©ï¸Ž</p></li>
<li id="fn2"><p>These intervals are what you get with Bayesian model estimates and they are what I think most people want confidence intervals to be. There is x% probability that the interval contains the true value.â†©ï¸Ž</p></li>
<li id="fn3"><p>This evaluation is pretty crude (holding out each athletes most recent set for testing; only 30 sets total). Itâ€™s kind of how it would work in real life though; predictions after each new session are like their own test set (assuming model is updated before each session). A stronger approach to evaluation during the research phase of something like (as opposed to ongoing use) would be to use something like <a href="https://www.youtube.com/watch?v=fSytzGwwBVw">cross validation</a>.â†©ï¸Ž</p></li>
<li id="fn4"><p>Take with a big grain of salt as itâ€™s only an average over 30 estimates.â†©ï¸Ž</p></li>
<li id="fn5"><p>Although more data doesnâ€™t always mean a more certain estimate, sometimes itâ€™s just more certain that the athlete is inherently variable.â†©ï¸Ž</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://www.mitchhenderson.dev/posts/2026-01-04-e1rm-modelling/</guid>
  <pubDate>Sat, 03 Jan 2026 13:00:00 GMT</pubDate>
</item>
<item>
  <title>How many wins do NRL teams need to make the finals?</title>
  <dc:creator>Mitch Henderson</dc:creator>
  <link>https://www.mitchhenderson.dev/posts/2025-01-18-how-many-wins-do-nrl-teams-need-to-make-the-finals/</link>
  <description><![CDATA[ 





<section id="tldr-probably-13." class="level3">
<h3 class="anchored" data-anchor-id="tldr-probably-13."><em>tl;dr:</em> Probably 13.</h3>
<p><br></p>
<p>Sounds like a simple problem, but it isnâ€™t.</p>
<p>Itâ€™s pretty common for sports teams to set a goal at the start of a season to make the finals/playoffs . Teams in the NRL<sup>1</sup> are no different. The flaw in this goal is that the number of wins needed to qualify for the finals varies from season-to-season depending on the results of other teams. A 12-win season (from 24 games) is enough to qualify some years, but not enough in others.</p>
<p>So how many wins do teams need to be confident theyâ€™ll qualify?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Setup</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(furrr)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(parallel)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(igraph)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdist)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(data.table)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggtext)</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gganimate)</span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gtExtras)</span>
<span id="cb1-12"></span>
<span id="cb1-13">colours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E31937"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#134A8E"</span>)</span>
<span id="cb1-14">socials <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mitchhenderson<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">social_caption</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">icon_colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>)</span>
<span id="cb1-15">mitchhenderson<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_hoist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro"</span>)</span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-18">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span>),</span>
<span id="cb1-19">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(),</span>
<span id="cb1-20">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Bold Condensed"</span>, </span>
<span id="cb1-21">                                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>),</span>
<span id="cb1-22">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span>),</span>
<span id="cb1-23">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb1-24">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()))</span></code></pre></div>
</details>
</div>
<p>To work it out, I scraped 10 seasons of match result data from Wikipedia (2014-2024 excluding the shortened 2020 season) and saved the results in a file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import match results for 10 seasons (up to 2024)</span></span>
<span id="cb2-2">import <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/mitchhenderson/mitchhenderson.dev/refs/heads/main/posts/2025-01-18-how-many-wins-do-nrl-teams-need-to-make-the-finals/2014-2024_nrl_match_results.csv"</span>)</span></code></pre></div>
</div>
<p>The first 10 rows look like this:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">import <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_head</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="msiykvjejp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#msiykvjejp table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#msiykvjejp thead, #msiykvjejp tbody, #msiykvjejp tfoot, #msiykvjejp tr, #msiykvjejp td, #msiykvjejp th {
  border-style: none;
}

#msiykvjejp p {
  margin: 0;
  padding: 0;
}

#msiykvjejp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#msiykvjejp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#msiykvjejp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#msiykvjejp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#msiykvjejp .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#msiykvjejp .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#msiykvjejp .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#msiykvjejp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#msiykvjejp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#msiykvjejp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#msiykvjejp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#msiykvjejp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#msiykvjejp .gt_spanner_row {
  border-bottom-style: hidden;
}

#msiykvjejp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#msiykvjejp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#msiykvjejp .gt_from_md > :first-child {
  margin-top: 0;
}

#msiykvjejp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#msiykvjejp .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#msiykvjejp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#msiykvjejp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#msiykvjejp .gt_row_group_first td {
  border-top-width: 2px;
}

#msiykvjejp .gt_row_group_first th {
  border-top-width: 2px;
}

#msiykvjejp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#msiykvjejp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#msiykvjejp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#msiykvjejp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#msiykvjejp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#msiykvjejp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#msiykvjejp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#msiykvjejp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#msiykvjejp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#msiykvjejp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#msiykvjejp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#msiykvjejp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#msiykvjejp .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#msiykvjejp .gt_left {
  text-align: left;
}

#msiykvjejp .gt_center {
  text-align: center;
}

#msiykvjejp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#msiykvjejp .gt_font_normal {
  font-weight: normal;
}

#msiykvjejp .gt_font_bold {
  font-weight: bold;
}

#msiykvjejp .gt_font_italic {
  font-style: italic;
}

#msiykvjejp .gt_super {
  font-size: 65%;
}

#msiykvjejp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#msiykvjejp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#msiykvjejp .gt_indent_1 {
  text-indent: 5px;
}

#msiykvjejp .gt_indent_2 {
  text-indent: 10px;
}

#msiykvjejp .gt_indent_3 {
  text-indent: 15px;
}

#msiykvjejp .gt_indent_4 {
  text-indent: 20px;
}

#msiykvjejp .gt_indent_5 {
  text-indent: 25px;
}

#msiykvjejp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#msiykvjejp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

#msiykvjejp tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="home">home</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="home_score">home_score</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="away_score">away_score</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="away">away</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="day_and_time">day_and_time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="venue">venue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="season">season</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="home" class="gt_row gt_left">South Sydney Rabbitohs</td>
<td headers="home_score" class="gt_row gt_right">28</td>
<td headers="away_score" class="gt_row gt_right">8</td>
<td headers="away" class="gt_row gt_left">Sydney Roosters</td>
<td headers="day_and_time" class="gt_row gt_left">6 March 2014, 8:05 pm</td>
<td headers="venue" class="gt_row gt_left">ANZ Stadium, Sydney</td>
<td headers="season" class="gt_row gt_right">2014</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Canterbury Bankstown Bulldogs</td>
<td headers="home_score" class="gt_row gt_right">12</td>
<td headers="away_score" class="gt_row gt_right">18</td>
<td headers="away" class="gt_row gt_left">Brisbane Broncos</td>
<td headers="day_and_time" class="gt_row gt_left">7 March 2014, 8:05 pm</td>
<td headers="venue" class="gt_row gt_left">ANZ Stadium, Sydney</td>
<td headers="season" class="gt_row gt_right">2014</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Penrith Panthers</td>
<td headers="home_score" class="gt_row gt_right">30</td>
<td headers="away_score" class="gt_row gt_right">8</td>
<td headers="away" class="gt_row gt_left">Newcastle Knights</td>
<td headers="day_and_time" class="gt_row gt_left">8 March 2014, 4:30 pm</td>
<td headers="venue" class="gt_row gt_left">Sportingbet Stadium</td>
<td headers="season" class="gt_row gt_right">2014</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Manly Warringah Sea Eagles</td>
<td headers="home_score" class="gt_row gt_right">22</td>
<td headers="away_score" class="gt_row gt_right">23</td>
<td headers="away" class="gt_row gt_left">Melbourne Storm</td>
<td headers="day_and_time" class="gt_row gt_left">8 March 2014, 7:00 pm</td>
<td headers="venue" class="gt_row gt_left">Brookvale Oval</td>
<td headers="season" class="gt_row gt_right">2014</td></tr>
    <tr><td headers="home" class="gt_row gt_left">North Queensland Cowboys</td>
<td headers="home_score" class="gt_row gt_right">28</td>
<td headers="away_score" class="gt_row gt_right">22</td>
<td headers="away" class="gt_row gt_left">Canberra Raiders</td>
<td headers="day_and_time" class="gt_row gt_left">8 March 2014, 8:00 pm</td>
<td headers="venue" class="gt_row gt_left">1300SMILES Stadium</td>
<td headers="season" class="gt_row gt_right">2014</td></tr>
    <tr><td headers="home" class="gt_row gt_left">St George Illawarra Dragons</td>
<td headers="home_score" class="gt_row gt_right">44</td>
<td headers="away_score" class="gt_row gt_right">24</td>
<td headers="away" class="gt_row gt_left">Wests Tigers</td>
<td headers="day_and_time" class="gt_row gt_left">9 March 2014, 3:00 pm</td>
<td headers="venue" class="gt_row gt_left">ANZ Stadium, Sydney</td>
<td headers="season" class="gt_row gt_right">2014</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Parramatta Eels</td>
<td headers="home_score" class="gt_row gt_right">36</td>
<td headers="away_score" class="gt_row gt_right">16</td>
<td headers="away" class="gt_row gt_left">New Zealand Warriors</td>
<td headers="day_and_time" class="gt_row gt_left">9 March 2014, 3:00 pm</td>
<td headers="venue" class="gt_row gt_left">Pirtek Stadium</td>
<td headers="season" class="gt_row gt_right">2014</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Cronulla Sutherland Sharks</td>
<td headers="home_score" class="gt_row gt_right">12</td>
<td headers="away_score" class="gt_row gt_right">18</td>
<td headers="away" class="gt_row gt_left">Gold Coast Titans</td>
<td headers="day_and_time" class="gt_row gt_left">10 March 2014, 7:00 pm</td>
<td headers="venue" class="gt_row gt_left">Remondis Stadium</td>
<td headers="season" class="gt_row gt_right">2014</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Manly Warringah Sea Eagles</td>
<td headers="home_score" class="gt_row gt_right">14</td>
<td headers="away_score" class="gt_row gt_right">12</td>
<td headers="away" class="gt_row gt_left">South Sydney Rabbitohs</td>
<td headers="day_and_time" class="gt_row gt_left">14 March 2014, 7:40 pm</td>
<td headers="venue" class="gt_row gt_left">Bluetongue Stadium</td>
<td headers="season" class="gt_row gt_right">2014</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Brisbane Broncos</td>
<td headers="home_score" class="gt_row gt_right">16</td>
<td headers="away_score" class="gt_row gt_right">12</td>
<td headers="away" class="gt_row gt_left">North Queensland Cowboys</td>
<td headers="day_and_time" class="gt_row gt_left">14 March 2014, 7:40 pm</td>
<td headers="venue" class="gt_row gt_left">Suncorp Stadium</td>
<td headers="season" class="gt_row gt_right">2014</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="historical-distribution-of-wins" class="level3">
<h3 class="anchored" data-anchor-id="historical-distribution-of-wins">Historical distribution of wins</h3>
<p>I calculated the points differential for each game and created binary (0 or 1) indicator columns for the winning/losing team and draws. I could then use this match level data to calculate the competition ladder at the end of the season for each year in the data set. The table below shows only 2014, but the final table has been calculated for all available seasons.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> import <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">points_differential =</span> home_score <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> away_score,</span>
<span id="cb4-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">home_win =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(points_differential <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">away_win =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(points_differential <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-5">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">draw =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(points_differential <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate final competition ladder for each season -------------------</span></span>
<span id="cb4-8"></span>
<span id="cb4-9">competition_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(df){</span>
<span id="cb4-10">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">home_wins =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(home_win),</span>
<span id="cb4-12">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">home_for_and_against =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(points_differential),</span>
<span id="cb4-13">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(season, home)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-15">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">away_wins =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(away_win),</span>
<span id="cb4-16">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">away_for_and_against =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(points_differential) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-17">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(season, away)),</span>
<span id="cb4-18">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(season, home <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> away)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-20">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">draw =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(draw), </span>
<span id="cb4-21">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(season, home)),</span>
<span id="cb4-22">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(season, home)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_wins =</span> home_wins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> away_wins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> draw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-24">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">for_and_against =</span> home_for_and_against <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> away_for_and_against) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(season, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">team =</span> home, total_wins, for_and_against) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(season, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>total_wins, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>for_and_against) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular_season_position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>(),</span>
<span id="cb4-28">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">made_finals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(regular_season_position <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-29">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> season)</span>
<span id="cb4-30">}</span>
<span id="cb4-31"></span>
<span id="cb4-32">observed_summary_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">competition_table</span>(data)</span>
<span id="cb4-33"></span>
<span id="cb4-34">observed_summary_results <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_head</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="bslsitehyt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#bslsitehyt table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bslsitehyt thead, #bslsitehyt tbody, #bslsitehyt tfoot, #bslsitehyt tr, #bslsitehyt td, #bslsitehyt th {
  border-style: none;
}

#bslsitehyt p {
  margin: 0;
  padding: 0;
}

#bslsitehyt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bslsitehyt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bslsitehyt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bslsitehyt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bslsitehyt .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bslsitehyt .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bslsitehyt .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bslsitehyt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bslsitehyt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bslsitehyt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bslsitehyt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bslsitehyt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bslsitehyt .gt_spanner_row {
  border-bottom-style: hidden;
}

#bslsitehyt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bslsitehyt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#bslsitehyt .gt_from_md > :first-child {
  margin-top: 0;
}

#bslsitehyt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bslsitehyt .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bslsitehyt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#bslsitehyt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bslsitehyt .gt_row_group_first td {
  border-top-width: 2px;
}

#bslsitehyt .gt_row_group_first th {
  border-top-width: 2px;
}

#bslsitehyt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bslsitehyt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bslsitehyt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bslsitehyt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bslsitehyt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bslsitehyt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bslsitehyt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bslsitehyt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bslsitehyt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bslsitehyt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bslsitehyt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bslsitehyt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bslsitehyt .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bslsitehyt .gt_left {
  text-align: left;
}

#bslsitehyt .gt_center {
  text-align: center;
}

#bslsitehyt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bslsitehyt .gt_font_normal {
  font-weight: normal;
}

#bslsitehyt .gt_font_bold {
  font-weight: bold;
}

#bslsitehyt .gt_font_italic {
  font-style: italic;
}

#bslsitehyt .gt_super {
  font-size: 65%;
}

#bslsitehyt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bslsitehyt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bslsitehyt .gt_indent_1 {
  text-indent: 5px;
}

#bslsitehyt .gt_indent_2 {
  text-indent: 10px;
}

#bslsitehyt .gt_indent_3 {
  text-indent: 15px;
}

#bslsitehyt .gt_indent_4 {
  text-indent: 20px;
}

#bslsitehyt .gt_indent_5 {
  text-indent: 25px;
}

#bslsitehyt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bslsitehyt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

#bslsitehyt tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="season">season</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="team">team</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="total_wins">total_wins</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="for_and_against">for_and_against</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="regular_season_position">regular_season_position</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="made_finals">made_finals</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Sydney Roosters</td>
<td headers="total_wins" class="gt_row gt_right">16</td>
<td headers="for_and_against" class="gt_row gt_right">230</td>
<td headers="regular_season_position" class="gt_row gt_right">1</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Manly Warringah Sea Eagles</td>
<td headers="total_wins" class="gt_row gt_right">16</td>
<td headers="for_and_against" class="gt_row gt_right">103</td>
<td headers="regular_season_position" class="gt_row gt_right">2</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">South Sydney Rabbitohs</td>
<td headers="total_wins" class="gt_row gt_right">15</td>
<td headers="for_and_against" class="gt_row gt_right">224</td>
<td headers="regular_season_position" class="gt_row gt_right">3</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Penrith Panthers</td>
<td headers="total_wins" class="gt_row gt_right">15</td>
<td headers="for_and_against" class="gt_row gt_right">80</td>
<td headers="regular_season_position" class="gt_row gt_right">4</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">North Queensland Cowboys</td>
<td headers="total_wins" class="gt_row gt_right">14</td>
<td headers="for_and_against" class="gt_row gt_right">190</td>
<td headers="regular_season_position" class="gt_row gt_right">5</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Melbourne Storm</td>
<td headers="total_wins" class="gt_row gt_right">14</td>
<td headers="for_and_against" class="gt_row gt_right">76</td>
<td headers="regular_season_position" class="gt_row gt_right">6</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Canterbury Bankstown Bulldogs</td>
<td headers="total_wins" class="gt_row gt_right">13</td>
<td headers="for_and_against" class="gt_row gt_right">7</td>
<td headers="regular_season_position" class="gt_row gt_right">7</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Brisbane Broncos</td>
<td headers="total_wins" class="gt_row gt_right">12</td>
<td headers="for_and_against" class="gt_row gt_right">93</td>
<td headers="regular_season_position" class="gt_row gt_right">8</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">New Zealand Warriors</td>
<td headers="total_wins" class="gt_row gt_right">12</td>
<td headers="for_and_against" class="gt_row gt_right">80</td>
<td headers="regular_season_position" class="gt_row gt_right">9</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Parramatta Eels</td>
<td headers="total_wins" class="gt_row gt_right">12</td>
<td headers="for_and_against" class="gt_row gt_right">-103</td>
<td headers="regular_season_position" class="gt_row gt_right">10</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">St George Illawarra Dragons</td>
<td headers="total_wins" class="gt_row gt_right">11</td>
<td headers="for_and_against" class="gt_row gt_right">-59</td>
<td headers="regular_season_position" class="gt_row gt_right">11</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Newcastle Knights</td>
<td headers="total_wins" class="gt_row gt_right">10</td>
<td headers="for_and_against" class="gt_row gt_right">-108</td>
<td headers="regular_season_position" class="gt_row gt_right">12</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Wests Tigers</td>
<td headers="total_wins" class="gt_row gt_right">10</td>
<td headers="for_and_against" class="gt_row gt_right">-211</td>
<td headers="regular_season_position" class="gt_row gt_right">13</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Gold Coast Titans</td>
<td headers="total_wins" class="gt_row gt_right">9</td>
<td headers="for_and_against" class="gt_row gt_right">-166</td>
<td headers="regular_season_position" class="gt_row gt_right">14</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Canberra Raiders</td>
<td headers="total_wins" class="gt_row gt_right">8</td>
<td headers="for_and_against" class="gt_row gt_right">-157</td>
<td headers="regular_season_position" class="gt_row gt_right">15</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2014</td>
<td headers="team" class="gt_row gt_left">Cronulla Sutherland Sharks</td>
<td headers="total_wins" class="gt_row gt_right">5</td>
<td headers="for_and_against" class="gt_row gt_right">-279</td>
<td headers="regular_season_position" class="gt_row gt_right">16</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
<p>All 10 seasons can then be visualised together as a dot plot. Notice how one team won 10 games one season and made the finals (blue circle at the top of the 10 wins column) and another team won 13 games in a different season but didnâ€™t qualify (red circle at the bottom of the 13 wins column).</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">observed_summary_results <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">made_finals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(made_finals)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(made_finals) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> total_wins, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> made_finals, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> made_finals)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dotsinterval</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb5-6">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-7">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">overflow =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"compress"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>, </span>
<span id="cb5-9">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, </span>
<span id="cb5-10">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, </span>
<span id="cb5-11">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.075</span>, </span>
<span id="cb5-12">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-13">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb5-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb5-16">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb5-17">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">font-family:'Myriad Pro Bold'; </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&gt;2016 Newcastle Knights&lt;/span&gt;&lt;br&gt;1 win, 1 draw"</span>)),</span>
<span id="cb5-18">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb5-19">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span>,</span>
<span id="cb5-20">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb5-21">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb5-22">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb5-23">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb5-24">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, </span>
<span id="cb5-25">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>, </span>
<span id="cb5-27">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, </span>
<span id="cb5-28">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, </span>
<span id="cb5-29">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.135</span>, </span>
<span id="cb5-30">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-31">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb5-32">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb5-34">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb5-35">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">font-family:'Myriad Pro Bold'; </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&gt;2021 Melbourne&lt;br&gt;Storm &amp; Penrith&lt;br&gt;Panthers&lt;/span&gt;&lt;br&gt;Both with 21 wins"</span>)),</span>
<span id="cb5-36">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb5-37">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span>,</span>
<span id="cb5-38">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb5-39">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb5-40">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb5-41">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb5-42">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, </span>
<span id="cb5-43">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Matches won"</span>,</span>
<span id="cb5-45">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**NRL teams have needed as low as 10 and as high as 14 wins to make&lt;br&gt;the finals over the last 10 years**"</span>,</span>
<span id="cb5-46">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Each circle is one team's season that either &lt;span style='color: {colours[1]}; font-size:11pt; font-family:Myriad Pro'&gt;**didn't make the finals**&lt;/span&gt; or &lt;span style='color: {colours[2]}; font-size:11pt; font-family:Myriad Pro'&gt;**made the finals**&lt;/span&gt;.&lt;br&gt;Teams with the same number of wins are stacked on top of each other."</span>),</span>
<span id="cb5-47">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> socials) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">23.5</span>),</span>
<span id="cb5-49">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb5-51">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> colours) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> colours) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb5-55">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span>),</span>
<span id="cb5-56">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-57">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-58">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-59">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2025-01-18-how-many-wins-do-nrl-teams-need-to-make-the-finals/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>There are a few ways to approach calculating the probability of making the finals based on a given number of wins. Doing this requires a mindset shift from thinking only about the outcome of a single event (qualify for finals vs not) to considering the expected frequency of an outcome occurring over a large number of events involving uncertainty and randomness.</p>
</section>
<section id="analytically-specify-the-probability" class="level3">
<h3 class="anchored" data-anchor-id="analytically-specify-the-probability">Analytically specify the probability</h3>
<p>If this is possible, god knows I donâ€™t know how to do it. Given the complexity of the competition structure with all its dependencies and constraints, specifying the true mathematical probability would be an extremely high-dimensional optimisation problem. Even if it is possible, it would require a very sophisticated and computationally intensive solution.<sup>2</sup></p>
</section>
<section id="simply-calculate-the-proportion-of-teams-that-qualified-for-each-number-of-wins-the-data-set" class="level3">
<h3 class="anchored" data-anchor-id="simply-calculate-the-proportion-of-teams-that-qualified-for-each-number-of-wins-the-data-set">Simply calculate the proportion of teams that qualified for each number of wins the data set</h3>
<p>This isnâ€™t a good idea. With 17 teams and each of them playing 24 games in a season, the number of ways a season could play out to determine the final competition ladder is astronomically large. We only have 10 seasons of data; a tiny fraction of all the possible combinations of win-loss records and finals standings to use in our calculation. The true probability of making the finals canâ€™t be estimated with acceptable accuracy based on such a small sample of data. To demonstrate, the data we have shows no teams with 11 wins qualifying for the finals (from 8 times this has occurred). Does that mean the probability of qualifying is 0%? No.&nbsp;This is just noise (i.e., random variability) that we happen to have observed in our sample. Evidence of this is a team that only won 10 games qualified for the finals in a different season.</p>
</section>
<section id="fitting-a-linear-model-to-the-data" class="level3">
<h3 class="anchored" data-anchor-id="fitting-a-linear-model-to-the-data">Fitting a linear model to the data</h3>
<p>This also isnâ€™t a good idea. On the surface, a logistic regression model sounds okay as weâ€™re trying to estimate the probability of a binary outcome (making the finals or not), but the assumptions baked into these models arenâ€™t a great fit for this problem. Statistical models need to make assumptions so the complexity of the world can be simplified into something quantifiable and useful. In the case of generalised linear models like logistic regression, one of those assumptions is a linear relationship between the predictors and the transformed outcome. This is often useful because as it allows a smooth curve to be fit through the data, but it breaks down here without awareness of the fundamental competition constraints (e.g., for one team to win, the other has to lose). This means that they can (and do in this case) predict impossible scenarios like making the finals with a win-loss record that is mathematically impossible for them to qualify.</p>
</section>
<section id="monte-carlo-simulation" class="level3">
<h3 class="anchored" data-anchor-id="monte-carlo-simulation">Monte Carlo simulation</h3>
<p>These are a class of methods that basically use randomness to solve problems. They allow us to skip most of the hard maths and use computer simulations to get practically the same answers that could have very painfully been calculated analytically anyway. The idea is that we define a data generating process that mimics the way that data is generated in the real world, and then let the power of computers generate a huge amount of data. This lets us explore tens or hundreds of thousand (or more) possible season outcomes to give us a fuller picture of the probability of making the finals for each win-loss record. This is especially important for edge cases and unusual season results that are unlikely to have occurred in a small sample of historical data like ours. The beauty is that we can build in all the dependencies and constraints of the competition structure so we know the simulated data generated will adhere to it. Itâ€™ll capture the non-linear and threshold effects that exist as a result of the competition format. With enough simulated seasons, we can simply count the proportion of teams that qualify for a given number of wins to estimate the probability. The <a href="https://www.statology.org/law-of-large-numbers/">law of large numbers</a> tells us this converges to the true probability.</p>
<section id="simulating-a-season-draw" class="level4">
<h4 class="anchored" data-anchor-id="simulating-a-season-draw">Simulating a season draw</h4>
<p>To begin defining the data generating process, we need a way to randomly generate a season draw. <em>This was tricky</em>. 17 teams need to play 24 matches against other teams, 12 home and 12 away, where you play 8 teams twice and the other 8 teams only once (and of course accounting for the dependencies of head-to-head matches so one teamâ€™s schedule canâ€™t be considered in isolation). I found a way to do it using network graph theory.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define vector of team names</span></span>
<span id="cb6-2">teams <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>home)</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create random graph with 17 nodes (teams) </span></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Connect each node to 12 other nodes for home games and another 12 for away games</span></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to tibble and add team names</span></span>
<span id="cb6-7">simulate_season_draw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(){</span>
<span id="cb6-8">   graph <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample_degseq</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(teams)),</span>
<span id="cb6-9">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(teams)),</span>
<span id="cb6-10">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"simple.no.multiple"</span>)</span>
<span id="cb6-11">   </span>
<span id="cb6-12">    edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_edgelist</span>(graph)</span>
<span id="cb6-13">    </span>
<span id="cb6-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb6-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">home =</span> teams[edges[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]],</span>
<span id="cb6-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">away =</span> teams[edges[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]]</span>
<span id="cb6-17">    )</span>
<span id="cb6-18">}</span></code></pre></div>
</details>
</div>
<p>The output is one randomly simulated season draw. Here is 10 random match-ups from a simulated draw.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_season_draw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_sample</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="glocyppszr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#glocyppszr table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#glocyppszr thead, #glocyppszr tbody, #glocyppszr tfoot, #glocyppszr tr, #glocyppszr td, #glocyppszr th {
  border-style: none;
}

#glocyppszr p {
  margin: 0;
  padding: 0;
}

#glocyppszr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#glocyppszr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#glocyppszr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#glocyppszr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#glocyppszr .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#glocyppszr .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#glocyppszr .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#glocyppszr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#glocyppszr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#glocyppszr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#glocyppszr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#glocyppszr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#glocyppszr .gt_spanner_row {
  border-bottom-style: hidden;
}

#glocyppszr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#glocyppszr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#glocyppszr .gt_from_md > :first-child {
  margin-top: 0;
}

#glocyppszr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#glocyppszr .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#glocyppszr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#glocyppszr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#glocyppszr .gt_row_group_first td {
  border-top-width: 2px;
}

#glocyppszr .gt_row_group_first th {
  border-top-width: 2px;
}

#glocyppszr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#glocyppszr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#glocyppszr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#glocyppszr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#glocyppszr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#glocyppszr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#glocyppszr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#glocyppszr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#glocyppszr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#glocyppszr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#glocyppszr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#glocyppszr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#glocyppszr .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#glocyppszr .gt_left {
  text-align: left;
}

#glocyppszr .gt_center {
  text-align: center;
}

#glocyppszr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#glocyppszr .gt_font_normal {
  font-weight: normal;
}

#glocyppszr .gt_font_bold {
  font-weight: bold;
}

#glocyppszr .gt_font_italic {
  font-style: italic;
}

#glocyppszr .gt_super {
  font-size: 65%;
}

#glocyppszr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#glocyppszr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#glocyppszr .gt_indent_1 {
  text-indent: 5px;
}

#glocyppszr .gt_indent_2 {
  text-indent: 10px;
}

#glocyppszr .gt_indent_3 {
  text-indent: 15px;
}

#glocyppszr .gt_indent_4 {
  text-indent: 20px;
}

#glocyppszr .gt_indent_5 {
  text-indent: 25px;
}

#glocyppszr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#glocyppszr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

#glocyppszr tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="home">home</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="away">away</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="home" class="gt_row gt_left">North Queensland Cowboys</td>
<td headers="away" class="gt_row gt_left">Manly Warringah Sea Eagles</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Newcastle Knights</td>
<td headers="away" class="gt_row gt_left">Gold Coast Titans</td></tr>
    <tr><td headers="home" class="gt_row gt_left">New Zealand Warriors</td>
<td headers="away" class="gt_row gt_left">St George Illawarra Dragons</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Newcastle Knights</td>
<td headers="away" class="gt_row gt_left">St George Illawarra Dragons</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Cronulla Sutherland Sharks</td>
<td headers="away" class="gt_row gt_left">Canterbury Bankstown Bulldogs</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Wests Tigers</td>
<td headers="away" class="gt_row gt_left">South Sydney Rabbitohs</td></tr>
    <tr><td headers="home" class="gt_row gt_left">North Queensland Cowboys</td>
<td headers="away" class="gt_row gt_left">Wests Tigers</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Parramatta Eels</td>
<td headers="away" class="gt_row gt_left">Brisbane Broncos</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Newcastle Knights</td>
<td headers="away" class="gt_row gt_left">South Sydney Rabbitohs</td></tr>
    <tr><td headers="home" class="gt_row gt_left">Gold Coast Titans</td>
<td headers="away" class="gt_row gt_left">Brisbane Broncos</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="populate-fixtures-with-results" class="level4">
<h4 class="anchored" data-anchor-id="populate-fixtures-with-results">Populate fixtures with results</h4>
<p>Now we need results for these games. To do this we need to make an assumption about how we can realistically generate random results for matches between these teams. The points differential between teams in a match determines who wins and loses, so we need to mimic the way points differentials are distributed in real NRL games. This is how theyâ€™re distributed in the 2014-2024 data set we have.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">average_10yr_points_diff <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(points_differential) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>()</span>
<span id="cb8-4"></span>
<span id="cb8-5">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> points_differential)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">binwidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of games"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Points differential"</span>,</span>
<span id="cb8-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Most games end with an even  points differential**"</span>,</span>
<span id="cb8-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This makes sense given tries (4) and goals (2) are by far the most common ways to score points"</span>,</span>
<span id="cb8-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> socials) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)),</span>
<span id="cb8-13">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>, </span>
<span id="cb8-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb8-16">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">110</span>, </span>
<span id="cb8-17">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> average_10yr_points_diff, </span>
<span id="cb8-18">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> average_10yr_points_diff, </span>
<span id="cb8-19">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>,</span>
<span id="cb8-20">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb8-21">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">102</span>, </span>
<span id="cb8-23">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> average_10yr_points_diff,</span>
<span id="cb8-24">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:Myriad Pro Regular'&gt;**+{scales::number(average_10yr_points_diff, accuracy = 0.1)} points**&lt;br&gt;Home team advantage over past 10 years&lt;br&gt;(i.e. average points differential)&lt;/span&gt;"</span>)),</span>
<span id="cb8-25">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb8-26">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro"</span>,</span>
<span id="cb8-27">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb8-28">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb8-29">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb8-30">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, </span>
<span id="cb8-31">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">61</span>, </span>
<span id="cb8-33">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>,</span>
<span id="cb8-34">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Home team&lt;br&gt;win"</span>)),</span>
<span id="cb8-35">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb8-36">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro"</span>,</span>
<span id="cb8-37">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb8-38">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb8-39">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb8-40">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, </span>
<span id="cb8-41">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">61</span>, </span>
<span id="cb8-43">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>,</span>
<span id="cb8-44">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Away team&lt;br&gt;win"</span>)),</span>
<span id="cb8-45">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb8-46">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro"</span>,</span>
<span id="cb8-47">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb8-48">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb8-49">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb8-50">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, </span>
<span id="cb8-51">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb8-53">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2025-01-18-how-many-wins-do-nrl-teams-need-to-make-the-finals/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>This is an <em>interesting</em> distribution. The points differentials on even numbers are <strong>far</strong> more frequently observed than odd numbered differentials. This is an influence of competition constraints. Tries (4) and goals (2) are far more common than field goals (1), so itâ€™s expected that even numbered point differences are more likely to occur. Out of interest, I also added the average points differential across the data set as an annotation in the visual (+2.4). This is the expected advantage of playing at home over the last ~10 years.</p>
</section>
<section id="accounting-for-team-quality" class="level4">
<h4 class="anchored" data-anchor-id="accounting-for-team-quality">Accounting for team quality</h4>
<p>Because this distribution is so unique, Iâ€™ll randomly sample directly from it to populate the match results in my simulated seasons (instead of sampling from a theoretical distribution). I donâ€™t want to sample completely at random though, because the teams are not of equal quality. I want the better teams to have a higher probability of winning against the worse teams, weighted by how much better / worse they are. To do this, we need a measure of each teamâ€™s strength. There are many ways to approach this, but for simplicity Iâ€™ll just use the Sportsbet odds for winning the 2025 competition.</p>
<p>The bookmaker odds are converted to an implied probability of winning the competition. This will be my measure of relative team quality.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sportsbet odds for to win 2025 GF</span></span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Collected on 21st Jan 2025</span></span>
<span id="cb9-3">sportsbet_odds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tribble</span>(</span>
<span id="cb9-4">                                              <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>team, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>sportsbet_odds,</span>
<span id="cb9-5">                                 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brisbane Broncos"</span>,             <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.5</span>,</span>
<span id="cb9-6">                                 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canberra Raiders"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">67</span>,</span>
<span id="cb9-7">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury Bankstown Bulldogs"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>,</span>
<span id="cb9-8">                       <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cronulla Sutherland Sharks"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,</span>
<span id="cb9-9">                                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dolphins"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">61</span>,</span>
<span id="cb9-10">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gold Coast Titans"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">61</span>,</span>
<span id="cb9-11">                       <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manly Warringah Sea Eagles"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,</span>
<span id="cb9-12">                                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Melbourne Storm"</span>,            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.85</span>,</span>
<span id="cb9-13">                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Zealand Warriors"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">51</span>,</span>
<span id="cb9-14">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Newcastle Knights"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">61</span>,</span>
<span id="cb9-15">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"North Queensland Cowboys"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span>,</span>
<span id="cb9-16">                                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parramatta Eels"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">41</span>,</span>
<span id="cb9-17">                                 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Penrith Panthers"</span>,             <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.8</span>,</span>
<span id="cb9-18">                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"South Sydney Rabbitohs"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>,</span>
<span id="cb9-19">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"St George Illawarra Dragons"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">81</span>,</span>
<span id="cb9-20">                                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sydney Roosters"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb9-21">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wests Tigers"</span>,              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">46</span></span>
<span id="cb9-22">                    )</span>
<span id="cb9-23"></span>
<span id="cb9-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get a team strength measure (based on Sportsbet odds to win premiership)</span></span>
<span id="cb9-25">odds_to_probabilities <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(odds) {</span>
<span id="cb9-26">  probabilities <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> odds) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> odds)</span>
<span id="cb9-27">}</span>
<span id="cb9-28"></span>
<span id="cb9-29">sportsbet_implied_probabilities <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sportsbet_odds <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">implied_probabilities =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">odds_to_probabilities</span>(sportsbet_odds)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sportsbet_odds)</span>
<span id="cb9-32"></span>
<span id="cb9-33">sportsbet_implied_probabilities  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>implied_probabilities) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_percent</span>(implied_probabilities, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="aauyuvrfwl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#aauyuvrfwl table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#aauyuvrfwl thead, #aauyuvrfwl tbody, #aauyuvrfwl tfoot, #aauyuvrfwl tr, #aauyuvrfwl td, #aauyuvrfwl th {
  border-style: none;
}

#aauyuvrfwl p {
  margin: 0;
  padding: 0;
}

#aauyuvrfwl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aauyuvrfwl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aauyuvrfwl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aauyuvrfwl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aauyuvrfwl .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aauyuvrfwl .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aauyuvrfwl .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aauyuvrfwl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aauyuvrfwl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aauyuvrfwl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aauyuvrfwl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aauyuvrfwl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aauyuvrfwl .gt_spanner_row {
  border-bottom-style: hidden;
}

#aauyuvrfwl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aauyuvrfwl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#aauyuvrfwl .gt_from_md > :first-child {
  margin-top: 0;
}

#aauyuvrfwl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aauyuvrfwl .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aauyuvrfwl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#aauyuvrfwl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aauyuvrfwl .gt_row_group_first td {
  border-top-width: 2px;
}

#aauyuvrfwl .gt_row_group_first th {
  border-top-width: 2px;
}

#aauyuvrfwl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aauyuvrfwl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aauyuvrfwl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aauyuvrfwl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aauyuvrfwl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aauyuvrfwl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aauyuvrfwl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#aauyuvrfwl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aauyuvrfwl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aauyuvrfwl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aauyuvrfwl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aauyuvrfwl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aauyuvrfwl .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aauyuvrfwl .gt_left {
  text-align: left;
}

#aauyuvrfwl .gt_center {
  text-align: center;
}

#aauyuvrfwl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aauyuvrfwl .gt_font_normal {
  font-weight: normal;
}

#aauyuvrfwl .gt_font_bold {
  font-weight: bold;
}

#aauyuvrfwl .gt_font_italic {
  font-style: italic;
}

#aauyuvrfwl .gt_super {
  font-size: 65%;
}

#aauyuvrfwl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#aauyuvrfwl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aauyuvrfwl .gt_indent_1 {
  text-indent: 5px;
}

#aauyuvrfwl .gt_indent_2 {
  text-indent: 10px;
}

#aauyuvrfwl .gt_indent_3 {
  text-indent: 15px;
}

#aauyuvrfwl .gt_indent_4 {
  text-indent: 20px;
}

#aauyuvrfwl .gt_indent_5 {
  text-indent: 25px;
}

#aauyuvrfwl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#aauyuvrfwl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

#aauyuvrfwl tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="team">team</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="implied_probabilities">implied_probabilities</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="team" class="gt_row gt_left">Melbourne Storm</td>
<td headers="implied_probabilities" class="gt_row gt_right">24.3%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Penrith Panthers</td>
<td headers="implied_probabilities" class="gt_row gt_right">19.5%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Brisbane Broncos</td>
<td headers="implied_probabilities" class="gt_row gt_right">11.0%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Cronulla Sutherland Sharks</td>
<td headers="implied_probabilities" class="gt_row gt_right">7.2%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Manly Warringah Sea Eagles</td>
<td headers="implied_probabilities" class="gt_row gt_right">5.8%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Canterbury Bankstown Bulldogs</td>
<td headers="implied_probabilities" class="gt_row gt_right">5.5%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">South Sydney Rabbitohs</td>
<td headers="implied_probabilities" class="gt_row gt_right">5.2%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Sydney Roosters</td>
<td headers="implied_probabilities" class="gt_row gt_right">4.7%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">North Queensland Cowboys</td>
<td headers="implied_probabilities" class="gt_row gt_right">3.6%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Parramatta Eels</td>
<td headers="implied_probabilities" class="gt_row gt_right">2.3%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Wests Tigers</td>
<td headers="implied_probabilities" class="gt_row gt_right">2.0%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">New Zealand Warriors</td>
<td headers="implied_probabilities" class="gt_row gt_right">1.8%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Dolphins</td>
<td headers="implied_probabilities" class="gt_row gt_right">1.5%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Gold Coast Titans</td>
<td headers="implied_probabilities" class="gt_row gt_right">1.5%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Newcastle Knights</td>
<td headers="implied_probabilities" class="gt_row gt_right">1.5%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">Canberra Raiders</td>
<td headers="implied_probabilities" class="gt_row gt_right">1.4%</td></tr>
    <tr><td headers="team" class="gt_row gt_left">St George Illawarra Dragons</td>
<td headers="implied_probabilities" class="gt_row gt_right">1.2%</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="accounting-for-home-field-advantage" class="level4">
<h4 class="anchored" data-anchor-id="accounting-for-home-field-advantage">Accounting for home field advantage</h4>
<p>Next I need to account for home field advantage. Home teams won ~55.8% of games in the data set (1,084/1,944). If two teams of <strong>equal</strong> quality play, I want to adjust the probability of winning for the home team from 50% (based only on relative team quality) to ~55.8% so it matches the proportion of home wins observed in the 10 seasons of data. I can do this by searching across all potential home advantage multipliers from 1 (no home advantage) to 2 (playing at home doubles team quality) to find the optimal value that returns ~55.8% home win probability against equally matched opponents.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">perc_home_win <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>points_differential <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We know that for equally matched teams:</span></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Without home advantage, each team has 50% chance of winning</span></span>
<span id="cb10-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Historical data shows home teams actually win 55.8% of the time</span></span>
<span id="cb10-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. We need a multiplier that turns 50-50 into 55.8-44.2 (assuming no draws)</span></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to calculate win probability for equal teams given a multiplier</span></span>
<span id="cb10-9">calc_win_prob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(multiplier) {</span>
<span id="cb10-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Both teams start with equal strength</span></span>
<span id="cb10-11">  home_strength <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb10-12">  away_strength <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb10-13">  </span>
<span id="cb10-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply multiplier to home team</span></span>
<span id="cb10-15">  adjusted_home <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> home_strength <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> multiplier</span>
<span id="cb10-16">  </span>
<span id="cb10-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate resulting probability</span></span>
<span id="cb10-18">  prob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> adjusted_home <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (adjusted_home <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> away_strength)</span>
<span id="cb10-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(prob)</span>
<span id="cb10-20">}</span>
<span id="cb10-21"></span>
<span id="cb10-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to find multiplier that gives desired win probability</span></span>
<span id="cb10-23">find_optimal_multiplier <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(target_prob) {</span>
<span id="cb10-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optimise</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(m) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calc_win_prob</span>(m) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> target_prob), </span>
<span id="cb10-25">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">interval =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Search between 1-2x multiplier </span></span>
<span id="cb10-26">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maximum =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>minimum</span>
<span id="cb10-27">}</span>
<span id="cb10-28"></span>
<span id="cb10-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find multiplier that produces observed 55.8% home win rate</span></span>
<span id="cb10-30">optimal_multiplier <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find_optimal_multiplier</span>(perc_home_win)</span></code></pre></div>
</details>
</div>
<p>This method carries some simplifying assumptions. In reality, some teams are pretty likely to benefit more from playing at home than others. That isnâ€™t accounted for here (all teams will be given the same home advantage based on historical data). Also the multiplier used to apply the home team advantage was found by optimising for the win rate between two teams of equal quality. This was to best isolate the degree of home advantage without the influence of differences in team quality. The mathematically optimal multiplier will change with each difference in relative team quality (e.g., unequally matched teams).</p>
</section>
<section id="simulate-the-match-results" class="level4">
<h4 class="anchored" data-anchor-id="simulate-the-match-results">Simulate the match results</h4>
<p>Now I can finally define a function that simulates a match. It compares the implied probability of winning the competition after accounting for home field advantage to calculate the home team win probability for the game. A random number is drawn from a uniform distribution (0 to 1) and if this number is less than the home win probability, then the match is assigned as a home win. Once we know whether the home or away team wins, a random sample is drawn from either the positive (home wins) or negative (away wins) observed points differential distribution (i.e., empirical distribution).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to simulate a single match</span></span>
<span id="cb11-2">simulate_match <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(home_strength, away_strength, diff_vector) {</span>
<span id="cb11-3">  home_advantage_multiplier <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> optimal_multiplier</span>
<span id="cb11-4">  </span>
<span id="cb11-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply home advantage to home team's strength</span></span>
<span id="cb11-6">  adjusted_home_strength <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> home_strength <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> home_advantage_multiplier</span>
<span id="cb11-7"> </span>
<span id="cb11-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate win probabilities based on Sportsbet's Grand Final win probabilities</span></span>
<span id="cb11-9">  home_win_prob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> adjusted_home_strength <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (adjusted_home_strength <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> away_strength)</span>
<span id="cb11-10">  </span>
<span id="cb11-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare to uniform distribution to determine if it's a home win or away win</span></span>
<span id="cb11-12">  is_home_win <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> home_win_prob</span>
<span id="cb11-13">  </span>
<span id="cb11-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample the differential</span></span>
<span id="cb11-15">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (is_home_win) {</span>
<span id="cb11-16">    diff <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(diff_vector[diff_vector <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb11-17">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb11-18">    diff <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(diff_vector[diff_vector <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb11-19">  }</span>
<span id="cb11-20">  </span>
<span id="cb11-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(diff)</span>
<span id="cb11-22">}</span></code></pre></div>
</details>
</div>
<p>To demonstrate, here I generate 15 random points differential results for a game between a home team with a 5% chance of winning the competition and an away team with a 20% chance.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map2</span>(</span>
<span id="cb12-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb12-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), </span>
<span id="cb12-4">  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_match</span>(.x, .y, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>points_differential)</span>
<span id="cb12-5">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  -2  -6  24  -1  -2 -22  30  -2  -6 -28  -6 -32 -20 -16  -8</code></pre>
</div>
</div>
<p>Notice how most of the values are negative (meaning the away team won).</p>
<p>This incorporates the away team being of higher quality (20% chance of winning the competition vs 5%) and the home team benefiting from the home field advantage. The proportion of away team wins over a very large number of simulations gives us an estimated probability of the away team winning this game that approaches the true value.</p>
<p>There are again some simplifications at play here. Firstly, draws/ties are not considered (or possible) with this data generating process. I think this is fine as only 0.25% of matches in the data set ended in draws (5 from 1,944). Secondly, within home wins or away wins, the sampling of the points differential is completely random. This means that if a home team has been assigned the win, the amount they win by doesnâ€™t consider the difference in team quality or home field advantage. The winning amount is completely random within the winning point differentials in the data set. Team strength values and home field advantage only influence who wins. I also donâ€™t think this threatens the validity of the results (only for and against values will be affected), but worth mentioning as it is a simplifying assumption that I doubt is true in reality.</p>
</section>
<section id="simulating-many-seasons" class="level4">
<h4 class="anchored" data-anchor-id="simulating-many-seasons">Simulating many seasons</h4>
<p>Now we have a function to simulate a match, we need to use it populate the random season draws with match results. We donâ€™t just want one or ten seasons simulated though.</p>
<p><strong><em>We want ten thousand.</em></strong></p>
<p>This is where the actual work gets done. To demonstrate what this looks like, Iâ€™ll pick out a random 10 simulated games with results to display from the 2,040,000 total simulated matches.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">seasons_to_simulate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span></span>
<span id="cb14-2"></span>
<span id="cb14-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up parallel processing</span></span>
<span id="cb14-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plan</span>(multisession, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">workers =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">detectCores</span>())</span>
<span id="cb14-5"></span>
<span id="cb14-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For reproducibility</span></span>
<span id="cb14-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2025</span>)</span>
<span id="cb14-8"></span>
<span id="cb14-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate full seasons with results</span></span>
<span id="cb14-10">simulated_seasons <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb14-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">season =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>seasons_to_simulate,</span>
<span id="cb14-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">results =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">future_map</span>(season, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_season_draw</span>(),</span>
<span id="cb14-13">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">furrr_options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unnest</span>(results) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(sportsbet_implied_probabilities, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(home <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> team)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">home_implied_probability =</span> implied_probabilities) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(sportsbet_implied_probabilities, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(away <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> team)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">away_implied_probability =</span> implied_probabilities) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb14-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">points_differential =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmap_dbl</span>(</span>
<span id="cb14-21">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(home_implied_probability, away_implied_probability),</span>
<span id="cb14-22">      <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">simulate_match</span>(..<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ..<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>points_differential)</span>
<span id="cb14-23">    ),</span>
<span id="cb14-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">home_win =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(points_differential <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb14-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">away_win =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(points_differential <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb14-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">draw =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(points_differential <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb14-27">  )</span>
<span id="cb14-28"></span>
<span id="cb14-29">simulated_seasons <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"probability"</span>), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>draw) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_sample</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="whedekywck" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#whedekywck table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#whedekywck thead, #whedekywck tbody, #whedekywck tfoot, #whedekywck tr, #whedekywck td, #whedekywck th {
  border-style: none;
}

#whedekywck p {
  margin: 0;
  padding: 0;
}

#whedekywck .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#whedekywck .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#whedekywck .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#whedekywck .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#whedekywck .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#whedekywck .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#whedekywck .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#whedekywck .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#whedekywck .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#whedekywck .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#whedekywck .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#whedekywck .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#whedekywck .gt_spanner_row {
  border-bottom-style: hidden;
}

#whedekywck .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#whedekywck .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#whedekywck .gt_from_md > :first-child {
  margin-top: 0;
}

#whedekywck .gt_from_md > :last-child {
  margin-bottom: 0;
}

#whedekywck .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#whedekywck .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#whedekywck .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#whedekywck .gt_row_group_first td {
  border-top-width: 2px;
}

#whedekywck .gt_row_group_first th {
  border-top-width: 2px;
}

#whedekywck .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#whedekywck .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#whedekywck .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#whedekywck .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#whedekywck .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#whedekywck .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#whedekywck .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#whedekywck .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#whedekywck .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#whedekywck .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#whedekywck .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#whedekywck .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#whedekywck .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#whedekywck .gt_left {
  text-align: left;
}

#whedekywck .gt_center {
  text-align: center;
}

#whedekywck .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#whedekywck .gt_font_normal {
  font-weight: normal;
}

#whedekywck .gt_font_bold {
  font-weight: bold;
}

#whedekywck .gt_font_italic {
  font-style: italic;
}

#whedekywck .gt_super {
  font-size: 65%;
}

#whedekywck .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#whedekywck .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#whedekywck .gt_indent_1 {
  text-indent: 5px;
}

#whedekywck .gt_indent_2 {
  text-indent: 10px;
}

#whedekywck .gt_indent_3 {
  text-indent: 15px;
}

#whedekywck .gt_indent_4 {
  text-indent: 20px;
}

#whedekywck .gt_indent_5 {
  text-indent: 25px;
}

#whedekywck .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#whedekywck div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

#whedekywck tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="season">season</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="home">home</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="away">away</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="points_differential">points_differential</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="home_win">home_win</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="away_win">away_win</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="season" class="gt_row gt_right">5157</td>
<td headers="home" class="gt_row gt_left">Manly Warringah Sea Eagles</td>
<td headers="away" class="gt_row gt_left">Wests Tigers</td>
<td headers="points_differential" class="gt_row gt_right">2</td>
<td headers="home_win" class="gt_row gt_right">1</td>
<td headers="away_win" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">3965</td>
<td headers="home" class="gt_row gt_left">Canterbury Bankstown Bulldogs</td>
<td headers="away" class="gt_row gt_left">Melbourne Storm</td>
<td headers="points_differential" class="gt_row gt_right">-8</td>
<td headers="home_win" class="gt_row gt_right">0</td>
<td headers="away_win" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">8531</td>
<td headers="home" class="gt_row gt_left">Dolphins</td>
<td headers="away" class="gt_row gt_left">South Sydney Rabbitohs</td>
<td headers="points_differential" class="gt_row gt_right">30</td>
<td headers="home_win" class="gt_row gt_right">1</td>
<td headers="away_win" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">1500</td>
<td headers="home" class="gt_row gt_left">St George Illawarra Dragons</td>
<td headers="away" class="gt_row gt_left">Canterbury Bankstown Bulldogs</td>
<td headers="points_differential" class="gt_row gt_right">8</td>
<td headers="home_win" class="gt_row gt_right">1</td>
<td headers="away_win" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">320</td>
<td headers="home" class="gt_row gt_left">Melbourne Storm</td>
<td headers="away" class="gt_row gt_left">Penrith Panthers</td>
<td headers="points_differential" class="gt_row gt_right">-1</td>
<td headers="home_win" class="gt_row gt_right">0</td>
<td headers="away_win" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">5767</td>
<td headers="home" class="gt_row gt_left">St George Illawarra Dragons</td>
<td headers="away" class="gt_row gt_left">North Queensland Cowboys</td>
<td headers="points_differential" class="gt_row gt_right">-2</td>
<td headers="home_win" class="gt_row gt_right">0</td>
<td headers="away_win" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2151</td>
<td headers="home" class="gt_row gt_left">Penrith Panthers</td>
<td headers="away" class="gt_row gt_left">St George Illawarra Dragons</td>
<td headers="points_differential" class="gt_row gt_right">21</td>
<td headers="home_win" class="gt_row gt_right">1</td>
<td headers="away_win" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">5020</td>
<td headers="home" class="gt_row gt_left">Penrith Panthers</td>
<td headers="away" class="gt_row gt_left">Sydney Roosters</td>
<td headers="points_differential" class="gt_row gt_right">12</td>
<td headers="home_win" class="gt_row gt_right">1</td>
<td headers="away_win" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">8804</td>
<td headers="home" class="gt_row gt_left">St George Illawarra Dragons</td>
<td headers="away" class="gt_row gt_left">Melbourne Storm</td>
<td headers="points_differential" class="gt_row gt_right">-22</td>
<td headers="home_win" class="gt_row gt_right">0</td>
<td headers="away_win" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">5136</td>
<td headers="home" class="gt_row gt_left">New Zealand Warriors</td>
<td headers="away" class="gt_row gt_left">Dolphins</td>
<td headers="points_differential" class="gt_row gt_right">-52</td>
<td headers="home_win" class="gt_row gt_right">0</td>
<td headers="away_win" class="gt_row gt_right">1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
<p>This takes a minute or two to run because itâ€™s generating 10,000 random season draws and then simulating results for all 2,040,000 games.</p>
</section>
</section>
<section id="exploring-the-results" class="level3">
<h3 class="anchored" data-anchor-id="exploring-the-results">Exploring the results</h3>
<p>We can use the function we defined earlier to summarise the match level simulation results into an end-of-season ladder for each of the 10,000 seasons. Here is one of those seasons final standings (for season number 2,534 out of 10,000).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">simulation_summary_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">competition_table</span>(simulated_seasons)</span>
<span id="cb15-2"></span>
<span id="cb15-3">simulation_summary_results <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb15-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(season <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2534</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb15-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb15-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="aqryhkrtdp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#aqryhkrtdp table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#aqryhkrtdp thead, #aqryhkrtdp tbody, #aqryhkrtdp tfoot, #aqryhkrtdp tr, #aqryhkrtdp td, #aqryhkrtdp th {
  border-style: none;
}

#aqryhkrtdp p {
  margin: 0;
  padding: 0;
}

#aqryhkrtdp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aqryhkrtdp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aqryhkrtdp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aqryhkrtdp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aqryhkrtdp .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aqryhkrtdp .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aqryhkrtdp .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aqryhkrtdp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aqryhkrtdp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aqryhkrtdp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aqryhkrtdp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aqryhkrtdp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aqryhkrtdp .gt_spanner_row {
  border-bottom-style: hidden;
}

#aqryhkrtdp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aqryhkrtdp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#aqryhkrtdp .gt_from_md > :first-child {
  margin-top: 0;
}

#aqryhkrtdp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aqryhkrtdp .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aqryhkrtdp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#aqryhkrtdp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aqryhkrtdp .gt_row_group_first td {
  border-top-width: 2px;
}

#aqryhkrtdp .gt_row_group_first th {
  border-top-width: 2px;
}

#aqryhkrtdp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqryhkrtdp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aqryhkrtdp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aqryhkrtdp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aqryhkrtdp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqryhkrtdp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aqryhkrtdp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#aqryhkrtdp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aqryhkrtdp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aqryhkrtdp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aqryhkrtdp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqryhkrtdp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aqryhkrtdp .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqryhkrtdp .gt_left {
  text-align: left;
}

#aqryhkrtdp .gt_center {
  text-align: center;
}

#aqryhkrtdp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aqryhkrtdp .gt_font_normal {
  font-weight: normal;
}

#aqryhkrtdp .gt_font_bold {
  font-weight: bold;
}

#aqryhkrtdp .gt_font_italic {
  font-style: italic;
}

#aqryhkrtdp .gt_super {
  font-size: 65%;
}

#aqryhkrtdp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#aqryhkrtdp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aqryhkrtdp .gt_indent_1 {
  text-indent: 5px;
}

#aqryhkrtdp .gt_indent_2 {
  text-indent: 10px;
}

#aqryhkrtdp .gt_indent_3 {
  text-indent: 15px;
}

#aqryhkrtdp .gt_indent_4 {
  text-indent: 20px;
}

#aqryhkrtdp .gt_indent_5 {
  text-indent: 25px;
}

#aqryhkrtdp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#aqryhkrtdp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

#aqryhkrtdp tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="season">season</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="team">team</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="total_wins">total_wins</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="for_and_against">for_and_against</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="regular_season_position">regular_season_position</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="made_finals">made_finals</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Penrith Panthers</td>
<td headers="total_wins" class="gt_row gt_right">23</td>
<td headers="for_and_against" class="gt_row gt_right">245</td>
<td headers="regular_season_position" class="gt_row gt_right">1</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Melbourne Storm</td>
<td headers="total_wins" class="gt_row gt_right">20</td>
<td headers="for_and_against" class="gt_row gt_right">331</td>
<td headers="regular_season_position" class="gt_row gt_right">2</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Brisbane Broncos</td>
<td headers="total_wins" class="gt_row gt_right">20</td>
<td headers="for_and_against" class="gt_row gt_right">185</td>
<td headers="regular_season_position" class="gt_row gt_right">3</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Cronulla Sutherland Sharks</td>
<td headers="total_wins" class="gt_row gt_right">17</td>
<td headers="for_and_against" class="gt_row gt_right">118</td>
<td headers="regular_season_position" class="gt_row gt_right">4</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Canterbury Bankstown Bulldogs</td>
<td headers="total_wins" class="gt_row gt_right">16</td>
<td headers="for_and_against" class="gt_row gt_right">159</td>
<td headers="regular_season_position" class="gt_row gt_right">5</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">South Sydney Rabbitohs</td>
<td headers="total_wins" class="gt_row gt_right">14</td>
<td headers="for_and_against" class="gt_row gt_right">84</td>
<td headers="regular_season_position" class="gt_row gt_right">6</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Manly Warringah Sea Eagles</td>
<td headers="total_wins" class="gt_row gt_right">13</td>
<td headers="for_and_against" class="gt_row gt_right">37</td>
<td headers="regular_season_position" class="gt_row gt_right">7</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Gold Coast Titans</td>
<td headers="total_wins" class="gt_row gt_right">12</td>
<td headers="for_and_against" class="gt_row gt_right">54</td>
<td headers="regular_season_position" class="gt_row gt_right">8</td>
<td headers="made_finals" class="gt_row gt_right">1</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">North Queensland Cowboys</td>
<td headers="total_wins" class="gt_row gt_right">11</td>
<td headers="for_and_against" class="gt_row gt_right">-21</td>
<td headers="regular_season_position" class="gt_row gt_right">9</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">New Zealand Warriors</td>
<td headers="total_wins" class="gt_row gt_right">10</td>
<td headers="for_and_against" class="gt_row gt_right">-103</td>
<td headers="regular_season_position" class="gt_row gt_right">10</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Sydney Roosters</td>
<td headers="total_wins" class="gt_row gt_right">9</td>
<td headers="for_and_against" class="gt_row gt_right">-96</td>
<td headers="regular_season_position" class="gt_row gt_right">11</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Parramatta Eels</td>
<td headers="total_wins" class="gt_row gt_right">8</td>
<td headers="for_and_against" class="gt_row gt_right">-81</td>
<td headers="regular_season_position" class="gt_row gt_right">12</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Wests Tigers</td>
<td headers="total_wins" class="gt_row gt_right">8</td>
<td headers="for_and_against" class="gt_row gt_right">-119</td>
<td headers="regular_season_position" class="gt_row gt_right">13</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">St George Illawarra Dragons</td>
<td headers="total_wins" class="gt_row gt_right">7</td>
<td headers="for_and_against" class="gt_row gt_right">-184</td>
<td headers="regular_season_position" class="gt_row gt_right">14</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Newcastle Knights</td>
<td headers="total_wins" class="gt_row gt_right">6</td>
<td headers="for_and_against" class="gt_row gt_right">-86</td>
<td headers="regular_season_position" class="gt_row gt_right">15</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Canberra Raiders</td>
<td headers="total_wins" class="gt_row gt_right">6</td>
<td headers="for_and_against" class="gt_row gt_right">-195</td>
<td headers="regular_season_position" class="gt_row gt_right">16</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
    <tr><td headers="season" class="gt_row gt_right">2534</td>
<td headers="team" class="gt_row gt_left">Dolphins</td>
<td headers="total_wins" class="gt_row gt_right">4</td>
<td headers="for_and_against" class="gt_row gt_right">-328</td>
<td headers="regular_season_position" class="gt_row gt_right">17</td>
<td headers="made_finals" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
<p>What weâ€™re really after though is the proportion of teams that make the finals for each given win total across each of the 10,000 simulated seasons.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate proportions ----------------------------</span></span>
<span id="cb16-2">probabilities_simulated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simulation_summary_results <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">count_made_finals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(made_finals),</span>
<span id="cb16-4">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_count =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb16-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> total_wins) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percentage =</span> count_made_finals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_count) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>total_wins)</span>
<span id="cb16-8"></span>
<span id="cb16-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create table --------------------------------------</span></span>
<span id="cb16-10">probabilities_simulated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perc_no_finals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> percentage,</span>
<span id="cb16-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_wins =</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{total_wins} wins"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"perc"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"metric"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"perc"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb16-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total =</span> total_count[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb16-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">made_finals =</span> count_made_finals[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb16-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">list_data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(perc),</span>
<span id="cb16-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> total_wins) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rowname_col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"total_wins"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"total"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"made_finals"</span>),</span>
<span id="cb16-22">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb16-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NRL teams need to win 13 games to be confident of playing finals"</span>),</span>
<span id="cb16-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finals probabilities based on results from 10,000 simulated seasons"</span></span>
<span id="cb16-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_source_note</span>(</span>
<span id="cb16-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">source_note =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(socials)</span>
<span id="cb16-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_plt_bar_stack</span>(list_data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>,</span>
<span id="cb16-31">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Qualify"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fail to qualify"</span>),</span>
<span id="cb16-32">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(colours),</span>
<span id="cb16-33">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Segoe UI"</span>,</span>
<span id="cb16-34">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fmt_fn =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb16-35">                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb16-36">                       x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.03</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb16-37">                       x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"100%"</span>,</span>
<span id="cb16-38">                       x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.999</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;99.9%"</span>,</span>
<span id="cb16-39">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)(x)</span>
<span id="cb16-40">                       )</span>
<span id="cb16-41">                   }) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(</span>
<span id="cb16-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simulated&lt;br&gt;occurrences"</span>),</span>
<span id="cb16-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">made_finals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Times&lt;br&gt;qualified"</span>)</span>
<span id="cb16-45">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> list_data,</span>
<span id="cb16-47">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(label) {</span>
<span id="cb16-48">                    full_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finals probability&lt;br&gt;{label}"</span>)</span>
<span id="cb16-49">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span&gt;%s&lt;/span&gt;"</span>, full_label) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-50">                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>()</span>
<span id="cb16-51">    }) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb16-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro"</span>),</span>
<span id="cb16-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_body</span>()</span>
<span id="cb16-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb16-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(</span>
<span id="cb16-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">font =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Condensed"</span>,</span>
<span id="cb16-59">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb16-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_title</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span>)</span>
<span id="cb16-61">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>),</span>
<span id="cb16-63">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_source_notes</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb16-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">heading.title.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb16-65">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">heading.subtitle.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>,</span>
<span id="cb16-66">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">table.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,</span>
<span id="cb16-67">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">source_notes.font.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="upgqoofrvl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#upgqoofrvl table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#upgqoofrvl thead, #upgqoofrvl tbody, #upgqoofrvl tfoot, #upgqoofrvl tr, #upgqoofrvl td, #upgqoofrvl th {
  border-style: none;
}

#upgqoofrvl p {
  margin: 0;
  padding: 0;
}

#upgqoofrvl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: 700px;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#upgqoofrvl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#upgqoofrvl .gt_title {
  color: #333333;
  font-size: 36px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#upgqoofrvl .gt_subtitle {
  color: #333333;
  font-size: 18px;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#upgqoofrvl .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#upgqoofrvl .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#upgqoofrvl .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#upgqoofrvl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#upgqoofrvl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#upgqoofrvl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#upgqoofrvl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#upgqoofrvl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#upgqoofrvl .gt_spanner_row {
  border-bottom-style: hidden;
}

#upgqoofrvl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#upgqoofrvl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#upgqoofrvl .gt_from_md > :first-child {
  margin-top: 0;
}

#upgqoofrvl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#upgqoofrvl .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#upgqoofrvl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#upgqoofrvl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#upgqoofrvl .gt_row_group_first td {
  border-top-width: 2px;
}

#upgqoofrvl .gt_row_group_first th {
  border-top-width: 2px;
}

#upgqoofrvl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#upgqoofrvl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#upgqoofrvl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#upgqoofrvl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#upgqoofrvl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#upgqoofrvl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#upgqoofrvl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#upgqoofrvl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#upgqoofrvl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#upgqoofrvl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#upgqoofrvl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#upgqoofrvl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#upgqoofrvl .gt_sourcenote {
  font-size: 15px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#upgqoofrvl .gt_left {
  text-align: left;
}

#upgqoofrvl .gt_center {
  text-align: center;
}

#upgqoofrvl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#upgqoofrvl .gt_font_normal {
  font-weight: normal;
}

#upgqoofrvl .gt_font_bold {
  font-weight: bold;
}

#upgqoofrvl .gt_font_italic {
  font-style: italic;
}

#upgqoofrvl .gt_super {
  font-size: 65%;
}

#upgqoofrvl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#upgqoofrvl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#upgqoofrvl .gt_indent_1 {
  text-indent: 5px;
}

#upgqoofrvl .gt_indent_2 {
  text-indent: 10px;
}

#upgqoofrvl .gt_indent_3 {
  text-indent: 15px;
}

#upgqoofrvl .gt_indent_4 {
  text-indent: 20px;
}

#upgqoofrvl .gt_indent_5 {
  text-indent: 25px;
}

#upgqoofrvl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#upgqoofrvl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

#upgqoofrvl tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="4" class="gt_heading gt_title gt_font_normal" style="font-family: 'Myriad Pro Condensed'; font-weight: bold;">NRL teams need to win 13 games to be confident of playing finals</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="font-family: Chivo; font-weight: 300;">Finals probabilities based on results from 10,000 simulated seasons</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="a::stub"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="total">Simulated<br>occurrences</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="made_finals">Times<br>qualified</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col" id="list_data"><span>Finals probability<br><span style="color:#134A8E"><b>Qualify</b></span>||<span style="color:#E31937"><b>Fail to qualify</b></span></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><th id="stub_1_1" scope="row" class="gt_row gt_center gt_stub">24 wins</th>
<td headers="stub_1_1 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">232</td>
<td headers="stub_1_1 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">232</td>
<td headers="stub_1_1 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="198.43" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_2" scope="row" class="gt_row gt_center gt_stub">23 wins</th>
<td headers="stub_1_2 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">1,273</td>
<td headers="stub_1_2 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">1,273</td>
<td headers="stub_1_2 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="198.43" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_3" scope="row" class="gt_row gt_center gt_stub">22 wins</th>
<td headers="stub_1_3 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">3,045</td>
<td headers="stub_1_3 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">3,045</td>
<td headers="stub_1_3 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="198.43" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_4" scope="row" class="gt_row gt_center gt_stub">21 wins</th>
<td headers="stub_1_4 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">4,799</td>
<td headers="stub_1_4 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">4,799</td>
<td headers="stub_1_4 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="198.43" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_5" scope="row" class="gt_row gt_center gt_stub">20 wins</th>
<td headers="stub_1_5 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">5,830</td>
<td headers="stub_1_5 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">5,830</td>
<td headers="stub_1_5 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="198.43" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_6" scope="row" class="gt_row gt_center gt_stub">19 wins</th>
<td headers="stub_1_6 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">6,021</td>
<td headers="stub_1_6 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">6,021</td>
<td headers="stub_1_6 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="198.43" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_7" scope="row" class="gt_row gt_center gt_stub">18 wins</th>
<td headers="stub_1_7 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">6,586</td>
<td headers="stub_1_7 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">6,586</td>
<td headers="stub_1_7 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="198.43" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_8" scope="row" class="gt_row gt_center gt_stub">17 wins</th>
<td headers="stub_1_8 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">7,648</td>
<td headers="stub_1_8 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">7,648</td>
<td headers="stub_1_8 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="198.43" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_9" scope="row" class="gt_row gt_center gt_stub">16 wins</th>
<td headers="stub_1_9 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">8,810</td>
<td headers="stub_1_9 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">8,810</td>
<td headers="stub_1_9 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="198.43" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_10" scope="row" class="gt_row gt_center gt_stub">15 wins</th>
<td headers="stub_1_10 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">10,212</td>
<td headers="stub_1_10 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">10,210</td>
<td headers="stub_1_10 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="198.39" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="198.39" y="0.0000000000000018" width="0.039" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.19" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="28.48px" lengthadjust="spacingAndGlyphs">&gt;99.9%</text></g></svg></td></tr>
    <tr><th id="stub_1_11" scope="row" class="gt_row gt_center gt_stub">14 wins</th>
<td headers="stub_1_11 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">10,508</td>
<td headers="stub_1_11 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">10,345</td>
<td headers="stub_1_11 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="195.35" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="195.35" y="0.0000000000000018" width="3.08" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="97.67" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="22.64px" lengthadjust="spacingAndGlyphs">98.4%</text></g></svg></td></tr>
    <tr><th id="stub_1_12" scope="row" class="gt_row gt_center gt_stub">13 wins</th>
<td headers="stub_1_12 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">10,431</td>
<td headers="stub_1_12 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">8,926</td>
<td headers="stub_1_12 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="169.80" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="169.80" y="0.0000000000000018" width="28.63" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="84.90" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="22.64px" lengthadjust="spacingAndGlyphs">85.6%</text><text x="184.11" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="22.64px" lengthadjust="spacingAndGlyphs">14.4%</text></g></svg></td></tr>
    <tr><th id="stub_1_13" scope="row" class="gt_row gt_center gt_stub">12 wins</th>
<td headers="stub_1_13 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">9,784</td>
<td headers="stub_1_13 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">4,859</td>
<td headers="stub_1_13 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="98.54" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="98.54" y="0.0000000000000018" width="99.88" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="49.27" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="22.64px" lengthadjust="spacingAndGlyphs">49.7%</text><text x="148.48" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="22.64px" lengthadjust="spacingAndGlyphs">50.3%</text></g></svg></td></tr>
    <tr><th id="stub_1_14" scope="row" class="gt_row gt_center gt_stub">11 wins</th>
<td headers="stub_1_14 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">10,428</td>
<td headers="stub_1_14 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">1,323</td>
<td headers="stub_1_14 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="25.17" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="25.17" y="0.0000000000000018" width="173.25" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="12.59" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="22.64px" lengthadjust="spacingAndGlyphs">12.7%</text><text x="111.80" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="22.64px" lengthadjust="spacingAndGlyphs">87.3%</text></g></svg></td></tr>
    <tr><th id="stub_1_15" scope="row" class="gt_row gt_center gt_stub">10 wins</th>
<td headers="stub_1_15 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">11,258</td>
<td headers="stub_1_15 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">92</td>
<td headers="stub_1_15 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="1.62" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="1.62" y="0.0000000000000018" width="196.80" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="100.02" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="22.64px" lengthadjust="spacingAndGlyphs">99.2%</text></g></svg></td></tr>
    <tr><th id="stub_1_16" scope="row" class="gt_row gt_center gt_stub">9 wins</th>
<td headers="stub_1_16 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">12,996</td>
<td headers="stub_1_16 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">1</td>
<td headers="stub_1_16 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="0.015" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="0.015" y="0.0000000000000018" width="198.41" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.22" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="28.48px" lengthadjust="spacingAndGlyphs">&gt;99.9%</text></g></svg></td></tr>
    <tr><th id="stub_1_17" scope="row" class="gt_row gt_center gt_stub">8 wins</th>
<td headers="stub_1_17 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">13,688</td>
<td headers="stub_1_17 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">0</td>
<td headers="stub_1_17 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_18" scope="row" class="gt_row gt_center gt_stub">7 wins</th>
<td headers="stub_1_18 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">13,003</td>
<td headers="stub_1_18 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">0</td>
<td headers="stub_1_18 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_19" scope="row" class="gt_row gt_center gt_stub">6 wins</th>
<td headers="stub_1_19 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">10,427</td>
<td headers="stub_1_19 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">0</td>
<td headers="stub_1_19 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_20" scope="row" class="gt_row gt_center gt_stub">5 wins</th>
<td headers="stub_1_20 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">7,014</td>
<td headers="stub_1_20 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">0</td>
<td headers="stub_1_20 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_21" scope="row" class="gt_row gt_center gt_stub">4 wins</th>
<td headers="stub_1_21 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">3,822</td>
<td headers="stub_1_21 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">0</td>
<td headers="stub_1_21 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_22" scope="row" class="gt_row gt_center gt_stub">3 wins</th>
<td headers="stub_1_22 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">1,593</td>
<td headers="stub_1_22 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">0</td>
<td headers="stub_1_22 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_23" scope="row" class="gt_row gt_center gt_stub">2 wins</th>
<td headers="stub_1_23 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">496</td>
<td headers="stub_1_23 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">0</td>
<td headers="stub_1_23 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_24" scope="row" class="gt_row gt_center gt_stub">1 wins</th>
<td headers="stub_1_24 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">90</td>
<td headers="stub_1_24 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">0</td>
<td headers="stub_1_24 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
    <tr><th id="stub_1_25" scope="row" class="gt_row gt_center gt_stub">0 wins</th>
<td headers="stub_1_25 total" class="gt_row gt_right" style="font-family: 'Myriad Pro';">6</td>
<td headers="stub_1_25 made_finals" class="gt_row gt_right" style="font-family: 'Myriad Pro';">0</td>
<td headers="stub_1_25 list_data" class="gt_row gt_center" style="font-family: 'Myriad Pro';"><!--?xml version='1.0' encoding='UTF-8' ?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" class="svglite" width="198.43pt" height="14.17pt" viewbox="0 0 198.43 14.17"><defs>  <style type="text/css">    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  </style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs>  <clippath id="cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==">    <rect x="0.00" y="0.00" width="198.43" height="14.17"></rect>  </clippath></defs><g clip-path="url(#cpMC4wMHwxOTguNDN8MC4wMHwxNC4xNw==)"><rect x="0.00" y="0.0000000000000018" width="0.00" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #134A8E;"></rect><rect x="0.00" y="0.0000000000000018" width="198.43" height="14.17" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #E31937;"></rect><text x="99.21" y="10.07" text-anchor="middle" style="font-size: 8.54px;fill: #FFFFFF; font-family: &quot;Segoe UI&quot;;" textlength="20.79px" lengthadjust="spacingAndGlyphs">100%</text></g></svg></td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" style="text-align: right;" colspan="4"><span style="font-family:&quot;Font Awesome 6 Brands&quot;;color: dodgerblue">ï‚Œ</span> <span style="font-family: &quot;Segoe UI&quot;;color: grey20">Mitch Henderson</span>
<span style="font-family:&quot;Font Awesome 6 Brands&quot;;color: dodgerblue">î™±</span> <span style="font-family: &quot;Segoe UI&quot;;color: grey20">mitchhenderson</span>
<span style="font-family:&quot;Font Awesome 6 Brands&quot;;color: dodgerblue">ï‚›</span> <span style="font-family: &quot;Segoe UI&quot;;color: grey20">mitchhenderson</span></td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
</div>
<p>Winning 16 or more games in a season was enough to make the finals in every one of the 10,000 simulations. Winning 8 or less wasnâ€™t enough to qualify in any. No real surprises there. In many of those cases it would be mathematically impossible for a different result. These simulations donâ€™t prove that though (maybe a team could qualify with 8 wins in circumstances that didnâ€™t occur in my 10,000 simulations), but the law of large numbers tells us these results are close enough to be correct for all practical purposes. To demonstrate, only one team made the finals with 9 wins (out of 12,996 teams that finished with 9 wins across the simulations). Finishing in the top 8 with only 9 wins is clearly mathematically possible, but itâ€™s so unlikely that itâ€™ll probably not happen in 10 lifetimes. So for all practical purposes, more wins are needed.</p>
<p>The big movements happen between 11 and 13 wins:</p>
<ul>
<li><p>With 11, itâ€™s unlikely but realistically possible</p></li>
<li><p>With 12, itâ€™s a toss up</p></li>
<li><p>With 13, itâ€™s likely</p></li>
</ul>
<p>This basically aligns with what was observed in the sample of 10 seasons accounting for some sampling error. To demonstrate the mistake we would have been making by only using data from the 10 observed seasons, Iâ€™ve created an animation with the first 1,000 simulated seasons to show the law of large numbers at work.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">running_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(x)</span>
<span id="cb17-3">}</span>
<span id="cb17-4"></span>
<span id="cb17-5">probs_animated_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simulation_summary_results <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb17-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(total_wins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>),</span>
<span id="cb17-7">         season <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb17-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_wins =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(</span>
<span id="cb17-9">    total_wins,</span>
<span id="cb17-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(total_wins),</span>
<span id="cb17-11">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decreasing =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)),</span>
<span id="cb17-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">facets =</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{total_wins} win season"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb17-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs_made_finals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">running_mean</span>(made_finals),</span>
<span id="cb17-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated finals&lt;br&gt;probability: {scales::percent(probs_made_finals, accuracy = 0.1)}"</span>),</span>
<span id="cb17-15">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> total_wins) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb17-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> season, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> probs_made_finals)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(</span>
<span id="cb17-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label),</span>
<span id="cb17-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span>,</span>
<span id="cb17-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb17-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb17-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb17-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span></span>
<span id="cb17-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>),</span>
<span id="cb17-28">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb17-29">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>()</span>
<span id="cb17-30">                     ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>facets, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simulated season number"</span>,</span>
<span id="cb17-33">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probability of finals"</span>,</span>
<span id="cb17-34">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> socials) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>,</span>
<span id="cb17-36">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb17-37">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span>),</span>
<span id="cb17-38">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myriad Pro Regular"</span>),</span>
<span id="cb17-39">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>),</span>
<span id="cb17-40">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb17-41">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transition_reveal</span>(season)</span>
<span id="cb17-43"></span>
<span id="cb17-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">animate</span>(probs_animated_plot,</span>
<span id="cb17-45">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nframes =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb17-46">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.6</span>,</span>
<span id="cb17-47">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,</span>
<span id="cb17-48">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb17-49">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">device =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ragg_png"</span>,</span>
<span id="cb17-50">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end_pause =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2025-01-18-how-many-wins-do-nrl-teams-need-to-make-the-finals/index_files/figure-html/unnamed-chunk-16-1.gif" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If youâ€™ve taken statistics classes at uni youâ€™ll probably have come across a similar idea to this with coin flips or finding pi. Basically, the average of a small group of numbers varies a lot, but stabilises as the sample gets larger. This is why we generally donâ€™t want to infer things about a population based only on a small sample, we might just be interpreting the early variation before the stable number (that converges on the true value) is found. The finals probability for each win count in the animation doesnâ€™t really become stable until around 250 seasons. Making inferences after only 10 seasons (like using the data we had) would have given us an unreliable estimate.</p>
<p>In summary, Monte Carlo simulations offer a practical way to estimate things (like finals probabilities in the NRL) when the calculations become mathematically complex or the sample of available data is relatively small.</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>National Rugby Leagueâ†©ï¸Ž</p></li>
<li id="fn2"><p>If anyone knows if / how this can be done, let me know!â†©ï¸Ž</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://www.mitchhenderson.dev/posts/2025-01-18-how-many-wins-do-nrl-teams-need-to-make-the-finals/</guid>
  <pubDate>Sun, 26 Jan 2025 13:00:00 GMT</pubDate>
</item>
<item>
  <title>Exploring Catapultâ€™s running imbalance data</title>
  <dc:creator>Mitch Henderson</dc:creator>
  <link>https://www.mitchhenderson.dev/posts/2021-02-04-exploring-catapults-running-symmetry-data.html</link>
  <description><![CDATA[ 





<p>An interesting metric available in the <a href="https://www.catapultsports.com/">Catapult</a> system is running imbalance.</p>
<p>Catapultâ€™s <em>Openfield</em> software offers running symmetry metrics that try to quantify the load imbalance between the right and left leg when running. Detailed information about the running symmetry metrics and how to set them up is available in the <a href="https://support.catapultsports.com/hc/en-us/articles/360001044935-How-to-Detect-Running-Symmetry-Metrics#h_69f950e0-c678-4257-8fac-a490c3493122">Catapult Support documentation</a>.</p>
<p>The documentation claims the practical applications of running symmetry metrics include:</p>
<ul>
<li><strong>Rehabilitation</strong> - See changes over time as the athlete improves during the process of rehabilitation</li>
<li><strong>Return to Play</strong> - Use Running Symmetry as an objective return to play marker</li>
<li><strong>Athlete Screening</strong> - Use Running Symmetry on a weekly basis to identify changes in running mechanics</li>
</ul>
<p>Running imbalance (%), arguably the most general running symmetry metric, is defined by Catapult as:</p>
<blockquote class="blockquote">
<p>â€œAverage percentage load difference between left and right legs, across all Running Symmetry Series/Efforts. A negative running imbalance % is indicative of an x% additional load on the left side (where x is the running imbalance value). A positive running imbalance % is indicative of an x% additional load on the right side (where x is the running imbalance value).â€</p>
</blockquote>
<p>Whilst I do have concerns about some of the measurement properties of this metric and donâ€™t currently use it in practice for these reasons, I wanted to explore the data and see what itâ€™s telling me. This post will show you how to export the data from <em>Openfield Cloud</em>, and visualise it using <a href="https://cran.r-project.org/">R</a> and <a href="https://rstudio.com/">RStudio</a>.</p>
<p><img src="https://www.mitchhenderson.dev/img/left_vs_right.png" class="img-fluid"></p>
<p><em>The full un-separated code is available at the end of this post for anyone looking to copy it into their script.</em></p>
<section id="step-1-export-from-openfield-cloud" class="level1">
<h1>Step 1 | Export from Openfield Cloud</h1>
<p>First thing to do is follow the steps outlined in the <a href="https://support.catapultsports.com/hc/en-us/articles/360001044935-How-to-Detect-Running-Symmetry-Metrics#h_69f950e0-c678-4257-8fac-a490c3493122">Catapult Support documentation</a> to set up running symmetry metrics.</p>
<p>For a reason beyond my knowledge, when you perform a bulk export from Openfield Cloud with â€˜All Parametersâ€™ selected (when choosing a parameter group), you get an inconsistent number of columns in the <code>.csv</code> exports (<em>if anyone knows why this might be, Iâ€™m interested to know!</em>). This causes issues when we try to import and join the data into one data frame (<em>i.e.&nbsp;table of data</em>) in R.</p>
<p>To remedy this, we need to create a parameter group to <strong>lock</strong> the columns that we want in our exports (ensuring a consistent export format).</p>
<section id="create-a-parameter-group" class="level3">
<h3 class="anchored" data-anchor-id="create-a-parameter-group">Create a parameter group</h3>
<p>After logging into Openfield Cloud, press <em>Settings</em></p>
<p><img src="https://www.mitchhenderson.dev/img/OF-settings.JPG" class="img-fluid"></p>
<p>Select <em>Parameters</em> in the sidebar, then <em>Parameter Groups</em> in the top bar.</p>
<p><img src="https://www.mitchhenderson.dev/img/OF-parameters.JPG" class="img-fluid"></p>
<p>Now we need to <em>Add new</em>.</p>
<p><img src="https://www.mitchhenderson.dev/img/OF-addnew.JPG" class="img-fluid"></p>
<p>We can give the group weâ€™re creating a name (<em>Iâ€™m calling mine â€œImbalanceâ€</em>) and select the metrics weâ€™re interested in (<em>Iâ€™m only selecting â€œDateâ€ and â€œRunning Imbalanceâ€</em>). Then we click the orange <em>Add Parameter Group</em> at the bottom of the window to save our new group.</p>
<p><img src="https://www.mitchhenderson.dev/img/OF-imbalancegroup.JPG" class="img-fluid"></p>
</section>
<section id="select-sessions-to-export" class="level3">
<h3 class="anchored" data-anchor-id="select-sessions-to-export">Select sessions to export</h3>
<p>The <em>Activities</em> bar on the left of screen can be used to select multiple sessions that weâ€™re interested in exporting data for. Using the click buttons on the right on the bar, we can select one or more years, months, days, or activities to export (<em>Iâ€™ve selected all of 2021 below</em>).</p>
<p><img src="https://www.mitchhenderson.dev/img/OF-sessionselect.JPG" class="img-fluid"></p>
<p>When more than one activity is selected, a green <em>Bulk Export CTRs</em> button will become available in the top right of screen (also showing how many activities have been selected). Click on it.</p>
<p><img src="https://www.mitchhenderson.dev/img/OF-bulkexport.JPG" class="img-fluid"></p>
<p>This will bring up a window allowing us to select some options for our exports. The only things we need to do is select our newly created parameter group (<em>Iâ€™m selecting â€œImbalanceâ€ below</em>) and enter the email youâ€™d like the links for the exports to go to. Then select <em>Export Bulk CTR</em>.</p>
<p><img src="https://www.mitchhenderson.dev/img/OF-email.JPG" class="img-fluid"></p>
</section>
<section id="download-exports" class="level3">
<h3 class="anchored" data-anchor-id="download-exports">Download exports</h3>
<p>Youâ€™ll then shortly receive one or more emails (depending on how many activities, and therefore data, youâ€™re exporting) from <strong>Openfield Web</strong> with links to download <code>.zip</code> folders containing the exports.</p>
<p><img src="https://www.mitchhenderson.dev/img/openfield-web-emails.JPG" class="img-fluid"></p>
</section>
</section>
<section id="step-2-import-into-rstudio" class="level1">
<h1>Step 2 | Import into RStudio</h1>
<p>Save all of your exports (keep them in <code>.csv</code> format) in a folder within your working directory (you can check your working directory in R or RStudio by running <code>getwd()</code> and you can change it with <code>setwd()</code>, but Iâ€™d recommend creating a <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">project</a> so itâ€™s set for you). Iâ€™ve called my folder <em>â€œExportsâ€</em>.</p>
<section id="load-packages" class="level3">
<h3 class="anchored" data-anchor-id="load-packages">Load packages</h3>
<p>Open RStudio, and create a new R script (I recommend saving it with an appropriate name straight away).</p>
<p>Below are the packages weâ€™ll need for this process. Iâ€™ve already installed them, so Iâ€™m only loading them here (and have commented out the installation commands at the top), but if you havenâ€™t previously installed them then youâ€™ll need to delete the hashtags at the beginning of the lines and run the top parts first (<em>only needs to be done once</em>). The install might take a while (<em>minutes, not hours</em>), and you might need to follow some prompts in the R console (bottom left window of RStudio) for the process to fully complete.</p>
<p>Note that Iâ€™m using a Windows computer (hence the <code>device = "win"</code> component of the code). I believe R works much better with fonts on Macs and this part of that line isnâ€™t required (<code>extrafont::loadfonts()</code> should work, <em>Iâ€™m interested to know if anyone reading is using a Mac</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lubridate)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggtext)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span></code></pre></div>
</div>
</section>
<section id="import-files" class="level3">
<h3 class="anchored" data-anchor-id="import-files">Import files</h3>
<p>Now, assuming you have a folder of your exports in your working directory (<em>I have all mine in a folder called â€œExportsâ€</em>), we can use a combination of the <code>read_csv()</code> and <code>list.files()</code> functions to:</p>
<ul>
<li>Import all files within your folder that include <code>.csv</code> in their filename into RStudio at once</li>
<li>Skip the first 9 lines (which is metadata we donâ€™t need)</li>
<li>Join them all together and call this data frame â€œ<code>data</code>â€</li>
<li>Filter away any period-level data so only activity-level rows remains (i.e.&nbsp;session totals)</li>
</ul>
<p>Weâ€™ll also <code>select()</code> only the <code>Date</code>, <code>Player Name</code>, and <code>Running Imbalance</code> columns (all others are discarded), and use <code>mutate()</code> with <code>dmy()</code> to tell R that our <code>Date</code> variable should be in a date format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exports"</span>),</span>
<span id="cb2-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.csv"</span>, </span>
<span id="cb2-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">skip =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Period Name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb2-8">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Player Name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb2-9">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Running Imbalance</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmy</span>(Date))</span></code></pre></div>
</div>
<p>For everyone following along that uses the Catapult system and can access their teamâ€™s data, the code above is whatâ€™s required to import all your data into R. <em>For those that just want to follow along with some dummy data in the same format, you can click <a href="https://drive.google.com/uc?export=download&amp;id=1yU34CWCPi-iq06OfCDwz65jFU7PiwBAC">here</a> to download my example <code>.csv</code> file</em>.</p>
<p>For privacy reasons, Iâ€™ll continue the tutorial using the dummy data contained in my <code>.csv</code> file. Note that all code from Step 3 onwards works on data imported either way (i.e.&nbsp;from either your own Openfield exports (method above) or my example <code>.csv</code> (method below)).</p>
<p>The import for the <code>.csv</code> file is much simpler:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"example_running_imbalance_data.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmy</span>(Date))</span></code></pre></div>
</div>
<p>The first 6 rows of data (251 rows, 3 columns in total) look like this:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Date</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Player Name</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Running Imbalance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2020-07-06</td>
<td style="text-align: center;">Player Q</td>
<td style="text-align: center;">0.94264</td>
</tr>
<tr class="even">
<td style="text-align: center;">2020-07-06</td>
<td style="text-align: center;">Player Q</td>
<td style="text-align: center;">-1.23166</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2020-07-07</td>
<td style="text-align: center;">Player Q</td>
<td style="text-align: center;">0.87172</td>
</tr>
<tr class="even">
<td style="text-align: center;">2020-07-10</td>
<td style="text-align: center;">Player Q</td>
<td style="text-align: center;">-0.88351</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2020-07-13</td>
<td style="text-align: center;">Player Q</td>
<td style="text-align: center;">-0.90294</td>
</tr>
<tr class="even">
<td style="text-align: center;">2020-07-13</td>
<td style="text-align: center;">Player Q</td>
<td style="text-align: center;">-0.24748</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="step-3-visualise-using-ggplot2" class="level1">
<h1>Step 3 | Visualise using {ggplot2}</h1>
<p>Itâ€™s beyond the scope of this post to go into full details of what each part of this <code>ggplot2</code> code is doing (I have done this for a previous post where <a href="https://www.mitchhenderson.org/2020/04/how-sports-scientists-can-use-ggplot2-in-r-to-make-better-visualisations/">I built a more sophisticated chart step-by-step for those interested</a>).</p>
<p>In an attempt to avoid telling you all to just <em>â€œdraw the rest of the damn owlâ€</em>, Iâ€™ll heavily comment my code so the purpose of all major functions are clear (<a href="https://knowyourmeme.com/memes/how-to-draw-an-owl">context for the owl meme reference</a>).</p>
<p><img src="https://www.mitchhenderson.dev/img/owl.jpg" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create an object called min_date representing the minimum value in my `Date` column</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Same thing for max_date with maximum value</span></span>
<span id="cb4-3"></span>
<span id="cb4-4">min_date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Date)</span>
<span id="cb4-5">max_date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Date)</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We're taking the object called `data` and creating a ggplot with `Date` on the x-axis and</span></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># `Running Imbalance` on the y-axis</span></span>
<span id="cb4-9"></span>
<span id="cb4-10">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Running Imbalance</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-12">  </span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Put a coloured rectangle that spans the width of the plot, and from -5% to 5% on the y-axis. </span></span>
<span id="cb4-14">  </span>
<span id="cb4-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rect"</span>, </span>
<span id="cb4-16">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> min_date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> max_date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb4-17">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#3A86FF"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-18">  </span>
<span id="cb4-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a text string that says "Left / Right side bias" with an arrow in the specified location.  </span></span>
<span id="cb4-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> min_date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.5</span>, </span>
<span id="cb4-21">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Left side bias "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'\u2193'</span>)), </span>
<span id="cb4-22">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey45"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Segoe UI"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-23">  </span>
<span id="cb4-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> min_date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, </span>
<span id="cb4-25">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Right side bias "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'\u2191'</span>)), </span>
<span id="cb4-26">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey45"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Segoe UI"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-27">  </span>
<span id="cb4-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Facet the chart so each player in the `Player Name` column will have their own chart</span></span>
<span id="cb4-29">  </span>
<span id="cb4-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Player Name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-31">  </span>
<span id="cb4-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a horizontal line through the middle of each chart </span></span>
<span id="cb4-33">  </span>
<span id="cb4-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-35">  </span>
<span id="cb4-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add dots that represent each data point</span></span>
<span id="cb4-37">  </span>
<span id="cb4-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-39">  </span>
<span id="cb4-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add a smoothed conditional mean line through the data points to aid the eye in seeing patterns.</span></span>
<span id="cb4-41">  </span>
<span id="cb4-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#F72585"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-43">  </span>
<span id="cb4-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove x axis title; add chart title, subtitle, caption, and y-axis title</span></span>
<span id="cb4-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note the {ggtext} package allows us to use a little HTML to get coloured text!</span></span>
<span id="cb4-46">  </span>
<span id="cb4-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Running Imbalance (%)**"</span>, </span>
<span id="cb4-48">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running symmetry metrics can be used to monitor changes in running mechanics"</span>, </span>
<span id="cb4-49">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session running imbalance **values** and </span></span>
<span id="cb4-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">       &lt;span style = 'color:#F72585;'&gt;**trends**&lt;/span&gt; </span></span>
<span id="cb4-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">       in relation to &lt;span style = 'color:#3A86FF;'&gt;**normal variation**&lt;/span&gt;</span></span>
<span id="cb4-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">     between players"</span>,</span>
<span id="cb4-53">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data: Catapult Vector GPS Units"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-54">  </span>
<span id="cb4-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Give the chart a particular look using themes and theme options.</span></span>
<span id="cb4-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I've removed unnecessary parts, changed the font, and made some parts bold.</span></span>
<span id="cb4-57">  </span>
<span id="cb4-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Segoe UI"</span>),</span>
<span id="cb4-60">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-61">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-62">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb4-63">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb4-64">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-65">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>),</span>
<span id="cb4-66">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-67">  </span>
<span id="cb4-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save the output in our working directory.  </span></span>
<span id="cb4-69">  </span>
<span id="cb4-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left_vs_right.png"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.75</span>)</span></code></pre></div>
</div>
<p><img src="https://www.mitchhenderson.dev/img/left_vs_right.png" class="img-fluid"></p>
<p>And thatâ€™s it! Let me know if you have any questions or want me to clarify anything. Very interested to hear your ideas about running symmetry / imbalance data and how it can be best visualised / presented.</p>
<p>If the interest is there, I can do a video walkthrough of this process (similar to my others on <a href="https://www.youtube.com/watch?v=VSrGkZgFP1E&amp;ab_channel=MitchHenderson">constructing a ggplot</a> and <a href="https://www.youtube.com/watch?v=N0DCRqqSKPw&amp;t=41s&amp;ab_channel=MitchHenderson">tidying data</a>).</p>
<p><strong>Keep up to date with anything new from me on <a href="https://twitter.com/mitchhendo_">my Twitter</a>.</strong></p>
<p><br></p>
<p>Cheers,</p>
<p>Mitch</p>
<p><br></p>
<p><em>Thumbnail from <a href="https://www.catapultsports.com/">Catapult</a></em></p>
</section>
<section id="full-code" class="level1">
<h1>Full code</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load packages -----------------------------------------------------------</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lubridate)</span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggtext)</span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb5-7"></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import ------------------------------------------------------------------</span></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Full import method using your own exports from Openfield â†“</span></span>
<span id="cb5-11"></span>
<span id="cb5-12">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb5-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exports"</span>),</span>
<span id="cb5-14">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.csv"</span>, </span>
<span id="cb5-15">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">skip =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Period Name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb5-19">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Player Name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb5-20">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Running Imbalance</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmy</span>(Date))</span>
<span id="cb5-22"></span>
<span id="cb5-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import method using my `.csv` file that can be downloaded on my post â†“</span></span>
<span id="cb5-24"></span>
<span id="cb5-25">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"example_running_imbalance_data.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmy</span>(Date))</span>
<span id="cb5-27"></span>
<span id="cb5-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualise -------------------------------------------------------------------</span></span>
<span id="cb5-29"></span>
<span id="cb5-30">min_date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Date)</span>
<span id="cb5-31">max_date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Date)</span>
<span id="cb5-32"></span>
<span id="cb5-33"></span>
<span id="cb5-34">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Running Imbalance</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rect"</span>, </span>
<span id="cb5-37">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> min_date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> max_date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb5-38">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#3A86FF"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> min_date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.5</span>, </span>
<span id="cb5-40">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Left side bias "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'\u2193'</span>)), </span>
<span id="cb5-41">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey45"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Segoe UI"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> min_date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, </span>
<span id="cb5-43">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Right side bias "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'\u2191'</span>)), </span>
<span id="cb5-44">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey45"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Segoe UI"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Player Name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#F72585"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Running Imbalance (%)**"</span>, </span>
<span id="cb5-50">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running symmetry metrics can be used to monitor changes in running mechanics"</span>, </span>
<span id="cb5-51">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session running imbalance **values** and </span></span>
<span id="cb5-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">       &lt;span style = 'color:#F72585;'&gt;**trends**&lt;/span&gt; </span></span>
<span id="cb5-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">       in relation to &lt;span style = 'color:#3A86FF;'&gt;**normal variation**&lt;/span&gt;</span></span>
<span id="cb5-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">     between players"</span>,</span>
<span id="cb5-55">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data: Catapult Vector GPS Units"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Segoe UI"</span>),</span>
<span id="cb5-58">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-59">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-60">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb5-61">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb5-62">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-63">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>),</span>
<span id="cb5-64">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left_vs_right.png"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.75</span>)</span></code></pre></div>
</div>


</section>

 ]]></description>
  <guid>https://www.mitchhenderson.dev/posts/2021-02-04-exploring-catapults-running-symmetry-data.html</guid>
  <pubDate>Tue, 09 Feb 2021 13:00:00 GMT</pubDate>
</item>
<item>
  <title>Visualising Apple Health data |Guest post by Heidi Thornton</title>
  <dc:creator>Heidi Thornton</dc:creator>
  <link>https://www.mitchhenderson.dev/posts/2020-05-19_heidi-post.html</link>
  <description><![CDATA[ 





<p><img src="https://www.mitchhenderson.dev/img/Applehealth.jpg" class="img-fluid"></p>
<p>As sports scientists during the COVID-19 shutdown, we have limited ways of determining adherence to training programs (completed within govenment guidelines of course!).</p>
<p>Data from smart watches provide practitioners with <em>basic measures</em> that can be used as a <em>rough guide</em> to quantify training over this period (when using the more sophisticated technologies isnâ€™t possible).</p>
<p>Although the reliability and validity data of these devices arenâ€™t widely available, they provide basic metrics such as total distance, duration, heart rate, and energy burnt etc.</p>
<p>In this post Iâ€™ll run through how to:</p>
<ul>
<li>export this data without an <a href="https://en.wikipedia.org/wiki/Application_programming_interface">API</a></li>
<li>run some some basic analysis</li>
<li>manipulate and visualise the data using <code>dplyr</code> &amp; <code>ggplot</code></li>
</ul>
<p>You can find presentation slides covering all content and the full code at the end of the post.</p>
<p><br></p>
<section id="accessing-apple-health-data" class="level1">
<h1>Accessing Apple Health data</h1>
<p><img src="https://www.mitchhenderson.dev/img/Steps.png" class="img-fluid"></p>
<section id="step-1" class="level2">
<h2 class="anchored" data-anchor-id="step-1">Step 1</h2>
<p>Open the Apple Health app on your phone, then <strong>summary page</strong> at the top right, then tap the circle showing the first letter of your first name on the top right (left figure above).</p>
</section>
<section id="step-2" class="level2">
<h2 class="anchored" data-anchor-id="step-2">Step 2</h2>
<p>Slide down and tap â€˜Export All Health Dataâ€™ (middle figure).</p>
</section>
<section id="step-3" class="level2">
<h2 class="anchored" data-anchor-id="step-3">Step 3</h2>
<p>The export takes up to a few minutes, then a page to email or message it will pop up. Email this file to yourself and download it.</p>
<p>If you donâ€™t have an Apple watch and want to use my data, you can <a href="https://drive.google.com/uc?export=download&amp;id=1ExH8l_OZq84S6jsY26vP8fmemX6YmYIh">download my <code>.xml</code> file here</a>.</p>
<p><br></p>
</section>
</section>
<section id="opening-apple-health-data" class="level1">
<h1>Opening Apple Health data</h1>
<p>You can open the <code>.zip</code> folder directly using R, however for this project Iâ€™ll manually extract the file within the folder named <code>apple_health_export</code>.</p>
<p>Inside, thereâ€™ll be 2 files. For our purposes, you only need the <strong>export</strong> file.</p>
<p>Iâ€™ve made a new folder that houses all files, and this is where my working directly will be set. In Rstudio, Iâ€™ll create an R script and load the packages I need. If you donâ€™t have these packages installed use <code>install.packages("packagename")</code> before loading them with <code>library()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"XML"</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"methods"</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lubridate"</span>)</span></code></pre></div>
</div>
</section>
<section id="why-do-this-in-r" class="level1">
<h1>Why do this in R?</h1>
<p><img src="https://www.mitchhenderson.dev/img/R.png" class="img-fluid"></p>
<p><br></p>
<section id="r-is-reproducible-microsoft-excel-is-not" class="level3">
<h3 class="anchored" data-anchor-id="r-is-reproducible-microsoft-excel-is-not">R is reproducible | Microsoft Excel is not</h3>
<p>We could simply export the raw data into Excel and manipulate / visualise it there, but R isnâ€™t that difficult, and there are lots of resources out there to help learn it.</p>
<p>Have the <strong>end game</strong> in mind.</p>
<p><br></p>
</section>
</section>
<section id="import-the-data-into-r" class="level1">
<h1>Import the data into R</h1>
<p>The file format (XML; Extensible Markup Language) is quite easy to work with in R using the <code>XML</code> package.</p>
<p>If you have multiple <code>.xml</code> files you can use a loop to access them all - Iâ€™ll only be using one file for this example and itâ€™s saved in my working directory.</p>
<p>First, we need to make an object that Iâ€™ll call <code>xml</code> and view itâ€™s contents using <code>summary(xml)</code>.</p>
<p><br></p>
<div class="cell" data-paged.print="false">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">xml <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmlParse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"heidi-thornton_apple-data.xml"</span>))</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(xml)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$nameCounts

       Record       Workout MetadataEntry    ExportDate    HealthData 
       200264           202            70             1             1 
           Me 
            1 

$numNodes
[1] 200539</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="view-the-data" class="level1">
<h1>View the data</h1>
<p>Iâ€™m interested in the workout data. We can open this using <code>xmlAttrsToDataFrame()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">df_workout <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  XML<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmlAttrsToDataFrame</span>(xml[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//Workout"</span>])[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)]</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df_workout, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View the top 5 rows of data</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           workoutActivityType          duration    totalDistance
1 HKWorkoutActivityTypeRunning 42.44751790364583 8.01347998046875
2 HKWorkoutActivityTypeCycling 45.69051513671875    11.1736796875
3   HKWorkoutActivityTypeOther 45.29886474609375 3.60589990234375
4   HKWorkoutActivityTypeOther 58.97060139973959  1.7677099609375
5 HKWorkoutActivityTypeRunning 39.55806477864584 4.17927978515625
  totalEnergyBurned                   endDate
1          2041.792 2019-11-23 06:40:35 +1000
2          1096.208 2019-11-24 06:56:26 +1000
3             836.8 2019-11-24 15:27:41 +1000
4           736.384 2019-11-25 05:27:23 +1000
5 669.4400000000001 2019-11-25 16:42:42 +1000</code></pre>
</div>
</div>
<p>Here we have the session type and the respective data for each day (in need of some cleaning).</p>
<p><br></p>
</section>
<section id="plotting-data" class="level1">
<h1>Plotting data</h1>
<p>Lets start by filtering so only the data I want to plot remains.</p>
<p>We will use <code>%&gt;%</code> (pipes) from the <code>tidyverse</code> package perform this as itâ€™s much quicker than making new data frames for each plot, and weâ€™ll plot the data using <code>ggplot2</code>.</p>
<p><br></p>
<section id="daily-running-sessions" class="level3">
<h3 class="anchored" data-anchor-id="daily-running-sessions">Daily running sessions</h3>
<div class="cell" data-layout-align="center" data-font.size="10">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">df_workout <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-2">  </span>
<span id="cb6-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change data types (i.e. distance to m not km, numeric) </span></span>
<span id="cb6-4">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb6-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">workoutActivityType =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(workoutActivityType),</span>
<span id="cb6-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">totalDistance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(totalDistance))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb6-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(duration),</span>
<span id="cb6-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">endDate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(endDate)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-9">  </span>
<span id="cb6-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Only running sessions- depending on watch the name may differ</span></span>
<span id="cb6-11">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(workoutActivityType <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HKWorkoutActivityTypeRunning"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-12">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(endDate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-03-23"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># only after shut down</span></span>
<span id="cb6-13"></span>
<span id="cb6-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create ggplot    </span></span>
<span id="cb6-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span> endDate, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> totalDistance)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#5ab4ac'</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not exactly periodised, but it's better than nothing...."</span>,</span>
<span id="cb6-18">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Daily running volume (m)"</span>,</span>
<span id="cb6-19">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>,</span>
<span id="cb6-20">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_date</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_breaks =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"7 days"</span>,</span>
<span id="cb6-22">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_labels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%b %d"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb6-26">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb6-27">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb6-28">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb6-29">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-05-19_heidi-post_files/figure-html/Distance Graph ouput-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now we have our first plot showing my running over the days after the COVID shut down.</p>
<p><br></p>
</section>
<section id="weekly-running-volume" class="level3">
<h3 class="anchored" data-anchor-id="weekly-running-volume">Weekly running volume</h3>
<p>We need to manipulate the data a bit more to get the weekly running volume.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">df_workout <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-2">  </span>
<span id="cb7-3">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb7-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">workoutActivityType =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(workoutActivityType),</span>
<span id="cb7-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">totalDistance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(totalDistance))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb7-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">endDate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(endDate),</span>
<span id="cb7-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">week =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isoweek</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ymd</span>(endDate))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add week column</span></span>
<span id="cb7-8">  </span>
<span id="cb7-9">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(workoutActivityType <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HKWorkoutActivityTypeRunning"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-10">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(endDate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-03-23"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-11">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(week) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summarise by week (starts week in 1st jan)</span></span>
<span id="cb7-12">  </span>
<span id="cb7-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> week, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> totalDistance)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#5ab4ac'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cardinal rule of training: Be consistent"</span>,</span>
<span id="cb7-16">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total distance (m) across annual weeks"</span>,</span>
<span id="cb7-17">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Annual Week"</span>,</span>
<span id="cb7-18">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb7-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb7-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb7-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb7-26">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-05-19_heidi-post_files/figure-html/Weekly volume-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="energy-consumption" class="level3">
<h3 class="anchored" data-anchor-id="energy-consumption">Energy consumption</h3>
<p>I want to know energy consumption by <strong>activity type</strong>. To extract a clean name for this we need to do some string manipulation using the <code>str_sub()</code> function from the <code>stringr</code> package (part of the <code>tidyverse</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">df_workout <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-2">  </span>
<span id="cb8-3">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb8-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">workoutActivityType =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(workoutActivityType),</span>
<span id="cb8-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">totalDistance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(totalDistance)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb8-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">totalEnergyBurned =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(totalEnergyBurned)),</span>
<span id="cb8-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">endDate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(endDate), </span>
<span id="cb8-8">      </span>
<span id="cb8-9">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add week column</span></span>
<span id="cb8-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">week =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isoweek</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ymd</span>(endDate)), </span>
<span id="cb8-11">      </span>
<span id="cb8-12">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># new column- text after 22nd character</span></span>
<span id="cb8-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(workoutActivityType, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-14">  </span>
<span id="cb8-15">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter out cycling</span></span>
<span id="cb8-16">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(endDate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-03-23"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> Type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Running'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Other'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-17">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(week) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-18"></span>
<span id="cb8-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> week, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> totalEnergyBurned, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Type)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_dodge</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Type) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Weekly energy consumption (kj) by activity type"</span>,</span>
<span id="cb8-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'Other' sessions include weights or walking"</span>,</span>
<span id="cb8-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb8-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Annual week"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb8-30">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb8-31">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb8-32">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-33">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb8-34">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb8-35">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-05-19_heidi-post_files/figure-html/energy graph-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="general-activity-data" class="level3">
<h3 class="anchored" data-anchor-id="general-activity-data">General activity data</h3>
<p>Lets move on from workout data and import â€˜Recordâ€™ data. This one will take a while to load.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">df_record <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  XML<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmlAttrsToDataFrame</span>(xml[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//Record"</span>]) [<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)]</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># See data types available in record</span></span>
<span id="cb9-4">  df_record <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(type, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Include text after the 25th character</span></span>
<span id="cb9-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Type) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> distinct</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Type
1            DietaryWater
2                  Height
3                BodyMass
4               HeartRate
5               StepCount
6  DistanceWalkingRunning
7       BasalEnergyBurned
8      ActiveEnergyBurned
9          FlightsClimbed
10       RestingHeartRate
11 HeadphoneAudioExposure
12          SleepAnalysis</code></pre>
</div>
</div>
<p>If you want to view the full dataset, you can use <code>view(df_record)</code>.</p>
<p><br></p>
</section>
<section id="step-data-manipulation" class="level3">
<h3 class="anchored" data-anchor-id="step-data-manipulation">Step data manipulation</h3>
<p>This one isnâ€™t exactly useful for athletes - this is more for my own interest of my activity (or lack of) during the COVID shut down.</p>
<p>I am replicating a plot created by <a href="https://twitter.com/taraskaduk">Taras Kaduk</a> on his blog post titled <a href="https://taraskaduk.com/2019/03/23/apple-health/">Analyze and visualize your iPhoneâ€™s Health app data in R</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">df_record <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-2">  </span>
<span id="cb11-3">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb11-4">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename type by removing that text </span></span>
<span id="cb11-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(type, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HKQuantityTypeIdentifier"</span>), </span>
<span id="cb11-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(value)),</span>
<span id="cb11-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date.character</span>(startDate),</span>
<span id="cb11-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weekday =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wday</span>(Date), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Day of week</span></span>
<span id="cb11-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hour</span>(startDate)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Need to use the factor date</span></span>
<span id="cb11-10">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'StepCount'</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> Date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-03-23"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-11">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Date, weekday, hour) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Summarise by date, weekday and hour</span></span>
<span id="cb11-12">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sum steps over ^^</span></span>
<span id="cb11-13">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(weekday, hour) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now summarise by weekday and hour  </span></span>
<span id="cb11-14">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Take mean steps over ^^</span></span>
<span id="cb11-15">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">between</span>(hour,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filtering to include between 6am - 9pm</span></span>
<span id="cb11-16"> </span>
<span id="cb11-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hour, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> weekday,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grey40'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>comma,</span>
<span id="cb11-20">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grey95'</span>,</span>
<span id="cb11-21">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#008FD5'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb11-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>),</span>
<span id="cb11-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 AM"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"9 AM"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Midday"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3PM"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 PM"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_reverse</span>(</span>
<span id="cb11-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>),</span>
<span id="cb11-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sunday"</span>,</span>
<span id="cb11-28">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Monday"</span>,</span>
<span id="cb11-29">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tuesday"</span>,</span>
<span id="cb11-30">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wednesday"</span>,</span>
<span id="cb11-31">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Thursday"</span>,</span>
<span id="cb11-32">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Friday"</span>,</span>
<span id="cb11-33">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saturday"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb11-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not a lot of activity at the moment...."</span>,</span>
<span id="cb11-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Step count heatmap by hour by day"</span>,</span>
<span id="cb11-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb11-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb11-43">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-05-19_heidi-post_files/figure-html/Step count plot by hour-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="heart-rate-data" class="level3">
<h3 class="anchored" data-anchor-id="heart-rate-data">Heart rate data</h3>
<p>One last one - we will plot HR across 2 days. I have added a colour scale for low (green) and high (red).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">df_record <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(type, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HKQuantityTypeIdentifier"</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename </span></span>
<span id="cb12-3">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(value)), </span>
<span id="cb12-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startDate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_datetime</span>(startDate),</span>
<span id="cb12-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date.character</span>(startDate)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb12-6">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HeartRate'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-7">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-04-03"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>  Date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-04-04"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-8">  </span>
<span id="cb12-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> startDate, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_gradient</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"springgreen3"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb12-13">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Heart rate"</span>,</span>
<span id="cb12-14">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb12-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb12-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb12-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb12-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb12-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-05-19_heidi-post_files/figure-html/HR Graph-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="access-more-apple-health-info" class="level1">
<h1>Access more Apple Health info</h1>
<p>There are other data types available from Apple Health</p>
<div class="cell">
<pre class="apple cell-code"><code>df_record &lt;-   XML:::xmlAttrsToDataFrame(xml["//Record"])
df_activity &lt;- XML:::xmlAttrsToDataFrame(xml["//ActivitySummary"])
df_workout &lt;-  XML:::xmlAttrsToDataFrame(xml["//Workout"])
df_clinical &lt;- XML:::xmlAttrsToDataFrame(xml["//ClinicalRecord"])
df_location &lt;- XML:::xmlAttrsToDataFrame(xml["//Location"])</code></pre>
</div>
<p><br> <br></p>
<p>For more information on analysing Apple Health data, check out:</p>
<ul>
<li><p><a href="https://taraskaduk.com/2019/03/23/apple-health/">Analyze and visualize your iPhoneâ€™s Health app data in R</a> by <a href="https://twitter.com/taraskaduk">Taras Kaduk</a></p></li>
<li><p><a href="https://jeffjjohnston.github.io/rstudio/rmarkdown/2016/04/28/explore-your-apple-watch-heart-rate-data.html">Explore your Apple Watch heart rate data in R</a> by <a href="https://twitter.com/jeffj312">Jeff Johnston</a>.</p></li>
</ul>
<p><br> <br></p>
</section>
<section id="thanks-for-looking" class="level1">
<h1>Thanks for looking! ðŸ˜Š</h1>
<p>The presentation slides for this post can be viewed <a href="https://mitchhenderson.github.io/heidi-slides/Heidi-Presentation-Xaringan--2-.html">full screen</a> or embedded below.</p>
<p><br></p>
<div class="cell">
<iframe src="https://mitchhenderson.github.io/heidi-slides/Heidi-Presentation-Xaringan--2-.html" width="672" height="400px" data-external="1">
</iframe>
</div>
<p><br></p>
<p>If you want to learn more about R, there is some awesome work out there from fellow Aussies!</p>
<p><a href="http://sportstatisticsrsweet.rbind.io/">Alice Sweeting</a><br></p>
<p><a href="https://www.mitchhenderson.org/">Mitch Henderson</a><br></p>
<p><a href="https://www.jacquietran.com/">Jacquie Tran</a><br></p>
<p><br> <br></p>
<p><a href="https://twitter.com/heidithornton09?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false"><span class="citation" data-cites="heidithornton09">@heidithornton09</span></a></p>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>ðŸ“© <a href="mailto:heidi.thornton@goldcoastfc.com.au">heidi.thornton@goldcoastfc.com.au</a></p>
<p><br></p>
<p><em>Thumbnail image from <a href="https://www.apple.com/au/ios/health/">Apple.com</a></em></p>
<p><br></p>
</section>
<section id="full-code" class="level1">
<h1>Full code</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"XML"</span>)</span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"methods"</span>)</span>
<span id="cb14-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>)</span>
<span id="cb14-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lubridate"</span>)</span>
<span id="cb14-5"></span>
<span id="cb14-6">xml <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmlParse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"heidi-thornton_apple-data.xml"</span>))</span>
<span id="cb14-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(xml)</span>
<span id="cb14-8"></span>
<span id="cb14-9"></span>
<span id="cb14-10"></span>
<span id="cb14-11">df_workout <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  XML<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmlAttrsToDataFrame</span>(xml[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//Workout"</span>])[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)]</span>
<span id="cb14-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df_workout, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View the top 5 rows of data</span></span>
<span id="cb14-13"></span>
<span id="cb14-14"></span>
<span id="cb14-15"></span>
<span id="cb14-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Daily running chart</span></span>
<span id="cb14-17"></span>
<span id="cb14-18">df_workout <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-19">  </span>
<span id="cb14-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change data types (i.e. distance to m not km, numeric) </span></span>
<span id="cb14-21">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb14-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">workoutActivityType =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(workoutActivityType),</span>
<span id="cb14-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">totalDistance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(totalDistance))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb14-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(duration),</span>
<span id="cb14-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">endDate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(endDate)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb14-26">  </span>
<span id="cb14-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Only running sessions- depending on watch the name may differ</span></span>
<span id="cb14-28">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(workoutActivityType <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HKWorkoutActivityTypeRunning"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-29">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(endDate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-03-23"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># only after shut down</span></span>
<span id="cb14-30"></span>
<span id="cb14-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create ggplot    </span></span>
<span id="cb14-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span> endDate, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> totalDistance)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-33">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#5ab4ac'</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-34">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not exactly periodised, but it's better than nothing...."</span>,</span>
<span id="cb14-35">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Daily running volume (m)"</span>,</span>
<span id="cb14-36">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>,</span>
<span id="cb14-37">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-38">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_date</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_breaks =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"7 days"</span>,</span>
<span id="cb14-39">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_labels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%b %d"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-40">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-41">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-42">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-43">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-44">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb14-45">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb14-46">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span>
<span id="cb14-47"></span>
<span id="cb14-48"></span>
<span id="cb14-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Weekly running chart</span></span>
<span id="cb14-50"></span>
<span id="cb14-51">df_workout <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-52">  </span>
<span id="cb14-53">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb14-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">workoutActivityType =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(workoutActivityType),</span>
<span id="cb14-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">totalDistance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(totalDistance))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb14-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">endDate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(endDate),</span>
<span id="cb14-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">week =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isoweek</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ymd</span>(endDate))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add week column</span></span>
<span id="cb14-58">  </span>
<span id="cb14-59">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(workoutActivityType <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HKWorkoutActivityTypeRunning"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-60">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(endDate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-03-23"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-61">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(week) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summarise by week (starts week in 1st jan)</span></span>
<span id="cb14-62">  </span>
<span id="cb14-63"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> week, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> totalDistance)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#5ab4ac'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cardinal rule of training: Be consistent"</span>,</span>
<span id="cb14-66">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total distance (m) across annual weeks"</span>,</span>
<span id="cb14-67">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Annual Week"</span>,</span>
<span id="cb14-68">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-73">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-74">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb14-75">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb14-76">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span>
<span id="cb14-77"></span>
<span id="cb14-78"></span>
<span id="cb14-79"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Energy consumption (Other vs Running) chart</span></span>
<span id="cb14-80"></span>
<span id="cb14-81">df_workout <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-82">  </span>
<span id="cb14-83">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb14-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">workoutActivityType =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(workoutActivityType),</span>
<span id="cb14-85">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">totalDistance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(totalDistance)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb14-86">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">totalEnergyBurned =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(totalEnergyBurned)),</span>
<span id="cb14-87">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">endDate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(endDate), </span>
<span id="cb14-88">      </span>
<span id="cb14-89">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add week column</span></span>
<span id="cb14-90">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">week =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isoweek</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ymd</span>(endDate)), </span>
<span id="cb14-91">      </span>
<span id="cb14-92">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># new column- text after 22nd character</span></span>
<span id="cb14-93">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(workoutActivityType, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-94">  </span>
<span id="cb14-95">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter out cycling</span></span>
<span id="cb14-96">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(endDate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-03-23"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> Type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Running'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Other'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb14-97">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(week) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-98"></span>
<span id="cb14-99"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> week, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> totalEnergyBurned, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Type)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-100">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_dodge</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-101">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Type) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-102">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Weekly energy consumption (kj) by session type"</span>,</span>
<span id="cb14-103">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'Other' sessions include weights or walking"</span>,</span>
<span id="cb14-104">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb14-105">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Annual week"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-106">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-107">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-108">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-109">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb14-110">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-111">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-112">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb14-113">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb14-114">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb14-115">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span>
<span id="cb14-116"></span>
<span id="cb14-117"></span>
<span id="cb14-118"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract record data</span></span>
<span id="cb14-119"></span>
<span id="cb14-120">df_record <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  XML<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmlAttrsToDataFrame</span>(xml[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//Record"</span>]) [<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)]</span>
<span id="cb14-121"></span>
<span id="cb14-122"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># See data types available in record</span></span>
<span id="cb14-123">  df_record <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb14-124">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(type, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Include text after the 25th character</span></span>
<span id="cb14-125">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Type) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> distinct</span>
<span id="cb14-126">  </span>
<span id="cb14-127">  </span>
<span id="cb14-128">  </span>
<span id="cb14-129"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step count chart</span></span>
<span id="cb14-130">  </span>
<span id="cb14-131">df_record <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-132">  </span>
<span id="cb14-133">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb14-134">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename type by removing that text </span></span>
<span id="cb14-135">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(type, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HKQuantityTypeIdentifier"</span>), </span>
<span id="cb14-136">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(value)),</span>
<span id="cb14-137">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date.character</span>(startDate),</span>
<span id="cb14-138">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weekday =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wday</span>(Date), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Day of week</span></span>
<span id="cb14-139">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hour</span>(startDate)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Need to use the factor date</span></span>
<span id="cb14-140">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'StepCount'</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> Date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-03-23"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-141">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Date, weekday, hour) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Summarise by date, weekday and hour</span></span>
<span id="cb14-142">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sum steps over ^^</span></span>
<span id="cb14-143">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(weekday, hour) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now summarise by weekday and hour  </span></span>
<span id="cb14-144">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Take mean steps over ^^</span></span>
<span id="cb14-145">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">between</span>(hour,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filtering to include between 6am - 9pm</span></span>
<span id="cb14-146"> </span>
<span id="cb14-147"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> hour, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> weekday,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-148">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grey40'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-149">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>comma,</span>
<span id="cb14-150">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grey95'</span>,</span>
<span id="cb14-151">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#008FD5'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-152">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb14-153">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>),</span>
<span id="cb14-154">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 AM"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"9 AM"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Midday"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3PM"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 PM"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-155">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_reverse</span>(</span>
<span id="cb14-156">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>),</span>
<span id="cb14-157">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sunday"</span>,</span>
<span id="cb14-158">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Monday"</span>,</span>
<span id="cb14-159">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tuesday"</span>,</span>
<span id="cb14-160">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wednesday"</span>,</span>
<span id="cb14-161">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Thursday"</span>,</span>
<span id="cb14-162">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Friday"</span>,</span>
<span id="cb14-163">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saturday"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-164">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb14-165">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not a lot of activity at the moment...."</span>,</span>
<span id="cb14-166">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Step count heatmap by hour by day"</span>,</span>
<span id="cb14-167">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb14-168">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-169">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-170">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-171">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-172">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-173">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span>
<span id="cb14-174"></span>
<span id="cb14-175"></span>
<span id="cb14-176"></span>
<span id="cb14-177"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Heart rate chart</span></span>
<span id="cb14-178"></span>
<span id="cb14-179">df_record <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-180">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(type, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HKQuantityTypeIdentifier"</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename </span></span>
<span id="cb14-181">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(value)), </span>
<span id="cb14-182">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">startDate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_datetime</span>(startDate),</span>
<span id="cb14-183">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date.character</span>(startDate)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb14-184">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HeartRate'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-185">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-04-03"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>  Date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-04-04"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-186">  </span>
<span id="cb14-187"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> startDate, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-188">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-189">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_gradient</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"springgreen3"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-190">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb14-191">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Heart rate"</span>,</span>
<span id="cb14-192">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-193">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-194">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-195">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb14-196">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-197">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-198">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb14-199">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span>
<span id="cb14-200"></span>
<span id="cb14-201"></span>
<span id="cb14-202"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Other types of data from Apple Health</span></span>
<span id="cb14-203"></span>
<span id="cb14-204">df_record <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>   XML<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmlAttrsToDataFrame</span>(xml[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//Record"</span>])</span>
<span id="cb14-205">df_activity <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> XML<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmlAttrsToDataFrame</span>(xml[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//ActivitySummary"</span>])</span>
<span id="cb14-206">df_workout <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  XML<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmlAttrsToDataFrame</span>(xml[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//Workout"</span>])</span>
<span id="cb14-207">df_clinical <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> XML<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmlAttrsToDataFrame</span>(xml[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//ClinicalRecord"</span>])</span>
<span id="cb14-208">df_location <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> XML<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmlAttrsToDataFrame</span>(xml[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//Location"</span>])</span></code></pre></div>
</div>


</section>

 ]]></description>
  <guid>https://www.mitchhenderson.dev/posts/2020-05-19_heidi-post.html</guid>
  <pubDate>Mon, 18 May 2020 14:00:00 GMT</pubDate>
</item>
<item>
  <title>Making better visualisations using ggplot2 in R</title>
  <dc:creator>Mitch Henderson</dc:creator>
  <link>https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz.html</link>
  <description><![CDATA[ 





<blockquote class="blockquote">
<p>â€œThe ability to take dataâ€”to be able to understand it, to process it, to extract value from it, to visualize it, to communicate itâ€”thatâ€™s going to be a hugely important skill in the next decades, â€¦ because now we really do have essentially free and ubiquitous data. So the complimentary scarce factor is the ability to understand that data and extract value from it.â€</p>
<footer>
â€” Hal Varian, The McKinsey Quarterly, Jan 2009
</footer>
</blockquote>
<p>Great results and important messages from sports scientists and S&amp;C coaches are too often lost at the final and most important hurdle of the scientific process: <strong>communication</strong>.</p>
<p>A clear, considered, and engaging visualisation helps by presenting the data in a way thatâ€™s digestible to <strong>people</strong>, not just machines.</p>
<p>On the 13th April 2020, I tweeted a thread of visualisations that Iâ€™d made recreating the work of <a href="https://twitter.com/Worville">Tom Worville</a> of <a href="https://theathletic.co.uk/author/tom-worville/">The Athletic</a>.</p>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
</p><p>Inspired by the work of <a href="https://twitter.com/Worville?ref_src=twsrc%5Etfw"><span class="citation" data-cites="Worville">@Worville</span></a> showing <a href="https://twitter.com/LFC?ref_src=twsrc%5Etfw"><span class="citation" data-cites="LFC">@LFC</span></a>â€™s age profile over the past few seasons, I tried to recreate his charts for some other competition-winning ðŸ† teams over the last few years using <a href="https://twitter.com/hashtag/ggplot?src=hash&amp;ref_src=twsrc%5Etfw">#ggplot</a> in <a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a>. A thread.<br><br>1/6 <a href="https://t.co/F9m4oVbLG0">pic.twitter.com/F9m4oVbLG0</a></p>
<p></p>
<p>â€” Mitch Henderson (<span class="citation" data-cites="mitchhendo_">@mitchhendo_</span>) <a href="https://twitter.com/mitchhendo_/status/1249500020002316289?ref_src=twsrc%5Etfw">April 13, 2020</a></p>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>This post will take you through the process of how I generated this one:</p>
<p><img src="https://www.mitchhenderson.dev/img/foxes_peak-years.png" class="img-fluid"></p>
<p>The full code will be posted at the end, as throughout the post Iâ€™ll be going through parts of it bit by bit.</p>
<p>If youâ€™d prefer to watch me do it, this video shows me going through the whole process:</p>
<p><br></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/VSrGkZgFP1E" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
<p><br></p>
<section id="step-1-data-prep" class="level1">
<h1>Step 1 | Data prep</h1>
<section id="collate-the-data" class="level3">
<h3 class="anchored" data-anchor-id="collate-the-data">Collate the data</h3>
<p>The data that we will use needs to be in this format:</p>
<div class="cell" data-paged.print="true">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">player_name</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">percent_involvement</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">dob</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">arrival_at_team</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">reference_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Andrej Kramaric</td>
<td style="text-align: center;">0.0070175</td>
<td style="text-align: center;">19/06/1991</td>
<td style="text-align: center;">16/01/2015</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="even">
<td style="text-align: center;">Andy King</td>
<td style="text-align: center;">0.3105263</td>
<td style="text-align: center;">29/10/1988</td>
<td style="text-align: center;">1/07/2007</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Christian Fuchs</td>
<td style="text-align: center;">0.7926901</td>
<td style="text-align: center;">7/04/1986</td>
<td style="text-align: center;">1/07/2015</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="even">
<td style="text-align: center;">Daniel Amartey</td>
<td style="text-align: center;">0.0304094</td>
<td style="text-align: center;">21/12/1994</td>
<td style="text-align: center;">22/01/2016</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Danny Drinkwater</td>
<td style="text-align: center;">0.8868421</td>
<td style="text-align: center;">5/03/1990</td>
<td style="text-align: center;">20/01/2012</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="even">
<td style="text-align: center;">Danny Simpson</td>
<td style="text-align: center;">0.7631579</td>
<td style="text-align: center;">4/01/1987</td>
<td style="text-align: center;">30/08/2014</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Demarai Gray</td>
<td style="text-align: center;">0.0546784</td>
<td style="text-align: center;">28/06/1996</td>
<td style="text-align: center;">4/01/2016</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="even">
<td style="text-align: center;">Gokhan Inler</td>
<td style="text-align: center;">0.0567251</td>
<td style="text-align: center;">27/06/1984</td>
<td style="text-align: center;">19/08/2015</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Jamie Vardy</td>
<td style="text-align: center;">0.9160819</td>
<td style="text-align: center;">11/01/1987</td>
<td style="text-align: center;">1/07/2012</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="even">
<td style="text-align: center;">Jeffrey Schlupp</td>
<td style="text-align: center;">0.4055556</td>
<td style="text-align: center;">23/12/1992</td>
<td style="text-align: center;">1/07/2010</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Joe Dodoo</td>
<td style="text-align: center;">0.0058480</td>
<td style="text-align: center;">29/06/1995</td>
<td style="text-align: center;">1/08/2013</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="even">
<td style="text-align: center;">Kasper Schmeichel</td>
<td style="text-align: center;">1.0000000</td>
<td style="text-align: center;">5/11/1986</td>
<td style="text-align: center;">1/07/2011</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Leonardo Ulloa</td>
<td style="text-align: center;">0.2877193</td>
<td style="text-align: center;">26/07/1986</td>
<td style="text-align: center;">22/07/2014</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="even">
<td style="text-align: center;">Marc Albrighton</td>
<td style="text-align: center;">0.8038012</td>
<td style="text-align: center;">18/11/1989</td>
<td style="text-align: center;">1/07/2014</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Marcin Wasilewski</td>
<td style="text-align: center;">0.0885965</td>
<td style="text-align: center;">9/06/1980</td>
<td style="text-align: center;">17/09/2013</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="even">
<td style="text-align: center;">Nathan Dyer</td>
<td style="text-align: center;">0.0643275</td>
<td style="text-align: center;">29/11/1987</td>
<td style="text-align: center;">1/09/2015</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">N'Golo Kante</td>
<td style="text-align: center;">0.8836257</td>
<td style="text-align: center;">29/03/1991</td>
<td style="text-align: center;">3/08/2015</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="even">
<td style="text-align: center;">Ritchie De Laet</td>
<td style="text-align: center;">0.1921053</td>
<td style="text-align: center;">28/11/1988</td>
<td style="text-align: center;">1/07/2012</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Riyad Mahrez</td>
<td style="text-align: center;">0.8871345</td>
<td style="text-align: center;">21/02/1991</td>
<td style="text-align: center;">11/01/2014</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="even">
<td style="text-align: center;">Robert Huth</td>
<td style="text-align: center;">0.9210526</td>
<td style="text-align: center;">18/08/1984</td>
<td style="text-align: center;">1/07/2015</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Shinji Okazaki</td>
<td style="text-align: center;">0.6005848</td>
<td style="text-align: center;">16/04/1986</td>
<td style="text-align: center;">1/07/2015</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="even">
<td style="text-align: center;">Wes Morgan</td>
<td style="text-align: center;">1.0000000</td>
<td style="text-align: center;">21/01/1984</td>
<td style="text-align: center;">30/01/2012</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Yohan Benalouane</td>
<td style="text-align: center;">0.0198830</td>
<td style="text-align: center;">28/03/1987</td>
<td style="text-align: center;">3/08/2015</td>
<td style="text-align: center;">15/05/2016</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<ul>
<li>The <code>percent_involvement</code> column is a 0 - 1 number representing the percentage of minutes played for the season.</li>
<li>The <code>dob</code> column is each players date of birth.</li>
<li>The <code>arrival_at_team</code> column is the date the player joined the club.</li>
<li>The <code>reference_date</code> column is the date that you want to calculate age and time at the club from. In this circumstance, Iâ€™ve used the date of the last Premier League game of the 2015/16 season.</li>
</ul>
<p>I found Leicester Cityâ€™s data from 2015/16 at <a href="https://www.transfermarkt.com/">transfermarkt.com</a>.</p>
<p>Save this file as a <code>.csv</code> in your working directory.</p>
</section>
<section id="find-a-logo" class="level3">
<h3 class="anchored" data-anchor-id="find-a-logo">Find a logo</h3>
<p>Find your teamâ€™s logo online (preferably high resolution <code>.png</code> image with a transparent background), and save it into your working directory. I found this one on <a href="https://en.wikipedia.org/wiki/Leicester_City_F.C.">Leicester Cityâ€™s Wikipedia page</a>.</p>
<div style="width:200px; height:200px">
<p><img src="https://www.mitchhenderson.dev/img/leicester_logo.png" class="img-fluid" width="200"></p>
</div>
<p><br></p>
</section>
</section>
<section id="step-2-load-packages-and-import-data" class="level1">
<h1>Step 2 | Load packages and import data</h1>
<section id="r-packages" class="level3">
<h3 class="anchored" data-anchor-id="r-packages">R packages</h3>
<p>The below packages need to be loaded at the beginning of your R script. If this is the first time using any of these packages on your computer, make sure you install them first (e.g.&nbsp;<code>install.packages("package_name")</code>).</p>
<p>Using different fonts in R can be tricky, particularly on Windows machines (like I use). If you want to use a non-standard font like I have and youâ€™re unfamiliar with the setup, <a href="https://yjunechoe.github.io/posts/2021-06-24-setting-up-and-debugging-custom-fonts/" title="Setting up and debugging custom fonts">read this article by June Choe</a> that walks you through it.</p>
<p>Later in this post Iâ€™ll be using a font called â€œURWGeometricW03-Lightâ€ that I had to download online, youâ€™ll need to substitute this in the code to a font available to you for the code to work (or aquire this font).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lubridate)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggrepel)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggforce)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(scales)</span></code></pre></div>
</div>
</section>
<section id="add-metadata" class="level3">
<h3 class="anchored" data-anchor-id="add-metadata">Add metadata</h3>
<p>This is where we define what will end up being used for our title, subtitle, caption, and logo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Metadata ---------------------------------------------------------------</span></span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Title, subtitle, and legend</span></span>
<span id="cb2-4">team_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Leicester City"</span></span>
<span id="cb2-5">short_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Foxes"</span></span>
<span id="cb2-6">league <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"English Premier League"</span></span>
<span id="cb2-7">season <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2015/16"</span></span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption</span></span>
<span id="cb2-10">data_source <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transfermarkt.com"</span></span>
<span id="cb2-11">social_media_handle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@mitchhendo_"</span></span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Name of logo file within working directory</span></span>
<span id="cb2-14">logo_file_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"leicester_logo.png"</span></span></code></pre></div>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">Load data</h3>
<p>This section will read in the data from my file called <code>leicester_data.csv</code> in my working directory, and make it an object called <code>data</code>. Then we tell R what kind of data certain columns are (number, date, character etc), and calculate a few new columns based on the data within the file.</p>
<p>Iâ€™ve added comments to the code so itâ€™s easier to understand what each part is doing. Anything after a <code>#</code> is a comment which <strong>isnâ€™t</strong> executed as code. Comments are used for explaining your code to others or yourself in the future.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data import -------------------------------------------------------------</span></span>
<span id="cb3-2"></span>
<span id="cb3-3">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data_leicester.csv'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read in this file</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dob =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmy</span>(dob),</span>
<span id="cb3-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recognise this column as a date</span></span>
<span id="cb3-7">    </span>
<span id="cb3-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reference_date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmy</span>(reference_date),</span>
<span id="cb3-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recognise this column as a date</span></span>
<span id="cb3-10">    </span>
<span id="cb3-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrival_at_team =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmy</span>(arrival_at_team),</span>
<span id="cb3-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recognise this column as a date</span></span>
<span id="cb3-13">    </span>
<span id="cb3-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> (reference_date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> dob) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span>,</span>
<span id="cb3-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new column that calculates each players age at the reference date</span></span>
<span id="cb3-16">    </span>
<span id="cb3-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_at_arrival =</span> (arrival_at_team <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> dob) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span>,</span>
<span id="cb3-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new column that calculates each players age at arrival to the club</span></span>
<span id="cb3-19">    </span>
<span id="cb3-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time_with_team =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(arrival_at_team <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> reference_date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Years &gt; 1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Years &lt; 1"</span>))</span>
<span id="cb3-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new column that determines whether a player has been at the club for longer than a year or not</span></span>
<span id="cb3-22">  )</span></code></pre></div>
</div>
<p><br></p>
</section>
</section>
<section id="step-3-create-plot" class="level1">
<h1>Step 3 | Create plot</h1>
<section id="prep" class="level3">
<h3 class="anchored" data-anchor-id="prep">Prep</h3>
<p>Before we create the <code>ggplot</code> object, we need to define a few things to make the plotting easier.</p>
<p>Firstly, we define what colours we want for the dots and call this object <code>year_colours</code> (using hex code to specify colours), and also define a series of numbers that weâ€™ll call <code>index</code> which will allow us to plot the trailing lines behind the players (showing how long theyâ€™ve been at the club for).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colours of the dots</span></span>
<span id="cb4-2">year_colours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Years &gt; 1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#25ABF8"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Years &lt; 1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CE3A6C"</span>)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This vector is needed to draw the trailing lines showing how long a player has been at the club</span></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Don't change this unless you know what you're doing</span></span>
<span id="cb4-6">index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
</section>
<section id="plotting" class="level3">
<h3 class="anchored" data-anchor-id="plotting">Plotting</h3>
<p>Now the fun begins. Letâ€™s start building the plot.</p>
<p>Weâ€™ll start by using the <code>ggplot</code> function and telling it that the data weâ€™re using is from the <code>data</code> object we created earlier. The <code>aes()</code> function is used to specify what parts of our data are going to be used in the plot, so we say the x-axis will be our <code>age</code> column and the y-axis will be our <code>percent_involvement</code> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz_files/figure-html/plot1-1.png" class="img-fluid figure-img" width="696"></p>
</figure>
</div>
</div>
</div>
<p>This is essentially the canvas that weâ€™ll build from.</p>
<p>Next weâ€™ll add our dots using the <code>geom_point()</code> function. The way the <code>ggplot</code> function works is by adding layers (called geoms) to the â€œcanvasâ€. We add layers or aspects to the plot by adding them with a <code>+</code>.</p>
<p>Note Iâ€™ve added another column from our dataset to specify the colour in the <code>aes()</code> function for the <code>geom_point()</code> layer <strong>only</strong>. The data specified in the <code>aes()</code> function at the top is applied to <strong>all</strong> geoms below unless specified otherwise within the an individual geom. Iâ€™ve also manually adjusted the size of the dots, which is done outside the <code>aes()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> time_with_team), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz_files/figure-html/plot2-1.png" class="img-fluid figure-img" width="696"></p>
</figure>
</div>
</div>
</div>
<p>Next weâ€™ll add our title, subtitle, x-axis title, caption, and legend title using the <code>labs()</code> function. All of the information for these has been defined in <strong>Step 2</strong> where we added the metadata.</p>
<p>The <code>paste0()</code> function essentially allows us to paste together objects weâ€™ve defined using code and written character strings to create a character string that dynamically changes based on different inputs (e.g.&nbsp;<code>paste0(team_name, " | Squad Age Profile")</code> becomes â€œLeicester City | Squad Age Profileâ€). You can use the dynamic titles like I have, or you could simply write what you want each part to say within quotation marks like I did for the x-axis title.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> time_with_team), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age"</span>,</span>
<span id="cb7-4">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(team_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Squad Age Profile"</span>), </span>
<span id="cb7-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(league, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Season "</span>, season),</span>
<span id="cb7-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(social_media_handle, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Data: "</span>, data_source),</span>
<span id="cb7-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time at "</span>, short_name))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz_files/figure-html/plot3-1.png" class="img-fluid figure-img" width="696"></p>
</figure>
</div>
</div>
</div>
<p>Next weâ€™ll fix up our y-axis by using the <code>scale_y_continuous()</code> function to give it a proper title, use percent scales, and tell it where to break up the axis ticks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> time_with_team), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age"</span>,</span>
<span id="cb8-4">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(team_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Squad Age Profile"</span>), </span>
<span id="cb8-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(league, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Season "</span>, season),</span>
<span id="cb8-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(social_media_handle, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Data: "</span>, data_source),</span>
<span id="cb8-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time at "</span>, short_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Share of minutes played"</span>, </span>
<span id="cb8-9">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb8-10">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz_files/figure-html/plot4-1.png" class="img-fluid figure-img" width="696"></p>
</figure>
</div>
</div>
</div>
<p>Then we set our axis limits using the <code>expand_limits()</code>, and x-axis breaks using <code>scale_x_continuous()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> time_with_team), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age"</span>,</span>
<span id="cb9-4">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(team_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Squad Age Profile"</span>), </span>
<span id="cb9-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(league, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Season "</span>, season),</span>
<span id="cb9-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(social_media_handle, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Data: "</span>, data_source),</span>
<span id="cb9-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time at "</span>, short_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Share of minutes played"</span>, </span>
<span id="cb9-9">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb9-10">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz_files/figure-html/plot5-1.png" class="img-fluid figure-img" width="696"></p>
</figure>
</div>
</div>
</div>
<p>We can add our colours to the dots that we specified earlier by using <code>scale_colour_manual()</code> and specifying the values to be our object <code>year_colours</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> time_with_team), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age"</span>,</span>
<span id="cb10-4">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(team_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Squad Age Profile"</span>), </span>
<span id="cb10-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(league, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Season "</span>, season),</span>
<span id="cb10-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(social_media_handle, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Data: "</span>, data_source),</span>
<span id="cb10-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time at "</span>, short_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Share of minutes played"</span>, </span>
<span id="cb10-9">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb10-10">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> year_colours)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz_files/figure-html/plot6-1.png" class="img-fluid figure-img" width="696"></p>
</figure>
</div>
</div>
</div>
<p>One of the most fun parts of using <code>ggplot</code> in my mind is playing around with the theme. There are a number of <a href="https://www.datanovia.com/en/blog/ggplot-themes-gallery/">basic themes built into ggplot</a> aswell as some more fun ones that can be added with packages like <a href="https://github.com/hrbrmstr/hrbrthemes">hrbrthemes</a>, <a href="https://github.com/ricardo-bion/ggtech">ggtech</a> (which has themes to imitate <em>AirBnb</em>, <em>Facebook</em>, <em>Google</em> and <em>Twitter</em>â€™s style), and <a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/">ggthemes</a> (which has themes to imitate plots made by <em>FiveThirtyEight</em>, <em>Wall Street Journal</em>, and <em>The Economist</em> among others). The best page Iâ€™ve found for exploring different themes and theme packages is <a href="https://rfortherestofus.com/2019/08/themes-to-improve-your-ggplot-figures/"><em>Themes to improve your ggplot figures</em> by rfortherestofus.com</a>. You can also modify themes any way youâ€™d like using the <code>theme()</code> function which weâ€™ll get to next.</p>
<p>Iâ€™ll use <code>theme_minimal()</code> as a base.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> time_with_team), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age"</span>,</span>
<span id="cb11-4">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(team_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Squad Age Profile"</span>), </span>
<span id="cb11-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(league, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Season "</span>, season),</span>
<span id="cb11-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(social_media_handle, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Data: "</span>, data_source),</span>
<span id="cb11-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time at "</span>, short_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Share of minutes played"</span>, </span>
<span id="cb11-9">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb11-10">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> year_colours) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz_files/figure-html/plot7-1.png" class="img-fluid figure-img" width="696"></p>
</figure>
</div>
</div>
</div>
<p>You can adjust any aspect of the theme manually with <code>theme()</code>. The flexibility and power of this is almost endless, and far beyond the scope of this post, but carefully look through all the arguments Iâ€™ve written and youâ€™ll be able to understand a lot of it.</p>
<p>Remember that you will likely need to change the font (the <code>family</code> argument within <code>theme()</code>) where mine says <code>URWGeometricW03-Light</code> to a font available to you (fonts can be tricky, <a href="https://yjunechoe.github.io/posts/2021-06-24-setting-up-and-debugging-custom-fonts/" title="Setting up and debugging custom fonts">this post will help</a>).</p>
<p>Feel free to play around with these to get a different look or to get a better understanding of what theyâ€™re doing. For example, you could change the colour of the plot area (i.e.&nbsp;where the data goes) by changing the hex code in <code>plot.background = element_rect(fill = "#141622")</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> time_with_team), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age"</span>,</span>
<span id="cb12-4">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(team_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Squad Age Profile"</span>), </span>
<span id="cb12-5">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(league, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Season "</span>, season),</span>
<span id="cb12-6">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(social_media_handle, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Data: "</span>, data_source),</span>
<span id="cb12-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time at "</span>, short_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Share of minutes played"</span>, </span>
<span id="cb12-9">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb12-10">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> year_colours) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, </span>
<span id="cb12-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb12-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>),</span>
<span id="cb12-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>, </span>
<span id="cb12-18">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>,</span>
<span id="cb12-19">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb12-20">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>),</span>
<span id="cb12-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb12-22">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'solid'</span>,</span>
<span id="cb12-23">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray30"</span>),</span>
<span id="cb12-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, </span>
<span id="cb12-25">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb12-26">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb12-27">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb12-28">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, </span>
<span id="cb12-29">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb12-30">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb12-31">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb12-32">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb12-33">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb12-34">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb12-35">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb12-36">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, </span>
<span id="cb12-37">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb12-38">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb12-39">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb12-40">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb12-41">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb12-42">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb12-43">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb12-44">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb12-45">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb12-46">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb12-47">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb12-48">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb12-49">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb12-50">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz_files/figure-html/plot8-1.png" class="img-fluid figure-img" width="696"></p>
</figure>
</div>
</div>
</div>
<p>Next we add the player name labels to the plot using <code>geom_text_repel()</code> from the <code>ggrepel</code> package we loaded earlier. Itâ€™s a handy function that basically ensures labels donâ€™t overlap each other.</p>
<p>The order in which we add things from here starts to matter now. Like I mentioned earlier, becuase <code>ggplot</code>â€™s are built with layers, you need to think about what order you want them laid. I want the labels to be added on top of the dots, so Iâ€™ll put this geom right after <code>geom_point()</code>.</p>
<p>Again, in my code below, this geom uses the â€œURWGeometricW03-Lightâ€ font I got online. Youâ€™ll need to download this font or change it to a font available to you.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> time_with_team), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> player_name), </span>
<span id="cb13-4">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.25</span>, </span>
<span id="cb13-5">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb13-6">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age"</span>,</span>
<span id="cb13-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(team_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Squad Age Profile"</span>), </span>
<span id="cb13-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(league, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Season "</span>, season),</span>
<span id="cb13-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(social_media_handle, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Data: "</span>, data_source),</span>
<span id="cb13-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time at "</span>, short_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Share of minutes played"</span>, </span>
<span id="cb13-13">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb13-14">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> year_colours) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, </span>
<span id="cb13-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb13-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>),</span>
<span id="cb13-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>, </span>
<span id="cb13-22">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>,</span>
<span id="cb13-23">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb13-24">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>),</span>
<span id="cb13-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb13-26">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'solid'</span>,</span>
<span id="cb13-27">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray30"</span>),</span>
<span id="cb13-28">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, </span>
<span id="cb13-29">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb13-30">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb13-31">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb13-32">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, </span>
<span id="cb13-33">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb13-34">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb13-35">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb13-36">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb13-37">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb13-38">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb13-39">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb13-40">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, </span>
<span id="cb13-41">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb13-42">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb13-43">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb13-44">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb13-45">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb13-46">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb13-47">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb13-48">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb13-49">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb13-50">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb13-51">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb13-52">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb13-53">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb13-54">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz_files/figure-html/plot9-1.png" class="img-fluid figure-img" width="696"></p>
</figure>
</div>
</div>
</div>
<p>The plot is really starting to look like the finished product now.</p>
<p>We need to add the trailing white lines with the <code>geom_link()</code> function from the <code>ggforce</code> package weâ€™ve loaded. Again, the order is important here, we want the lines to be beneath the dots so we add this geom <strong>before</strong> <code>geom_point()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_link</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age_at_arrival,</span>
<span id="cb14-3">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> age,</span>
<span id="cb14-4">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> percent_involvement,</span>
<span id="cb14-5">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat</span>(index)), </span>
<span id="cb14-6">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb14-7">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"round"</span>,</span>
<span id="cb14-8">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> time_with_team), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> player_name), </span>
<span id="cb14-11">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.25</span>, </span>
<span id="cb14-12">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb14-13">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age"</span>,</span>
<span id="cb14-15">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(team_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Squad Age Profile"</span>), </span>
<span id="cb14-16">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(league, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Season "</span>, season),</span>
<span id="cb14-17">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(social_media_handle, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Data: "</span>, data_source),</span>
<span id="cb14-18">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time at "</span>, short_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Share of minutes played"</span>, </span>
<span id="cb14-20">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb14-21">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> year_colours) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, </span>
<span id="cb14-26">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb14-27">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>),</span>
<span id="cb14-28">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>, </span>
<span id="cb14-29">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>,</span>
<span id="cb14-30">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb14-31">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>),</span>
<span id="cb14-32">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb14-33">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'solid'</span>,</span>
<span id="cb14-34">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray30"</span>),</span>
<span id="cb14-35">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, </span>
<span id="cb14-36">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb14-37">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb14-38">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb14-39">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, </span>
<span id="cb14-40">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb14-41">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb14-42">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb14-43">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb14-44">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb14-45">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb14-46">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb14-47">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, </span>
<span id="cb14-48">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb14-49">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb14-50">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb14-51">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb14-52">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb14-53">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb14-54">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb14-55">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb14-56">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb14-57">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb14-58">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb14-59">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb14-60">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb14-61">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz_files/figure-html/plot10-1.png" class="img-fluid figure-img" width="696"></p>
</figure>
</div>
</div>
</div>
<p>Now we need to add the green <em>Peak Years</em> area and label. This is done with <code>annotate()</code> which manually adds things like shapes, text, or images. Weâ€™re adding a shape (<code>rect</code> for rectangle) and text, so we add 2 <code>annotate()</code> geoms before anything else (because we want them to be at the deepest layer), and provide it the coordinates so it knows where to put them.</p>
<p>Once again, change <code>family</code> if you donâ€™t have the â€œURWGeometricW03-Lightâ€ font.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rect"</span>, </span>
<span id="cb15-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb15-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>,</span>
<span id="cb15-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>,</span>
<span id="cb15-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb15-7">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb15-8">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mediumseagreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, </span>
<span id="cb15-10">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.5</span>, </span>
<span id="cb15-11">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>, </span>
<span id="cb15-12">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peak Years"</span>, </span>
<span id="cb15-13">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mediumseagreen"</span>, </span>
<span id="cb15-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, </span>
<span id="cb15-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>,</span>
<span id="cb15-16">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_link</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age_at_arrival,</span>
<span id="cb15-18">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> age,</span>
<span id="cb15-19">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> percent_involvement,</span>
<span id="cb15-20">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat</span>(index)), </span>
<span id="cb15-21">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb15-22">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"round"</span>,</span>
<span id="cb15-23">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> time_with_team), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> player_name), </span>
<span id="cb15-26">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.25</span>, </span>
<span id="cb15-27">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb15-28">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age"</span>,</span>
<span id="cb15-30">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(team_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Squad Age Profile"</span>), </span>
<span id="cb15-31">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(league, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Season "</span>, season),</span>
<span id="cb15-32">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(social_media_handle, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Data: "</span>, data_source),</span>
<span id="cb15-33">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time at "</span>, short_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Share of minutes played"</span>, </span>
<span id="cb15-35">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb15-36">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> year_colours) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, </span>
<span id="cb15-41">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb15-42">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>),</span>
<span id="cb15-43">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>, </span>
<span id="cb15-44">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>,</span>
<span id="cb15-45">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb15-46">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>),</span>
<span id="cb15-47">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb15-48">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'solid'</span>,</span>
<span id="cb15-49">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray30"</span>),</span>
<span id="cb15-50">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, </span>
<span id="cb15-51">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb15-52">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb15-53">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb15-54">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, </span>
<span id="cb15-55">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb15-56">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb15-57">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb15-58">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb15-59">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb15-60">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb15-61">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb15-62">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, </span>
<span id="cb15-63">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb15-64">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb15-65">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb15-66">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb15-67">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb15-68">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb15-69">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb15-70">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb15-71">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb15-72">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb15-73">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb15-74">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb15-75">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb15-76">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz_files/figure-html/plot11-1.png" class="img-fluid figure-img" width="696"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="step-4-saving-and-adding-the-logo" class="level1">
<h1>Step 4 | Saving and adding the logo</h1>
<section id="saving-the-plot" class="level3">
<h3 class="anchored" data-anchor-id="saving-the-plot">Saving the plot</h3>
<p>To save the plot as a high resolution image we can use the <code>ggsave()</code> function. Here I save the file with a dynamic name that equates to the current date, underscore, short_name (object we created in Step 2 = â€œFoxesâ€), underscore, peak-years.png. So for me, today as I write this post, the file would be saved as <code>2020-04-24_Foxes_peak-years.png</code>, but that would be different if I was to save it on a different day or with a different <code>short_name</code> object.</p>
<p>The <code>dpi</code> argument is <em>dots per inch</em> and allows you to set the resolution. Higher is better but also means a larger file size (<code>dpi = 600</code> is good).</p>
<p>The file will be saved into your working directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.Date</span>(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, short_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_peak-years.png"</span>), </span>
<span id="cb16-2">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.75</span>,</span>
<span id="cb16-3">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.25</span>,</span>
<span id="cb16-4">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>)</span></code></pre></div>
</div>
</section>
<section id="adding-the-logo" class="level3">
<h3 class="anchored" data-anchor-id="adding-the-logo">Adding the logo</h3>
<p>Thereâ€™s a number of ways to add a logo to a <code>ggplot</code> object, but they can be quite complex. The best one Iâ€™ve found is using a custom function that <a href="https://twitter.com/thomas_mock">Thomas Mock</a> created and posted on <a href="https://themockup.netlify.app/posts/2019-01-09-add-a-logo-to-your-plot/">his blog</a>.</p>
<p>It reads in the plot as a <code>.png</code> image, the logo as another <code>.png</code> image, and puts the logo in a corner you specify at a size you specify.</p>
<p>The only parts of this you <strong>may</strong> want to modify are the sections below <code>### ONLY MODIFY FROM HERE DOWN</code>. You can choose which corner you want the logo in, what is the file name you saved the plot image, and the size of the logo (bigger number = smaller logo).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add logo function -------------------------------------------------------</span></span>
<span id="cb17-2"></span>
<span id="cb17-3">add_logo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(plot_path, logo_path, logo_position, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">logo_scale =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>){</span>
<span id="cb17-4">  </span>
<span id="cb17-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Requires magick R Package https://github.com/ropensci/magick</span></span>
<span id="cb17-6">  </span>
<span id="cb17-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Useful error message for logo position</span></span>
<span id="cb17-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>logo_position <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top right"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top left"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom right"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom left"</span>)) {</span>
<span id="cb17-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Error Message: Uh oh! Logo Position not recognized</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Try: logo_positon = 'top left', 'top right', 'bottom left', or 'bottom right'"</span>)</span>
<span id="cb17-10">  }</span>
<span id="cb17-11">  </span>
<span id="cb17-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># read in raw images</span></span>
<span id="cb17-13">  plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(plot_path)</span>
<span id="cb17-14">  logo_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(logo_path)</span>
<span id="cb17-15">  </span>
<span id="cb17-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get dimensions of plot for scaling</span></span>
<span id="cb17-17">  plot_height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_info</span>(plot)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>height</span>
<span id="cb17-18">  plot_width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_info</span>(plot)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>width</span>
<span id="cb17-19">  </span>
<span id="cb17-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># default scale to 1/10th width of plot</span></span>
<span id="cb17-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Can change with logo_scale</span></span>
<span id="cb17-22">  logo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_scale</span>(logo_raw, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(plot_width<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>logo_scale))</span>
<span id="cb17-23">  </span>
<span id="cb17-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get width of logo</span></span>
<span id="cb17-25">  logo_width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_info</span>(logo)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>width</span>
<span id="cb17-26">  logo_height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_info</span>(logo)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>height</span>
<span id="cb17-27">  </span>
<span id="cb17-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set position of logo</span></span>
<span id="cb17-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position starts at 0,0 at top left</span></span>
<span id="cb17-30">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using 0.01 for 1% - aesthetic padding</span></span>
<span id="cb17-31">  </span>
<span id="cb17-32">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (logo_position <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top right"</span>) {</span>
<span id="cb17-33">    x_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> plot_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> logo_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_width</span>
<span id="cb17-34">    y_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_height</span>
<span id="cb17-35">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (logo_position <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top left"</span>) {</span>
<span id="cb17-36">    x_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_width</span>
<span id="cb17-37">    y_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_height</span>
<span id="cb17-38">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (logo_position <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom right"</span>) {</span>
<span id="cb17-39">    x_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> plot_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> logo_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_width</span>
<span id="cb17-40">    y_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> plot_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> logo_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_height</span>
<span id="cb17-41">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (logo_position <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom left"</span>) {</span>
<span id="cb17-42">    x_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_width</span>
<span id="cb17-43">    y_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> plot_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> logo_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_height</span>
<span id="cb17-44">  }</span>
<span id="cb17-45">  </span>
<span id="cb17-46">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compose the actual overlay</span></span>
<span id="cb17-47">  magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_composite</span>(plot, logo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">offset =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+"</span>, x_pos, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+"</span>, y_pos))</span>
<span id="cb17-48">  </span>
<span id="cb17-49">}</span>
<span id="cb17-50"></span>
<span id="cb17-51"></span>
<span id="cb17-52"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### ONLY MODIFY FROM HERE DOWN</span></span>
<span id="cb17-53"></span>
<span id="cb17-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Choose logo, position, and size (bigger number = smaller logo) ----------</span></span>
<span id="cb17-55"></span>
<span id="cb17-56">plot_with_logo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_logo</span>(</span>
<span id="cb17-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot_path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.Date</span>(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, short_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_peak-years.png"</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># url or local file for the plot</span></span>
<span id="cb17-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">logo_path =</span> logo_file_name, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># url or local file for the logo</span></span>
<span id="cb17-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">logo_position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top right"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># choose a corner</span></span>
<span id="cb17-60">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 'top left', 'top right', 'bottom left' or 'bottom right'</span></span>
<span id="cb17-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">logo_scale =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb17-62">)</span>
<span id="cb17-63"></span>
<span id="cb17-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save the image and write to working directory</span></span>
<span id="cb17-65">magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(plot_with_logo, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.Date</span>(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, short_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_peak-years.png"</span>))</span></code></pre></div>
</div>
<p>Thisâ€™ll save over the file we created with a new file thatâ€™s the plot image with the logo added like this:</p>
<p><img src="https://www.mitchhenderson.dev/img/foxes_peak-years.png" class="img-fluid"></p>
<p>And thatâ€™s it! Let me know if you have any questions or want me to clarify anything.</p>
<p><strong>Keep up to date with anything new from me on <a href="https://twitter.com/mitchhendo_">my Twitter</a>.</strong></p>
<p>Cheers,</p>
<p>Mitch</p>
</section>
</section>
<section id="full-code" class="level1">
<h1><strong>Full code</strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lubridate)</span>
<span id="cb18-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggrepel)</span>
<span id="cb18-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggforce)</span>
<span id="cb18-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb18-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(scales)</span>
<span id="cb18-7"></span>
<span id="cb18-8"></span>
<span id="cb18-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Metadata ---------------------------------------------------------------</span></span>
<span id="cb18-10"></span>
<span id="cb18-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Title, subtitle, and legend</span></span>
<span id="cb18-12">team_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Leicester City"</span></span>
<span id="cb18-13">short_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Foxes"</span></span>
<span id="cb18-14">league <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"English Premier League"</span></span>
<span id="cb18-15">season <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2015/16"</span></span>
<span id="cb18-16"></span>
<span id="cb18-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption</span></span>
<span id="cb18-18">data_source <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transfermarkt.com"</span></span>
<span id="cb18-19">social_media_handle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@mitchhendo_"</span></span>
<span id="cb18-20"></span>
<span id="cb18-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Name of logo file within working directory</span></span>
<span id="cb18-22">logo_file_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"leicester_logo.png"</span></span>
<span id="cb18-23"></span>
<span id="cb18-24"></span>
<span id="cb18-25"></span>
<span id="cb18-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data import -------------------------------------------------------------</span></span>
<span id="cb18-27"></span>
<span id="cb18-28">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data_leicester.csv'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read in this file</span></span>
<span id="cb18-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb18-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dob =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmy</span>(dob),</span>
<span id="cb18-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recognise this column as a date</span></span>
<span id="cb18-32">    </span>
<span id="cb18-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reference_date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmy</span>(reference_date),</span>
<span id="cb18-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recognise this column as a date</span></span>
<span id="cb18-35">    </span>
<span id="cb18-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrival_at_team =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dmy</span>(arrival_at_team),</span>
<span id="cb18-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recognise this column as a date</span></span>
<span id="cb18-38">    </span>
<span id="cb18-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> (reference_date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> dob) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span>,</span>
<span id="cb18-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new column that calculates each players age at the reference date</span></span>
<span id="cb18-41">    </span>
<span id="cb18-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_at_arrival =</span> (arrival_at_team <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> dob) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span>,</span>
<span id="cb18-43">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new column that calculates each players age at arrival to the club</span></span>
<span id="cb18-44">    </span>
<span id="cb18-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time_with_team =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(arrival_at_team <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> reference_date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Years &gt; 1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Years &lt; 1"</span>))</span>
<span id="cb18-46">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new column that determines whether a player has been at the club for longer than a year or not</span></span>
<span id="cb18-47">  )</span>
<span id="cb18-48"></span>
<span id="cb18-49"></span>
<span id="cb18-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualise ---------------------------------------------------------------</span></span>
<span id="cb18-51"></span>
<span id="cb18-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colours of the dots</span></span>
<span id="cb18-53">year_colours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Years &gt; 1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#25ABF8"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Years &lt; 1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CE3A6C"</span>)</span>
<span id="cb18-54"></span>
<span id="cb18-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This vector is needed to draw the trailing lines showing how long a player has been at the club</span></span>
<span id="cb18-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Don't change this unless you know what you're doing</span></span>
<span id="cb18-57">index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb18-58"></span>
<span id="cb18-59"></span>
<span id="cb18-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Construct plot</span></span>
<span id="cb18-61"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_involvement)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rect"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mediumseagreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, </span>
<span id="cb18-64">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.5</span>, </span>
<span id="cb18-65">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>, </span>
<span id="cb18-66">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peak Years"</span>, </span>
<span id="cb18-67">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mediumseagreen"</span>, </span>
<span id="cb18-68">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, </span>
<span id="cb18-69">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>,</span>
<span id="cb18-70">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_link</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age_at_arrival, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> percent_involvement, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat</span>(index)), </span>
<span id="cb18-72">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb18-73">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"round"</span>,</span>
<span id="cb18-74">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> time_with_team), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> player_name), </span>
<span id="cb18-77">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.25</span>, </span>
<span id="cb18-78">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb18-79">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Age"</span>,</span>
<span id="cb18-81">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(team_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Squad Age Profile"</span>), </span>
<span id="cb18-82">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(league, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Season "</span>, season),</span>
<span id="cb18-83">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(social_media_handle, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | Data: "</span>, data_source),</span>
<span id="cb18-84">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time at "</span>, short_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-85">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Share of minutes played"</span>, </span>
<span id="cb18-86">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb18-87">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-89">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> year_colours) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, </span>
<span id="cb18-93">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb18-94">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>),</span>
<span id="cb18-95">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>, </span>
<span id="cb18-96">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#141622"</span>,</span>
<span id="cb18-97">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb18-98">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>),</span>
<span id="cb18-99">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb18-100">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'solid'</span>,</span>
<span id="cb18-101">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray30"</span>),</span>
<span id="cb18-102">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, </span>
<span id="cb18-103">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb18-104">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb18-105">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb18-106">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, </span>
<span id="cb18-107">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb18-108">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb18-109">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb18-110">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb18-111">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb18-112">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb18-113">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb18-114">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, </span>
<span id="cb18-115">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Century Gothic"</span>),</span>
<span id="cb18-116">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb18-117">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb18-118">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb18-119">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb18-120">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb18-121">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb18-122">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb18-123">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb18-124">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb18-125">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb18-126">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb18-127">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"URWGeometricW03-Light"</span>, </span>
<span id="cb18-128">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-129">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.Date</span>(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, short_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_peak-years.png"</span>),  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>)</span>
<span id="cb18-130"></span>
<span id="cb18-131"></span>
<span id="cb18-132"></span>
<span id="cb18-133"></span>
<span id="cb18-134"></span>
<span id="cb18-135"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add logo function -------------------------------------------------------</span></span>
<span id="cb18-136"></span>
<span id="cb18-137">add_logo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(plot_path, logo_path, logo_position, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">logo_scale =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>){</span>
<span id="cb18-138">  </span>
<span id="cb18-139">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Requires magick R Package https://github.com/ropensci/magick</span></span>
<span id="cb18-140">  </span>
<span id="cb18-141">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Useful error message for logo position</span></span>
<span id="cb18-142">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>logo_position <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top right"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top left"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom right"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom left"</span>)) {</span>
<span id="cb18-143">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Error Message: Uh oh! Logo Position not recognized</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Try: logo_positon = 'top left', 'top right', 'bottom left', or 'bottom right'"</span>)</span>
<span id="cb18-144">  }</span>
<span id="cb18-145">  </span>
<span id="cb18-146">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># read in raw images</span></span>
<span id="cb18-147">  plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(plot_path)</span>
<span id="cb18-148">  logo_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(logo_path)</span>
<span id="cb18-149">  </span>
<span id="cb18-150">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get dimensions of plot for scaling</span></span>
<span id="cb18-151">  plot_height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_info</span>(plot)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>height</span>
<span id="cb18-152">  plot_width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_info</span>(plot)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>width</span>
<span id="cb18-153">  </span>
<span id="cb18-154">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># default scale to 1/10th width of plot</span></span>
<span id="cb18-155">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Can change with logo_scale</span></span>
<span id="cb18-156">  logo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_scale</span>(logo_raw, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(plot_width<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>logo_scale))</span>
<span id="cb18-157">  </span>
<span id="cb18-158">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get width of logo</span></span>
<span id="cb18-159">  logo_width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_info</span>(logo)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>width</span>
<span id="cb18-160">  logo_height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_info</span>(logo)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>height</span>
<span id="cb18-161">  </span>
<span id="cb18-162">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set position of logo</span></span>
<span id="cb18-163">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position starts at 0,0 at top left</span></span>
<span id="cb18-164">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using 0.01 for 1% - aesthetic padding</span></span>
<span id="cb18-165">  </span>
<span id="cb18-166">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (logo_position <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top right"</span>) {</span>
<span id="cb18-167">    x_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> plot_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> logo_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_width</span>
<span id="cb18-168">    y_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_height</span>
<span id="cb18-169">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (logo_position <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top left"</span>) {</span>
<span id="cb18-170">    x_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_width</span>
<span id="cb18-171">    y_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_height</span>
<span id="cb18-172">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (logo_position <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom right"</span>) {</span>
<span id="cb18-173">    x_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> plot_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> logo_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_width</span>
<span id="cb18-174">    y_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> plot_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> logo_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_height</span>
<span id="cb18-175">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (logo_position <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom left"</span>) {</span>
<span id="cb18-176">    x_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_width</span>
<span id="cb18-177">    y_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> plot_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> logo_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> plot_height</span>
<span id="cb18-178">  }</span>
<span id="cb18-179">  </span>
<span id="cb18-180">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compose the actual overlay</span></span>
<span id="cb18-181">  magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_composite</span>(plot, logo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">offset =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+"</span>, x_pos, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+"</span>, y_pos))</span>
<span id="cb18-182">  </span>
<span id="cb18-183">}</span>
<span id="cb18-184"></span>
<span id="cb18-185"></span>
<span id="cb18-186"></span>
<span id="cb18-187"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Choose logo, position, and size (bigger number = smaller logo) ----------</span></span>
<span id="cb18-188"></span>
<span id="cb18-189">plot_with_logo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_logo</span>(</span>
<span id="cb18-190">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot_path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.Date</span>(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, short_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_peak-years.png"</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># url or local file for the plot</span></span>
<span id="cb18-191">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">logo_path =</span> logo_file_name, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># url or local file for the logo</span></span>
<span id="cb18-192">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">logo_position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top right"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># choose a corner</span></span>
<span id="cb18-193">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 'top left', 'top right', 'bottom left' or 'bottom right'</span></span>
<span id="cb18-194">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">logo_scale =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb18-195">)</span>
<span id="cb18-196"></span>
<span id="cb18-197"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save the image and write to working directory</span></span>
<span id="cb18-198">magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(plot_with_logo, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.Date</span>(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, short_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_peak-years.png"</span>)) </span></code></pre></div>
</div>


</section>

 ]]></description>
  <guid>https://www.mitchhenderson.dev/posts/2020-04-22-how-a-sports-scientist-can-use-ggplot2-to-make-a-stunning-dataviz.html</guid>
  <pubDate>Tue, 21 Apr 2020 14:00:00 GMT</pubDate>
</item>
<item>
  <title>Tidying Catapult 10Hz export data</title>
  <dc:creator>Mitch Henderson</dc:creator>
  <link>https://www.mitchhenderson.dev/posts/2020-04-05_Tidy-Catapult-10Hz.html</link>
  <description><![CDATA[ 





<section id="youtube-tutorial" class="level1">
<h1>YouTube tutorial</h1>
<p>You can see me going through all the steps outlined here in this video with some dummy data (note that Iâ€™ve simplified the file structure in the post since recording this video so it will be a little different; both work though):</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/N0DCRqqSKPw" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section>
<section id="tidy-data" class="level1">
<h1>Tidy data</h1>
<p>Itâ€™s claimed that ~80% of data analysis is on the process of cleaning and preparing the data <a href="https://onlinelibrary.wiley.com/doi/book/10.1002/0471448354">(1)</a>. In 2014, <a href="https://twitter.com/hadleywickham">Hadley Wickham</a> coined the term <a href="https://vita.had.co.nz/papers/tidy-data.pdf">tidy data</a> to define a dataset structured to facilitate analysis. In the <a href="https://r4ds.had.co.nz/tidy-data.html">R for Data Science bookâ€™s section on tidy data</a>, for a dataset to be <em>tidy</em> it has to follow these 3 interrelated rules:</p>
<ol type="1">
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
<li>Each value must have itâ€™s own cell.</li>
</ol>
<p><img src="https://www.mitchhenderson.dev/img/tidy_data.png" class="img-fluid"> <em>Following three rules makes a dataset tidy: variables are in columns, observations are in rows, and values are in cells. Image from <a href="https://r4ds.had.co.nz/index.html">R for Data Science</a> by Hadley Wickham &amp; Garrett Grolemund.</em></p>
</section>
<section id="catapult-data" class="level1">
<h1>Catapult data</h1>
<p>When you export 10Hz GPS data from Catapultâ€™s Openfield software, the <code>.csv</code> file produced from each unit looks like this:</p>
<p><img src="https://www.mitchhenderson.dev/img/untidy.png" class="img-fluid"></p>
<p><img src="https://www.mitchhenderson.dev/img/batman_facepalm.gif" class="img-fluid"></p>
<p>It isnâ€™t great because:</p>
<ol type="1">
<li>Each unit has produced itâ€™s own <code>.csv</code> file, meaning to do any analysis using all playersâ€™ data we need to find a way to combine the files.</li>
<li>There are 8 rows of metadata above the actual data weâ€™re primarily interested in, preventing us from combining in itâ€™s current format.</li>
</ol>
<p>Without combining all playersâ€™ data into one <em>tidy</em> table or â€œ<em>dataframe</em>â€, we canâ€™t explore the data using the common tools like a PivotTable on Microsoft Excel or the <code>dplyr</code> R package.</p>
</section>
<section id="solution" class="level1">
<h1>Solution</h1>
<p>Thankfully for us, we donâ€™t need to manually go through each file, deleting the top 8 rows, creating new columns for the metadata like player name and match, and then copy pasting them all into the one file. The <code>tidyverse</code> suite of R packages can help us to largely automate these manual tasks!</p>
<p><img src="https://www.mitchhenderson.dev/img/batman_thinking.gif" class="img-fluid"></p>
<p>Iâ€™ll explain how to do it here (and provide you with the R code), and a working example is in <a href="https://www.youtube.com/watch?v=N0DCRqqSKPw&amp;t=11s">the YouTube video above</a>.</p>
<p>This process will:</p>
<ol type="1">
<li>Pull in each <code>.csv</code> fileâ€™s data within the folder youâ€™ve referenced with the <code>folder_name</code> variable (assuming that folder is within your working directory).</li>
<li>Remove the 8 rows of metadata from the top of each file.</li>
<li>Create new columns for player name and activity derived from the <code>.csv</code>â€™s file name generated by Openfield.</li>
<li>Combine all files into one <em>dataframe</em>.</li>
<li>Export this dataframe into a new <code>.csv</code> called â€œ<code>folder_name</code>_tidy.csvâ€ in your working directory. Where the <code>folder_name</code> part of the new file name is a folder in your working directory where your exports are stored (e.g., the name of my file below is â€œcombine_tidy.csvâ€ because I have my <code>.csv</code> files in a folder called â€œcombineâ€). You will type in the name of this folder into the code.</li>
</ol>
<p><img src="https://www.mitchhenderson.dev/img/batcomputer.gif" class="img-fluid"></p>
<section id="step-1" class="level2">
<h2 class="anchored" data-anchor-id="step-1">Step 1</h2>
<p>Create a folder that will contain all your folders of Openfield 10Hz exports. Name this anything you like.</p>
<p>This folder will need to be in your working directory when you run the code below. If you arenâ€™t familiar with a working directory, it is just a file path on your computer that sets the default location of any files you read into R, or save out of R. Think of it like a â€œhomeâ€ folder and you refer to all files relative to this (you can check what itâ€™s currently set to by running <code>getwd()</code>. I recommend using <a href="https://rfortherestofus.com/2022/10/rstudio-projects/" title="Why You Should Always Use RStudio Projects by R for the Rest of Us">RStudio Projects</a> to make this process much smoother.</p>
<p>In my code below Iâ€™ve assigned the variable <code>folder_name</code> to be â€œcombineâ€ (the name of my folder that I will save the export files). <strong>You will need to change the <code>folder_name</code> variable to the folder that will contain your export files</strong>.</p>
</section>
<section id="step-2" class="level2">
<h2 class="anchored" data-anchor-id="step-2">Step 2</h2>
<p>Export the files youâ€™d like to combine from Openfield <strong>without changing their filename</strong> and save them in the folder discussed in Step 1.</p>
<p>Some examples could be â€œRound 1â€ if youâ€™re combining all your athletes exports from a round 1 match.</p>
</section>
<section id="step-3" class="level2">
<h2 class="anchored" data-anchor-id="step-3">Step 3</h2>
<p>Make sure you have <a href="https://cran.r-project.org/">R</a> and <a href="https://rstudio.com/products/rstudio/download/">RStudio</a> downloaded and installed on your machine (both free!).</p>
<p>Open RStudio, copy and paste the code below into a script (you can create a new R script by clicking the symbol directly under â€˜Fileâ€™ on the top-left of the window, and selecting â€˜R Scriptâ€™).</p>
<p>Save the file as a <code>.R</code> file with an appropriate name (e.g.&nbsp;â€œtidy_catapult_data.Râ€).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Script to combine and tidy multiple Catapult Openfield 10Hz export .csv files by Mitch Henderson</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(zoo)</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This must exactly match the folder name containing the .csv files and be in your working directory</span></span>
<span id="cb1-7"></span>
<span id="cb1-8">folder_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"combine"</span></span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This function will read in multiple .csv files, create a column with the file name, and parse it into it's relevant components.</span></span>
<span id="cb1-11"></span>
<span id="cb1-12">read_plus <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(flnm) {</span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(flnm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">skip =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Filename =</span> flnm,</span>
<span id="cb1-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">without_folder =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(Filename, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb1-16">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Activity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(without_folder, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Export"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb1-17">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Player_interim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(without_folder, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" for "</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb1-18">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Player =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb1-19">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(Player_interim, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb1-20">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>,</span>
<span id="cb1-21">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(Player_interim, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb1-22">             )</span>
<span id="cb1-23">           ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Filename,</span>
<span id="cb1-25">         <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Player_interim,</span>
<span id="cb1-26">         <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>without_folder)</span>
<span id="cb1-27">}</span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import all files contained within the folder specified by `folder_name` above</span></span>
<span id="cb1-30"></span>
<span id="cb1-31">combine_and_tidy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb1-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(folder_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>),</span>
<span id="cb1-33">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.csv"</span>, </span>
<span id="cb1-34">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_plus</span>(.))</span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output csv into working directory</span></span>
<span id="cb1-38"></span>
<span id="cb1-39"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(combine_and_tidy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(folder_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_tidy.csv"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> F)</span></code></pre></div>
</div>
</section>
<section id="step-4" class="level2">
<h2 class="anchored" data-anchor-id="step-4">Step 4</h2>
<p>Change the <code>folder_name</code> variable to the exact folder name (in double quotes like is currently in the code) containing the <code>.csv</code> files you would like to combine and tidy.</p>
<p>Highlight the entire code and press Ctrl + Enter on PC or Cmd + Return on a Mac. This will run the code and produce the output <code>.csv</code> file in your working directory.</p>
<p><strong>Done!</strong></p>
<p>Now the data is in <em>tidy</em> format and is easy to manipulate and analyse!</p>
<p><img src="https://www.mitchhenderson.dev/img/tidy_gps.png" class="img-fluid"></p>
<p><img src="https://www.mitchhenderson.dev/img/batman_thumbsup.gif" class="img-fluid"></p>
<p>Let me know if this post has helped you or if thereâ€™s anything else youâ€™re interested in learning that I can help with. Iâ€™m keen to hear!</p>
<p><strong>Keep up to date with anything new from me on <a href="https://twitter.com/mitchhendo_">my Twitter</a>.</strong></p>
<p>Cheers,</p>
<p>Mitch</p>
<p><em>Thumbnail from <a href="www.catapultsports.com">catapultsports.com</a>.</em></p>


</section>
</section>

 ]]></description>
  <guid>https://www.mitchhenderson.dev/posts/2020-04-05_Tidy-Catapult-10Hz.html</guid>
  <pubDate>Sat, 04 Apr 2020 13:00:00 GMT</pubDate>
</item>
</channel>
</rss>
